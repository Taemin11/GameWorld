{"remainingRequest":"C:\\Users\\multicampus\\swfront2\\swfront\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\multicampus\\swfront2\\swfront\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\multicampus\\swfront2\\swfront\\src\\assets\\vendor\\glightbox\\js\\glightbox.js","dependencies":[{"path":"C:\\Users\\multicampus\\swfront2\\swfront\\src\\assets\\vendor\\glightbox\\js\\glightbox.js","mtime":1609799148000},{"path":"C:\\Users\\multicampus\\swfront2\\swfront\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\multicampus\\swfront2\\swfront\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\multicampus\\swfront2\\swfront\\node_modules\\eslint-loader\\index.js","mtime":1616737662405}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF90eXBlb2YyID0gcmVxdWlyZSgiQzovVXNlcnMvbXVsdGljYW1wdXMvc3dmcm9udDIvc3dmcm9udC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy90eXBlb2YiKS5kZWZhdWx0OwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbi5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuaXRlcmF0b3IuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZnJvbS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNsaWNlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5tYXRjaC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbi5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5jb25zdHJ1Y3Rvci5qcyIpOwoKKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHsKICAodHlwZW9mIGV4cG9ydHMgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mMihleHBvcnRzKSkgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOiB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOiAoZ2xvYmFsID0gZ2xvYmFsIHx8IHNlbGYsIGdsb2JhbC5HTGlnaHRib3ggPSBmYWN0b3J5KCkpOwp9KSh0aGlzLCBmdW5jdGlvbiAoKSB7CiAgJ3VzZSBzdHJpY3QnOwoKICBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsKCiAgICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSAic3ltYm9sIikgewogICAgICBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsKICAgICAgICByZXR1cm4gdHlwZW9mIG9iajsKICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgIF90eXBlb2YgPSBmdW5jdGlvbiBfdHlwZW9mKG9iaikgewogICAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyAic3ltYm9sIiA6IHR5cGVvZiBvYmo7CiAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIF90eXBlb2Yob2JqKTsKICB9CgogIGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICAgIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgewogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOwogICAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7CiAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgICAgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsKICAgIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogICAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogICAgcmV0dXJuIENvbnN0cnVjdG9yOwogIH0KCiAgZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgewogICAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTsKICB9CgogIGZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHsKICAgIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShhcnIpOwogIH0KCiAgZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheShpdGVyKSB7CiAgICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gInVuZGVmaW5lZCIgJiYgU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChpdGVyKSkgcmV0dXJuIEFycmF5LmZyb20oaXRlcik7CiAgfQoKICBmdW5jdGlvbiBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkobywgbWluTGVuKSB7CiAgICBpZiAoIW8pIHJldHVybjsKICAgIGlmICh0eXBlb2YgbyA9PT0gInN0cmluZyIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pOwogICAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpOwogICAgaWYgKG4gPT09ICJPYmplY3QiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7CiAgICBpZiAobiA9PT0gIk1hcCIgfHwgbiA9PT0gIlNldCIpIHJldHVybiBBcnJheS5mcm9tKG8pOwogICAgaWYgKG4gPT09ICJBcmd1bWVudHMiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTsKICB9CgogIGZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7CiAgICBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDsKCiAgICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIHsKICAgICAgYXJyMltpXSA9IGFycltpXTsKICAgIH0KCiAgICByZXR1cm4gYXJyMjsKICB9CgogIGZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgYXR0ZW1wdCB0byBzcHJlYWQgbm9uLWl0ZXJhYmxlIGluc3RhbmNlLlxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLiIpOwogIH0KCiAgdmFyIHVpZCA9IERhdGUubm93KCk7CgogIGZ1bmN0aW9uIGV4dGVuZCgpIHsKICAgIHZhciBleHRlbmRlZCA9IHt9OwogICAgdmFyIGRlZXAgPSB0cnVlOwogICAgdmFyIGkgPSAwOwogICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7CgogICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcmd1bWVudHNbMF0pID09PSAnW29iamVjdCBCb29sZWFuXScpIHsKICAgICAgZGVlcCA9IGFyZ3VtZW50c1swXTsKICAgICAgaSsrOwogICAgfQoKICAgIHZhciBtZXJnZSA9IGZ1bmN0aW9uIG1lcmdlKG9iaikgewogICAgICBmb3IgKHZhciBwcm9wIGluIG9iaikgewogICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkgewogICAgICAgICAgaWYgKGRlZXAgJiYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9ialtwcm9wXSkgPT09ICdbb2JqZWN0IE9iamVjdF0nKSB7CiAgICAgICAgICAgIGV4dGVuZGVkW3Byb3BdID0gZXh0ZW5kKHRydWUsIGV4dGVuZGVkW3Byb3BdLCBvYmpbcHJvcF0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZXh0ZW5kZWRbcHJvcF0gPSBvYmpbcHJvcF07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgdmFyIG9iaiA9IGFyZ3VtZW50c1tpXTsKICAgICAgbWVyZ2Uob2JqKTsKICAgIH0KCiAgICByZXR1cm4gZXh0ZW5kZWQ7CiAgfQoKICBmdW5jdGlvbiBlYWNoKGNvbGxlY3Rpb24sIGNhbGxiYWNrKSB7CiAgICBpZiAoaXNOb2RlKGNvbGxlY3Rpb24pIHx8IGNvbGxlY3Rpb24gPT09IHdpbmRvdyB8fCBjb2xsZWN0aW9uID09PSBkb2N1bWVudCkgewogICAgICBjb2xsZWN0aW9uID0gW2NvbGxlY3Rpb25dOwogICAgfQoKICAgIGlmICghaXNBcnJheUxpa2UoY29sbGVjdGlvbikgJiYgIWlzT2JqZWN0KGNvbGxlY3Rpb24pKSB7CiAgICAgIGNvbGxlY3Rpb24gPSBbY29sbGVjdGlvbl07CiAgICB9CgogICAgaWYgKHNpemUoY29sbGVjdGlvbikgPT0gMCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGlzQXJyYXlMaWtlKGNvbGxlY3Rpb24pICYmICFpc09iamVjdChjb2xsZWN0aW9uKSkgewogICAgICB2YXIgbCA9IGNvbGxlY3Rpb24ubGVuZ3RoLAogICAgICAgICAgaSA9IDA7CgogICAgICBmb3IgKDsgaSA8IGw7IGkrKykgewogICAgICAgIGlmIChjYWxsYmFjay5jYWxsKGNvbGxlY3Rpb25baV0sIGNvbGxlY3Rpb25baV0sIGksIGNvbGxlY3Rpb24pID09PSBmYWxzZSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKGlzT2JqZWN0KGNvbGxlY3Rpb24pKSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBjb2xsZWN0aW9uKSB7CiAgICAgICAgaWYgKGhhcyhjb2xsZWN0aW9uLCBrZXkpKSB7CiAgICAgICAgICBpZiAoY2FsbGJhY2suY2FsbChjb2xsZWN0aW9uW2tleV0sIGNvbGxlY3Rpb25ba2V5XSwga2V5LCBjb2xsZWN0aW9uKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBmdW5jdGlvbiBnZXROb2RlRXZlbnRzKG5vZGUpIHsKICAgIHZhciBuYW1lID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBudWxsOwogICAgdmFyIGZuID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBudWxsOwogICAgdmFyIGNhY2hlID0gbm9kZVt1aWRdID0gbm9kZVt1aWRdIHx8IFtdOwogICAgdmFyIGRhdGEgPSB7CiAgICAgIGFsbDogY2FjaGUsCiAgICAgIGV2dDogbnVsbCwKICAgICAgZm91bmQ6IG51bGwKICAgIH07CgogICAgaWYgKG5hbWUgJiYgZm4gJiYgc2l6ZShjYWNoZSkgPiAwKSB7CiAgICAgIGVhY2goY2FjaGUsIGZ1bmN0aW9uIChjbCwgaSkgewogICAgICAgIGlmIChjbC5ldmVudE5hbWUgPT0gbmFtZSAmJiBjbC5mbi50b1N0cmluZygpID09IGZuLnRvU3RyaW5nKCkpIHsKICAgICAgICAgIGRhdGEuZm91bmQgPSB0cnVlOwogICAgICAgICAgZGF0YS5ldnQgPSBpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgcmV0dXJuIGRhdGE7CiAgfQoKICBmdW5jdGlvbiBhZGRFdmVudChldmVudE5hbWUpIHsKICAgIHZhciBfcmVmID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fSwKICAgICAgICBvbkVsZW1lbnQgPSBfcmVmLm9uRWxlbWVudCwKICAgICAgICB3aXRoQ2FsbGJhY2sgPSBfcmVmLndpdGhDYWxsYmFjaywKICAgICAgICBfcmVmJGF2b2lkRHVwbGljYXRlID0gX3JlZi5hdm9pZER1cGxpY2F0ZSwKICAgICAgICBhdm9pZER1cGxpY2F0ZSA9IF9yZWYkYXZvaWREdXBsaWNhdGUgPT09IHZvaWQgMCA/IHRydWUgOiBfcmVmJGF2b2lkRHVwbGljYXRlLAogICAgICAgIF9yZWYkb25jZSA9IF9yZWYub25jZSwKICAgICAgICBvbmNlID0gX3JlZiRvbmNlID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYkb25jZSwKICAgICAgICBfcmVmJHVzZUNhcHR1cmUgPSBfcmVmLnVzZUNhcHR1cmUsCiAgICAgICAgdXNlQ2FwdHVyZSA9IF9yZWYkdXNlQ2FwdHVyZSA9PT0gdm9pZCAwID8gZmFsc2UgOiBfcmVmJHVzZUNhcHR1cmU7CgogICAgdmFyIHRoaXNBcmcgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKICAgIHZhciBlbGVtZW50ID0gb25FbGVtZW50IHx8IFtdOwoKICAgIGlmIChpc1N0cmluZyhlbGVtZW50KSkgewogICAgICBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChlbGVtZW50KTsKICAgIH0KCiAgICBmdW5jdGlvbiBoYW5kbGVyKGV2ZW50KSB7CiAgICAgIGlmIChpc0Z1bmN0aW9uKHdpdGhDYWxsYmFjaykpIHsKICAgICAgICB3aXRoQ2FsbGJhY2suY2FsbCh0aGlzQXJnLCBldmVudCwgdGhpcyk7CiAgICAgIH0KCiAgICAgIGlmIChvbmNlKSB7CiAgICAgICAgaGFuZGxlci5kZXN0cm95KCk7CiAgICAgIH0KICAgIH0KCiAgICBoYW5kbGVyLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7CiAgICAgIGVhY2goZWxlbWVudCwgZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgdmFyIGV2ZW50cyA9IGdldE5vZGVFdmVudHMoZWwsIGV2ZW50TmFtZSwgaGFuZGxlcik7CgogICAgICAgIGlmIChldmVudHMuZm91bmQpIHsKICAgICAgICAgIGV2ZW50cy5hbGwuc3BsaWNlKGV2ZW50cy5ldnQsIDEpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIpIHsKICAgICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBoYW5kbGVyLCB1c2VDYXB0dXJlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKCiAgICBlYWNoKGVsZW1lbnQsIGZ1bmN0aW9uIChlbCkgewogICAgICB2YXIgZXZlbnRzID0gZ2V0Tm9kZUV2ZW50cyhlbCwgZXZlbnROYW1lLCBoYW5kbGVyKTsKCiAgICAgIGlmIChlbC5hZGRFdmVudExpc3RlbmVyICYmIGF2b2lkRHVwbGljYXRlICYmICFldmVudHMuZm91bmQgfHwgIWF2b2lkRHVwbGljYXRlKSB7CiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGhhbmRsZXIsIHVzZUNhcHR1cmUpOwogICAgICAgIGV2ZW50cy5hbGwucHVzaCh7CiAgICAgICAgICBldmVudE5hbWU6IGV2ZW50TmFtZSwKICAgICAgICAgIGZuOiBoYW5kbGVyCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIGhhbmRsZXI7CiAgfQoKICBmdW5jdGlvbiBhZGRDbGFzcyhub2RlLCBuYW1lKSB7CiAgICBlYWNoKG5hbWUuc3BsaXQoJyAnKSwgZnVuY3Rpb24gKGNsKSB7CiAgICAgIHJldHVybiBub2RlLmNsYXNzTGlzdC5hZGQoY2wpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiByZW1vdmVDbGFzcyhub2RlLCBuYW1lKSB7CiAgICBlYWNoKG5hbWUuc3BsaXQoJyAnKSwgZnVuY3Rpb24gKGNsKSB7CiAgICAgIHJldHVybiBub2RlLmNsYXNzTGlzdC5yZW1vdmUoY2wpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBoYXNDbGFzcyhub2RlLCBuYW1lKSB7CiAgICByZXR1cm4gbm9kZS5jbGFzc0xpc3QuY29udGFpbnMobmFtZSk7CiAgfQoKICBmdW5jdGlvbiBjbG9zZXN0KGVsZW0sIHNlbGVjdG9yKSB7CiAgICB3aGlsZSAoZWxlbSAhPT0gZG9jdW1lbnQuYm9keSkgewogICAgICBlbGVtID0gZWxlbS5wYXJlbnRFbGVtZW50OwoKICAgICAgaWYgKCFlbGVtKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICB2YXIgbWF0Y2hlcyA9IHR5cGVvZiBlbGVtLm1hdGNoZXMgPT0gJ2Z1bmN0aW9uJyA/IGVsZW0ubWF0Y2hlcyhzZWxlY3RvcikgOiBlbGVtLm1zTWF0Y2hlc1NlbGVjdG9yKHNlbGVjdG9yKTsKCiAgICAgIGlmIChtYXRjaGVzKSB7CiAgICAgICAgcmV0dXJuIGVsZW07CiAgICAgIH0KICAgIH0KICB9CgogIGZ1bmN0aW9uIGFuaW1hdGVFbGVtZW50KGVsZW1lbnQpIHsKICAgIHZhciBhbmltYXRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6ICcnOwogICAgdmFyIGNhbGxiYWNrID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTsKCiAgICBpZiAoIWVsZW1lbnQgfHwgYW5pbWF0aW9uID09PSAnJykgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgaWYgKGFuaW1hdGlvbiA9PSAnbm9uZScpIHsKICAgICAgaWYgKGlzRnVuY3Rpb24oY2FsbGJhY2spKSB7CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHZhciBhbmltYXRpb25FbmQgPSB3aGljaEFuaW1hdGlvbkV2ZW50KCk7CiAgICB2YXIgYW5pbWF0aW9uTmFtZXMgPSBhbmltYXRpb24uc3BsaXQoJyAnKTsKICAgIGVhY2goYW5pbWF0aW9uTmFtZXMsIGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgIGFkZENsYXNzKGVsZW1lbnQsICdnJyArIG5hbWUpOwogICAgfSk7CiAgICBhZGRFdmVudChhbmltYXRpb25FbmQsIHsKICAgICAgb25FbGVtZW50OiBlbGVtZW50LAogICAgICBhdm9pZER1cGxpY2F0ZTogZmFsc2UsCiAgICAgIG9uY2U6IHRydWUsCiAgICAgIHdpdGhDYWxsYmFjazogZnVuY3Rpb24gd2l0aENhbGxiYWNrKGV2ZW50LCB0YXJnZXQpIHsKICAgICAgICBlYWNoKGFuaW1hdGlvbk5hbWVzLCBmdW5jdGlvbiAobmFtZSkgewogICAgICAgICAgcmVtb3ZlQ2xhc3ModGFyZ2V0LCAnZycgKyBuYW1lKTsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGlzRnVuY3Rpb24oY2FsbGJhY2spKSB7CiAgICAgICAgICBjYWxsYmFjaygpOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBjc3NUcmFuc2Zvcm0obm9kZSkgewogICAgdmFyIHRyYW5zbGF0ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogJyc7CgogICAgaWYgKHRyYW5zbGF0ZSA9PSAnJykgewogICAgICBub2RlLnN0eWxlLndlYmtpdFRyYW5zZm9ybSA9ICcnOwogICAgICBub2RlLnN0eWxlLk1velRyYW5zZm9ybSA9ICcnOwogICAgICBub2RlLnN0eWxlLm1zVHJhbnNmb3JtID0gJyc7CiAgICAgIG5vZGUuc3R5bGUuT1RyYW5zZm9ybSA9ICcnOwogICAgICBub2RlLnN0eWxlLnRyYW5zZm9ybSA9ICcnOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgbm9kZS5zdHlsZS53ZWJraXRUcmFuc2Zvcm0gPSB0cmFuc2xhdGU7CiAgICBub2RlLnN0eWxlLk1velRyYW5zZm9ybSA9IHRyYW5zbGF0ZTsKICAgIG5vZGUuc3R5bGUubXNUcmFuc2Zvcm0gPSB0cmFuc2xhdGU7CiAgICBub2RlLnN0eWxlLk9UcmFuc2Zvcm0gPSB0cmFuc2xhdGU7CiAgICBub2RlLnN0eWxlLnRyYW5zZm9ybSA9IHRyYW5zbGF0ZTsKICB9CgogIGZ1bmN0aW9uIHNob3coZWxlbWVudCkgewogICAgZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICB9CgogIGZ1bmN0aW9uIGhpZGUoZWxlbWVudCkgewogICAgZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogIH0KCiAgZnVuY3Rpb24gY3JlYXRlSFRNTChodG1sU3RyKSB7CiAgICB2YXIgZnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSwKICAgICAgICB0ZW1wID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICB0ZW1wLmlubmVySFRNTCA9IGh0bWxTdHI7CgogICAgd2hpbGUgKHRlbXAuZmlyc3RDaGlsZCkgewogICAgICBmcmFnLmFwcGVuZENoaWxkKHRlbXAuZmlyc3RDaGlsZCk7CiAgICB9CgogICAgcmV0dXJuIGZyYWc7CiAgfQoKICBmdW5jdGlvbiB3aW5kb3dTaXplKCkgewogICAgcmV0dXJuIHsKICAgICAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCB8fCBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoLAogICAgICBoZWlnaHQ6IHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gd2hpY2hBbmltYXRpb25FdmVudCgpIHsKICAgIHZhciB0LAogICAgICAgIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZmFrZWVsZW1lbnQnKTsKICAgIHZhciBhbmltYXRpb25zID0gewogICAgICBhbmltYXRpb246ICdhbmltYXRpb25lbmQnLAogICAgICBPQW5pbWF0aW9uOiAnb0FuaW1hdGlvbkVuZCcsCiAgICAgIE1vekFuaW1hdGlvbjogJ2FuaW1hdGlvbmVuZCcsCiAgICAgIFdlYmtpdEFuaW1hdGlvbjogJ3dlYmtpdEFuaW1hdGlvbkVuZCcKICAgIH07CgogICAgZm9yICh0IGluIGFuaW1hdGlvbnMpIHsKICAgICAgaWYgKGVsLnN0eWxlW3RdICE9PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gYW5pbWF0aW9uc1t0XTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gd2hpY2hUcmFuc2l0aW9uRXZlbnQoKSB7CiAgICB2YXIgdCwKICAgICAgICBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zha2VlbGVtZW50Jyk7CiAgICB2YXIgdHJhbnNpdGlvbnMgPSB7CiAgICAgIHRyYW5zaXRpb246ICd0cmFuc2l0aW9uZW5kJywKICAgICAgT1RyYW5zaXRpb246ICdvVHJhbnNpdGlvbkVuZCcsCiAgICAgIE1velRyYW5zaXRpb246ICd0cmFuc2l0aW9uZW5kJywKICAgICAgV2Via2l0VHJhbnNpdGlvbjogJ3dlYmtpdFRyYW5zaXRpb25FbmQnCiAgICB9OwoKICAgIGZvciAodCBpbiB0cmFuc2l0aW9ucykgewogICAgICBpZiAoZWwuc3R5bGVbdF0gIT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0cmFuc2l0aW9uc1t0XTsKICAgICAgfQogICAgfQogIH0KCiAgZnVuY3Rpb24gY3JlYXRlSWZyYW1lKGNvbmZpZykgewogICAgdmFyIHVybCA9IGNvbmZpZy51cmwsCiAgICAgICAgYWxsb3cgPSBjb25maWcuYWxsb3csCiAgICAgICAgY2FsbGJhY2sgPSBjb25maWcuY2FsbGJhY2ssCiAgICAgICAgYXBwZW5kVG8gPSBjb25maWcuYXBwZW5kVG87CiAgICB2YXIgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7CiAgICBpZnJhbWUuY2xhc3NOYW1lID0gJ3ZpbWVvLXZpZGVvIGd2aWRlbyc7CiAgICBpZnJhbWUuc3JjID0gdXJsOwogICAgaWZyYW1lLnN0eWxlLndpZHRoID0gJzEwMCUnOwogICAgaWZyYW1lLnN0eWxlLmhlaWdodCA9ICcxMDAlJzsKCiAgICBpZiAoYWxsb3cpIHsKICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnYWxsb3cnLCBhbGxvdyk7CiAgICB9CgogICAgaWZyYW1lLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgYWRkQ2xhc3MoaWZyYW1lLCAnbm9kZS1yZWFkeScpOwoKICAgICAgaWYgKGlzRnVuY3Rpb24oY2FsbGJhY2spKSB7CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKCiAgICBpZiAoYXBwZW5kVG8pIHsKICAgICAgYXBwZW5kVG8uYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICAgIH0KCiAgICByZXR1cm4gaWZyYW1lOwogIH0KCiAgZnVuY3Rpb24gd2FpdFVudGlsKGNoZWNrLCBvbkNvbXBsZXRlLCBkZWxheSwgdGltZW91dCkgewogICAgaWYgKGNoZWNrKCkpIHsKICAgICAgb25Db21wbGV0ZSgpOwogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKCFkZWxheSkgewogICAgICBkZWxheSA9IDEwMDsKICAgIH0KCiAgICB2YXIgdGltZW91dFBvaW50ZXI7CiAgICB2YXIgaW50ZXJ2YWxQb2ludGVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICBpZiAoIWNoZWNrKCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxQb2ludGVyKTsKCiAgICAgIGlmICh0aW1lb3V0UG9pbnRlcikgewogICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0UG9pbnRlcik7CiAgICAgIH0KCiAgICAgIG9uQ29tcGxldGUoKTsKICAgIH0sIGRlbGF5KTsKCiAgICBpZiAodGltZW91dCkgewogICAgICB0aW1lb3V0UG9pbnRlciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxQb2ludGVyKTsKICAgICAgfSwgdGltZW91dCk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBpbmplY3RBc3NldHModXJsLCB3YWl0Rm9yLCBjYWxsYmFjaykgewogICAgaWYgKGlzTmlsKHVybCkpIHsKICAgICAgY29uc29sZS5lcnJvcignSW5qZWN0IGFzc2V0cyBlcnJvcicpOwogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGlzRnVuY3Rpb24od2FpdEZvcikpIHsKICAgICAgY2FsbGJhY2sgPSB3YWl0Rm9yOwogICAgICB3YWl0Rm9yID0gZmFsc2U7CiAgICB9CgogICAgaWYgKGlzU3RyaW5nKHdhaXRGb3IpICYmIHdhaXRGb3IgaW4gd2luZG93KSB7CiAgICAgIGlmIChpc0Z1bmN0aW9uKGNhbGxiYWNrKSkgewogICAgICAgIGNhbGxiYWNrKCk7CiAgICAgIH0KCiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgZm91bmQ7CgogICAgaWYgKHVybC5pbmRleE9mKCcuY3NzJykgIT09IC0xKSB7CiAgICAgIGZvdW5kID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnbGlua1tocmVmPSInICsgdXJsICsgJyJdJyk7CgogICAgICBpZiAoZm91bmQgJiYgZm91bmQubGVuZ3RoID4gMCkgewogICAgICAgIGlmIChpc0Z1bmN0aW9uKGNhbGxiYWNrKSkgewogICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICB9CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGhlYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdOwogICAgICB2YXIgaGVhZFN0eWxlcyA9IGhlYWQucXVlcnlTZWxlY3RvckFsbCgnbGlua1tyZWw9InN0eWxlc2hlZXQiXScpOwogICAgICB2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTsKICAgICAgbGluay5yZWwgPSAnc3R5bGVzaGVldCc7CiAgICAgIGxpbmsudHlwZSA9ICd0ZXh0L2Nzcyc7CiAgICAgIGxpbmsuaHJlZiA9IHVybDsKICAgICAgbGluay5tZWRpYSA9ICdhbGwnOwoKICAgICAgaWYgKGhlYWRTdHlsZXMpIHsKICAgICAgICBoZWFkLmluc2VydEJlZm9yZShsaW5rLCBoZWFkU3R5bGVzWzBdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBoZWFkLmFwcGVuZENoaWxkKGxpbmspOwogICAgICB9CgogICAgICBpZiAoaXNGdW5jdGlvbihjYWxsYmFjaykpIHsKICAgICAgICBjYWxsYmFjaygpOwogICAgICB9CgogICAgICByZXR1cm47CiAgICB9CgogICAgZm91bmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzY3JpcHRbc3JjPSInICsgdXJsICsgJyJdJyk7CgogICAgaWYgKGZvdW5kICYmIGZvdW5kLmxlbmd0aCA+IDApIHsKICAgICAgaWYgKGlzRnVuY3Rpb24oY2FsbGJhY2spKSB7CiAgICAgICAgaWYgKGlzU3RyaW5nKHdhaXRGb3IpKSB7CiAgICAgICAgICB3YWl0VW50aWwoZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gdHlwZW9mIHdpbmRvd1t3YWl0Rm9yXSAhPT0gJ3VuZGVmaW5lZCc7CiAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGNhbGxiYWNrKCk7CiAgICAgIH0KCiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7CiAgICBzY3JpcHQudHlwZSA9ICd0ZXh0L2phdmFzY3JpcHQnOwogICAgc2NyaXB0LnNyYyA9IHVybDsKCiAgICBzY3JpcHQub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICBpZiAoaXNGdW5jdGlvbihjYWxsYmFjaykpIHsKICAgICAgICBpZiAoaXNTdHJpbmcod2FpdEZvcikpIHsKICAgICAgICAgIHdhaXRVbnRpbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiB0eXBlb2Ygd2luZG93W3dhaXRGb3JdICE9PSAndW5kZWZpbmVkJzsKICAgICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgfTsKCiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNjcmlwdCk7CiAgICByZXR1cm47CiAgfQoKICBmdW5jdGlvbiBpc01vYmlsZSgpIHsKICAgIHJldHVybiAnbmF2aWdhdG9yJyBpbiB3aW5kb3cgJiYgd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goLyhpUGFkKXwoaVBob25lKXwoaVBvZCl8KEFuZHJvaWQpfChQbGF5Qm9vayl8KEJCMTApfChCbGFja0JlcnJ5KXwoT3BlcmEgTWluaSl8KElFTW9iaWxlKXwod2ViT1MpfChNZWVHbykvaSk7CiAgfQoKICBmdW5jdGlvbiBpc1RvdWNoKCkgewogICAgcmV0dXJuIGlzTW9iaWxlKCkgIT09IG51bGwgfHwgZG9jdW1lbnQuY3JlYXRlVG91Y2ggIT09IHVuZGVmaW5lZCB8fCAnb250b3VjaHN0YXJ0JyBpbiB3aW5kb3cgfHwgJ29ubXNnZXN0dXJlY2hhbmdlJyBpbiB3aW5kb3cgfHwgbmF2aWdhdG9yLm1zTWF4VG91Y2hQb2ludHM7CiAgfQoKICBmdW5jdGlvbiBpc0Z1bmN0aW9uKGYpIHsKICAgIHJldHVybiB0eXBlb2YgZiA9PT0gJ2Z1bmN0aW9uJzsKICB9CgogIGZ1bmN0aW9uIGlzU3RyaW5nKHMpIHsKICAgIHJldHVybiB0eXBlb2YgcyA9PT0gJ3N0cmluZyc7CiAgfQoKICBmdW5jdGlvbiBpc05vZGUoZWwpIHsKICAgIHJldHVybiAhIShlbCAmJiBlbC5ub2RlVHlwZSAmJiBlbC5ub2RlVHlwZSA9PSAxKTsKICB9CgogIGZ1bmN0aW9uIGlzQXJyYXkoYXIpIHsKICAgIHJldHVybiBBcnJheS5pc0FycmF5KGFyKTsKICB9CgogIGZ1bmN0aW9uIGlzQXJyYXlMaWtlKGFyKSB7CiAgICByZXR1cm4gYXIgJiYgYXIubGVuZ3RoICYmIGlzRmluaXRlKGFyLmxlbmd0aCk7CiAgfQoKICBmdW5jdGlvbiBpc09iamVjdChvKSB7CiAgICB2YXIgdHlwZSA9IF90eXBlb2Yobyk7CgogICAgcmV0dXJuIHR5cGUgPT09ICdvYmplY3QnICYmIG8gIT0gbnVsbCAmJiAhaXNGdW5jdGlvbihvKSAmJiAhaXNBcnJheShvKTsKICB9CgogIGZ1bmN0aW9uIGlzTmlsKG8pIHsKICAgIHJldHVybiBvID09IG51bGw7CiAgfQoKICBmdW5jdGlvbiBoYXMob2JqLCBrZXkpIHsKICAgIHJldHVybiBvYmogIT09IG51bGwgJiYgaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSk7CiAgfQoKICBmdW5jdGlvbiBzaXplKG8pIHsKICAgIGlmIChpc09iamVjdChvKSkgewogICAgICBpZiAoby5rZXlzKSB7CiAgICAgICAgcmV0dXJuIG8ua2V5cygpLmxlbmd0aDsKICAgICAgfQoKICAgICAgdmFyIGwgPSAwOwoKICAgICAgZm9yICh2YXIgayBpbiBvKSB7CiAgICAgICAgaWYgKGhhcyhvLCBrKSkgewogICAgICAgICAgbCsrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGw7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gby5sZW5ndGg7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBpc051bWJlcihuKSB7CiAgICByZXR1cm4gIWlzTmFOKHBhcnNlRmxvYXQobikpICYmIGlzRmluaXRlKG4pOwogIH0KCiAgZnVuY3Rpb24ga2V5Ym9hcmROYXZpZ2F0aW9uKGluc3RhbmNlKSB7CiAgICBpZiAoaW5zdGFuY2UuZXZlbnRzLmhhc093blByb3BlcnR5KCdrZXlib2FyZCcpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpbnN0YW5jZS5ldmVudHNbJ2tleWJvYXJkJ10gPSBhZGRFdmVudCgna2V5ZG93bicsIHsKICAgICAgb25FbGVtZW50OiB3aW5kb3csCiAgICAgIHdpdGhDYWxsYmFjazogZnVuY3Rpb24gd2l0aENhbGxiYWNrKGV2ZW50LCB0YXJnZXQpIHsKICAgICAgICBldmVudCA9IGV2ZW50IHx8IHdpbmRvdy5ldmVudDsKICAgICAgICB2YXIga2V5ID0gZXZlbnQua2V5Q29kZTsKCiAgICAgICAgaWYgKGtleSA9PSA5KSB7CiAgICAgICAgICB2YXIgYWN0aXZlRWxlbWVudCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ub2RlTmFtZSA/IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQubm9kZU5hbWUudG9Mb2NhbGVMb3dlckNhc2UoKSA6IGZhbHNlOwoKICAgICAgICAgIGlmIChhY3RpdmVFbGVtZW50ID09ICdpbnB1dCcgfHwgYWN0aXZlRWxlbWVudCA9PSAndGV4dGFyZWEnIHx8IGFjdGl2ZUVsZW1lbnQgPT0gJ2J1dHRvbicpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICB2YXIgYnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5nYnRuJyk7CgogICAgICAgICAgaWYgKCFidG5zIHx8IGJ0bnMubGVuZ3RoIDw9IDApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBmb2N1c2VkID0gX3RvQ29uc3VtYWJsZUFycmF5KGJ0bnMpLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gaGFzQ2xhc3MoaXRlbSwgJ2ZvY3VzZWQnKTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIGlmICghZm9jdXNlZC5sZW5ndGgpIHsKICAgICAgICAgICAgdmFyIGZpcnN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdidG5bdGFiaW5kZXg9IjAiXScpOwoKICAgICAgICAgICAgaWYgKGZpcnN0KSB7CiAgICAgICAgICAgICAgZmlyc3QuZm9jdXMoKTsKICAgICAgICAgICAgICBhZGRDbGFzcyhmaXJzdCwgJ2ZvY3VzZWQnKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGJ0bnMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgICByZXR1cm4gcmVtb3ZlQ2xhc3MoZWxlbWVudCwgJ2ZvY3VzZWQnKTsKICAgICAgICAgIH0pOwogICAgICAgICAgdmFyIHRhYmluZGV4ID0gZm9jdXNlZFswXS5nZXRBdHRyaWJ1dGUoJ3RhYmluZGV4Jyk7CiAgICAgICAgICB0YWJpbmRleCA9IHRhYmluZGV4ID8gdGFiaW5kZXggOiAnMCc7CiAgICAgICAgICB2YXIgbmV3SW5kZXggPSBwYXJzZUludCh0YWJpbmRleCkgKyAxOwoKICAgICAgICAgIGlmIChuZXdJbmRleCA+IGJ0bnMubGVuZ3RoIC0gMSkgewogICAgICAgICAgICBuZXdJbmRleCA9ICcwJzsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgbmV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5nYnRuW3RhYmluZGV4PVwiIi5jb25jYXQobmV3SW5kZXgsICJcIl0iKSk7CgogICAgICAgICAgaWYgKG5leHQpIHsKICAgICAgICAgICAgbmV4dC5mb2N1cygpOwogICAgICAgICAgICBhZGRDbGFzcyhuZXh0LCAnZm9jdXNlZCcpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGtleSA9PSAzOSkgewogICAgICAgICAgaW5zdGFuY2UubmV4dFNsaWRlKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoa2V5ID09IDM3KSB7CiAgICAgICAgICBpbnN0YW5jZS5wcmV2U2xpZGUoKTsKICAgICAgICB9CgogICAgICAgIGlmIChrZXkgPT0gMjcpIHsKICAgICAgICAgIGluc3RhbmNlLmNsb3NlKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIGdldExlbih2KSB7CiAgICByZXR1cm4gTWF0aC5zcXJ0KHYueCAqIHYueCArIHYueSAqIHYueSk7CiAgfQoKICBmdW5jdGlvbiBkb3QodjEsIHYyKSB7CiAgICByZXR1cm4gdjEueCAqIHYyLnggKyB2MS55ICogdjIueTsKICB9CgogIGZ1bmN0aW9uIGdldEFuZ2xlKHYxLCB2MikgewogICAgdmFyIG1yID0gZ2V0TGVuKHYxKSAqIGdldExlbih2Mik7CgogICAgaWYgKG1yID09PSAwKSB7CiAgICAgIHJldHVybiAwOwogICAgfQoKICAgIHZhciByID0gZG90KHYxLCB2MikgLyBtcjsKCiAgICBpZiAociA+IDEpIHsKICAgICAgciA9IDE7CiAgICB9CgogICAgcmV0dXJuIE1hdGguYWNvcyhyKTsKICB9CgogIGZ1bmN0aW9uIGNyb3NzKHYxLCB2MikgewogICAgcmV0dXJuIHYxLnggKiB2Mi55IC0gdjIueCAqIHYxLnk7CiAgfQoKICBmdW5jdGlvbiBnZXRSb3RhdGVBbmdsZSh2MSwgdjIpIHsKICAgIHZhciBhbmdsZSA9IGdldEFuZ2xlKHYxLCB2Mik7CgogICAgaWYgKGNyb3NzKHYxLCB2MikgPiAwKSB7CiAgICAgIGFuZ2xlICo9IC0xOwogICAgfQoKICAgIHJldHVybiBhbmdsZSAqIDE4MCAvIE1hdGguUEk7CiAgfQoKICB2YXIgRXZlbnRzSGFuZGxlckFkbWluID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gRXZlbnRzSGFuZGxlckFkbWluKGVsKSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFdmVudHNIYW5kbGVyQWRtaW4pOwoKICAgICAgdGhpcy5oYW5kbGVycyA9IFtdOwogICAgICB0aGlzLmVsID0gZWw7CiAgICB9CgogICAgX2NyZWF0ZUNsYXNzKEV2ZW50c0hhbmRsZXJBZG1pbiwgW3sKICAgICAga2V5OiAiYWRkIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZChoYW5kbGVyKSB7CiAgICAgICAgdGhpcy5oYW5kbGVycy5wdXNoKGhhbmRsZXIpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImRlbCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZWwoaGFuZGxlcikgewogICAgICAgIGlmICghaGFuZGxlcikgewogICAgICAgICAgdGhpcy5oYW5kbGVycyA9IFtdOwogICAgICAgIH0KCiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuaGFuZGxlcnMubGVuZ3RoOyBpID49IDA7IGktLSkgewogICAgICAgICAgaWYgKHRoaXMuaGFuZGxlcnNbaV0gPT09IGhhbmRsZXIpIHsKICAgICAgICAgICAgdGhpcy5oYW5kbGVycy5zcGxpY2UoaSwgMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImRpc3BhdGNoIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3BhdGNoKCkgewogICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLmhhbmRsZXJzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICB2YXIgaGFuZGxlciA9IHRoaXMuaGFuZGxlcnNbaV07CgogICAgICAgICAgaWYgKHR5cGVvZiBoYW5kbGVyID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIGhhbmRsZXIuYXBwbHkodGhpcy5lbCwgYXJndW1lbnRzKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH1dKTsKCiAgICByZXR1cm4gRXZlbnRzSGFuZGxlckFkbWluOwogIH0oKTsKCiAgZnVuY3Rpb24gd3JhcEZ1bmMoZWwsIGhhbmRsZXIpIHsKICAgIHZhciBFdmVudHNoYW5kbGVyQWRtaW4gPSBuZXcgRXZlbnRzSGFuZGxlckFkbWluKGVsKTsKICAgIEV2ZW50c2hhbmRsZXJBZG1pbi5hZGQoaGFuZGxlcik7CiAgICByZXR1cm4gRXZlbnRzaGFuZGxlckFkbWluOwogIH0KCiAgdmFyIFRvdWNoRXZlbnRzID0gZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gVG91Y2hFdmVudHMoZWwsIG9wdGlvbikgewogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVG91Y2hFdmVudHMpOwoKICAgICAgdGhpcy5lbGVtZW50ID0gdHlwZW9mIGVsID09ICdzdHJpbmcnID8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbCkgOiBlbDsKICAgICAgdGhpcy5zdGFydCA9IHRoaXMuc3RhcnQuYmluZCh0aGlzKTsKICAgICAgdGhpcy5tb3ZlID0gdGhpcy5tb3ZlLmJpbmQodGhpcyk7CiAgICAgIHRoaXMuZW5kID0gdGhpcy5lbmQuYmluZCh0aGlzKTsKICAgICAgdGhpcy5jYW5jZWwgPSB0aGlzLmNhbmNlbC5iaW5kKHRoaXMpOwogICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMuc3RhcnQsIGZhbHNlKTsKICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMubW92ZSwgZmFsc2UpOwogICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLmVuZCwgZmFsc2UpOwogICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hjYW5jZWwnLCB0aGlzLmNhbmNlbCwgZmFsc2UpOwogICAgICB0aGlzLnByZVYgPSB7CiAgICAgICAgeDogbnVsbCwKICAgICAgICB5OiBudWxsCiAgICAgIH07CiAgICAgIHRoaXMucGluY2hTdGFydExlbiA9IG51bGw7CiAgICAgIHRoaXMuem9vbSA9IDE7CiAgICAgIHRoaXMuaXNEb3VibGVUYXAgPSBmYWxzZTsKCiAgICAgIHZhciBub29wID0gZnVuY3Rpb24gbm9vcCgpIHt9OwoKICAgICAgdGhpcy5yb3RhdGUgPSB3cmFwRnVuYyh0aGlzLmVsZW1lbnQsIG9wdGlvbi5yb3RhdGUgfHwgbm9vcCk7CiAgICAgIHRoaXMudG91Y2hTdGFydCA9IHdyYXBGdW5jKHRoaXMuZWxlbWVudCwgb3B0aW9uLnRvdWNoU3RhcnQgfHwgbm9vcCk7CiAgICAgIHRoaXMubXVsdGlwb2ludFN0YXJ0ID0gd3JhcEZ1bmModGhpcy5lbGVtZW50LCBvcHRpb24ubXVsdGlwb2ludFN0YXJ0IHx8IG5vb3ApOwogICAgICB0aGlzLm11bHRpcG9pbnRFbmQgPSB3cmFwRnVuYyh0aGlzLmVsZW1lbnQsIG9wdGlvbi5tdWx0aXBvaW50RW5kIHx8IG5vb3ApOwogICAgICB0aGlzLnBpbmNoID0gd3JhcEZ1bmModGhpcy5lbGVtZW50LCBvcHRpb24ucGluY2ggfHwgbm9vcCk7CiAgICAgIHRoaXMuc3dpcGUgPSB3cmFwRnVuYyh0aGlzLmVsZW1lbnQsIG9wdGlvbi5zd2lwZSB8fCBub29wKTsKICAgICAgdGhpcy50YXAgPSB3cmFwRnVuYyh0aGlzLmVsZW1lbnQsIG9wdGlvbi50YXAgfHwgbm9vcCk7CiAgICAgIHRoaXMuZG91YmxlVGFwID0gd3JhcEZ1bmModGhpcy5lbGVtZW50LCBvcHRpb24uZG91YmxlVGFwIHx8IG5vb3ApOwogICAgICB0aGlzLmxvbmdUYXAgPSB3cmFwRnVuYyh0aGlzLmVsZW1lbnQsIG9wdGlvbi5sb25nVGFwIHx8IG5vb3ApOwogICAgICB0aGlzLnNpbmdsZVRhcCA9IHdyYXBGdW5jKHRoaXMuZWxlbWVudCwgb3B0aW9uLnNpbmdsZVRhcCB8fCBub29wKTsKICAgICAgdGhpcy5wcmVzc01vdmUgPSB3cmFwRnVuYyh0aGlzLmVsZW1lbnQsIG9wdGlvbi5wcmVzc01vdmUgfHwgbm9vcCk7CiAgICAgIHRoaXMudHdvRmluZ2VyUHJlc3NNb3ZlID0gd3JhcEZ1bmModGhpcy5lbGVtZW50LCBvcHRpb24udHdvRmluZ2VyUHJlc3NNb3ZlIHx8IG5vb3ApOwogICAgICB0aGlzLnRvdWNoTW92ZSA9IHdyYXBGdW5jKHRoaXMuZWxlbWVudCwgb3B0aW9uLnRvdWNoTW92ZSB8fCBub29wKTsKICAgICAgdGhpcy50b3VjaEVuZCA9IHdyYXBGdW5jKHRoaXMuZWxlbWVudCwgb3B0aW9uLnRvdWNoRW5kIHx8IG5vb3ApOwogICAgICB0aGlzLnRvdWNoQ2FuY2VsID0gd3JhcEZ1bmModGhpcy5lbGVtZW50LCBvcHRpb24udG91Y2hDYW5jZWwgfHwgbm9vcCk7CiAgICAgIHRoaXMuX2NhbmNlbEFsbEhhbmRsZXIgPSB0aGlzLmNhbmNlbEFsbC5iaW5kKHRoaXMpOwogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5fY2FuY2VsQWxsSGFuZGxlcik7CiAgICAgIHRoaXMuZGVsdGEgPSBudWxsOwogICAgICB0aGlzLmxhc3QgPSBudWxsOwogICAgICB0aGlzLm5vdyA9IG51bGw7CiAgICAgIHRoaXMudGFwVGltZW91dCA9IG51bGw7CiAgICAgIHRoaXMuc2luZ2xlVGFwVGltZW91dCA9IG51bGw7CiAgICAgIHRoaXMubG9uZ1RhcFRpbWVvdXQgPSBudWxsOwogICAgICB0aGlzLnN3aXBlVGltZW91dCA9IG51bGw7CiAgICAgIHRoaXMueDEgPSB0aGlzLngyID0gdGhpcy55MSA9IHRoaXMueTIgPSBudWxsOwogICAgICB0aGlzLnByZVRhcFBvc2l0aW9uID0gewogICAgICAgIHg6IG51bGwsCiAgICAgICAgeTogbnVsbAogICAgICB9OwogICAgfQoKICAgIF9jcmVhdGVDbGFzcyhUb3VjaEV2ZW50cywgW3sKICAgICAga2V5OiAic3RhcnQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gc3RhcnQoZXZ0KSB7CiAgICAgICAgaWYgKCFldnQudG91Y2hlcykgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5ub3cgPSBEYXRlLm5vdygpOwogICAgICAgIHRoaXMueDEgPSBldnQudG91Y2hlc1swXS5wYWdlWDsKICAgICAgICB0aGlzLnkxID0gZXZ0LnRvdWNoZXNbMF0ucGFnZVk7CiAgICAgICAgdGhpcy5kZWx0YSA9IHRoaXMubm93IC0gKHRoaXMubGFzdCB8fCB0aGlzLm5vdyk7CiAgICAgICAgdGhpcy50b3VjaFN0YXJ0LmRpc3BhdGNoKGV2dCwgdGhpcy5lbGVtZW50KTsKCiAgICAgICAgaWYgKHRoaXMucHJlVGFwUG9zaXRpb24ueCAhPT0gbnVsbCkgewogICAgICAgICAgdGhpcy5pc0RvdWJsZVRhcCA9IHRoaXMuZGVsdGEgPiAwICYmIHRoaXMuZGVsdGEgPD0gMjUwICYmIE1hdGguYWJzKHRoaXMucHJlVGFwUG9zaXRpb24ueCAtIHRoaXMueDEpIDwgMzAgJiYgTWF0aC5hYnModGhpcy5wcmVUYXBQb3NpdGlvbi55IC0gdGhpcy55MSkgPCAzMDsKCiAgICAgICAgICBpZiAodGhpcy5pc0RvdWJsZVRhcCkgewogICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5zaW5nbGVUYXBUaW1lb3V0KTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMucHJlVGFwUG9zaXRpb24ueCA9IHRoaXMueDE7CiAgICAgICAgdGhpcy5wcmVUYXBQb3NpdGlvbi55ID0gdGhpcy55MTsKICAgICAgICB0aGlzLmxhc3QgPSB0aGlzLm5vdzsKICAgICAgICB2YXIgcHJlViA9IHRoaXMucHJlViwKICAgICAgICAgICAgbGVuID0gZXZ0LnRvdWNoZXMubGVuZ3RoOwoKICAgICAgICBpZiAobGVuID4gMSkgewogICAgICAgICAgdGhpcy5fY2FuY2VsTG9uZ1RhcCgpOwoKICAgICAgICAgIHRoaXMuX2NhbmNlbFNpbmdsZVRhcCgpOwoKICAgICAgICAgIHZhciB2ID0gewogICAgICAgICAgICB4OiBldnQudG91Y2hlc1sxXS5wYWdlWCAtIHRoaXMueDEsCiAgICAgICAgICAgIHk6IGV2dC50b3VjaGVzWzFdLnBhZ2VZIC0gdGhpcy55MQogICAgICAgICAgfTsKICAgICAgICAgIHByZVYueCA9IHYueDsKICAgICAgICAgIHByZVYueSA9IHYueTsKICAgICAgICAgIHRoaXMucGluY2hTdGFydExlbiA9IGdldExlbihwcmVWKTsKICAgICAgICAgIHRoaXMubXVsdGlwb2ludFN0YXJ0LmRpc3BhdGNoKGV2dCwgdGhpcy5lbGVtZW50KTsKICAgICAgICB9CgogICAgICAgIHRoaXMuX3ByZXZlbnRUYXAgPSBmYWxzZTsKICAgICAgICB0aGlzLmxvbmdUYXBUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aGlzLmxvbmdUYXAuZGlzcGF0Y2goZXZ0LCB0aGlzLmVsZW1lbnQpOwogICAgICAgICAgdGhpcy5fcHJldmVudFRhcCA9IHRydWU7CiAgICAgICAgfS5iaW5kKHRoaXMpLCA3NTApOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm1vdmUiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gbW92ZShldnQpIHsKICAgICAgICBpZiAoIWV2dC50b3VjaGVzKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgcHJlViA9IHRoaXMucHJlViwKICAgICAgICAgICAgbGVuID0gZXZ0LnRvdWNoZXMubGVuZ3RoLAogICAgICAgICAgICBjdXJyZW50WCA9IGV2dC50b3VjaGVzWzBdLnBhZ2VYLAogICAgICAgICAgICBjdXJyZW50WSA9IGV2dC50b3VjaGVzWzBdLnBhZ2VZOwogICAgICAgIHRoaXMuaXNEb3VibGVUYXAgPSBmYWxzZTsKCiAgICAgICAgaWYgKGxlbiA+IDEpIHsKICAgICAgICAgIHZhciBzQ3VycmVudFggPSBldnQudG91Y2hlc1sxXS5wYWdlWCwKICAgICAgICAgICAgICBzQ3VycmVudFkgPSBldnQudG91Y2hlc1sxXS5wYWdlWTsKICAgICAgICAgIHZhciB2ID0gewogICAgICAgICAgICB4OiBldnQudG91Y2hlc1sxXS5wYWdlWCAtIGN1cnJlbnRYLAogICAgICAgICAgICB5OiBldnQudG91Y2hlc1sxXS5wYWdlWSAtIGN1cnJlbnRZCiAgICAgICAgICB9OwoKICAgICAgICAgIGlmIChwcmVWLnggIT09IG51bGwpIHsKICAgICAgICAgICAgaWYgKHRoaXMucGluY2hTdGFydExlbiA+IDApIHsKICAgICAgICAgICAgICBldnQuem9vbSA9IGdldExlbih2KSAvIHRoaXMucGluY2hTdGFydExlbjsKICAgICAgICAgICAgICB0aGlzLnBpbmNoLmRpc3BhdGNoKGV2dCwgdGhpcy5lbGVtZW50KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXZ0LmFuZ2xlID0gZ2V0Um90YXRlQW5nbGUodiwgcHJlVik7CiAgICAgICAgICAgIHRoaXMucm90YXRlLmRpc3BhdGNoKGV2dCwgdGhpcy5lbGVtZW50KTsKICAgICAgICAgIH0KCiAgICAgICAgICBwcmVWLnggPSB2Lng7CiAgICAgICAgICBwcmVWLnkgPSB2Lnk7CgogICAgICAgICAgaWYgKHRoaXMueDIgIT09IG51bGwgJiYgdGhpcy5zeDIgIT09IG51bGwpIHsKICAgICAgICAgICAgZXZ0LmRlbHRhWCA9IChjdXJyZW50WCAtIHRoaXMueDIgKyBzQ3VycmVudFggLSB0aGlzLnN4MikgLyAyOwogICAgICAgICAgICBldnQuZGVsdGFZID0gKGN1cnJlbnRZIC0gdGhpcy55MiArIHNDdXJyZW50WSAtIHRoaXMuc3kyKSAvIDI7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBldnQuZGVsdGFYID0gMDsKICAgICAgICAgICAgZXZ0LmRlbHRhWSA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy50d29GaW5nZXJQcmVzc01vdmUuZGlzcGF0Y2goZXZ0LCB0aGlzLmVsZW1lbnQpOwogICAgICAgICAgdGhpcy5zeDIgPSBzQ3VycmVudFg7CiAgICAgICAgICB0aGlzLnN5MiA9IHNDdXJyZW50WTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHRoaXMueDIgIT09IG51bGwpIHsKICAgICAgICAgICAgZXZ0LmRlbHRhWCA9IGN1cnJlbnRYIC0gdGhpcy54MjsKICAgICAgICAgICAgZXZ0LmRlbHRhWSA9IGN1cnJlbnRZIC0gdGhpcy55MjsKICAgICAgICAgICAgdmFyIG1vdmVkWCA9IE1hdGguYWJzKHRoaXMueDEgLSB0aGlzLngyKSwKICAgICAgICAgICAgICAgIG1vdmVkWSA9IE1hdGguYWJzKHRoaXMueTEgLSB0aGlzLnkyKTsKCiAgICAgICAgICAgIGlmIChtb3ZlZFggPiAxMCB8fCBtb3ZlZFkgPiAxMCkgewogICAgICAgICAgICAgIHRoaXMuX3ByZXZlbnRUYXAgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBldnQuZGVsdGFYID0gMDsKICAgICAgICAgICAgZXZ0LmRlbHRhWSA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5wcmVzc01vdmUuZGlzcGF0Y2goZXZ0LCB0aGlzLmVsZW1lbnQpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy50b3VjaE1vdmUuZGlzcGF0Y2goZXZ0LCB0aGlzLmVsZW1lbnQpOwoKICAgICAgICB0aGlzLl9jYW5jZWxMb25nVGFwKCk7CgogICAgICAgIHRoaXMueDIgPSBjdXJyZW50WDsKICAgICAgICB0aGlzLnkyID0gY3VycmVudFk7CgogICAgICAgIGlmIChsZW4gPiAxKSB7CiAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGVuZChldnQpIHsKICAgICAgICBpZiAoIWV2dC5jaGFuZ2VkVG91Y2hlcykgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5fY2FuY2VsTG9uZ1RhcCgpOwoKICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgICAgIGlmIChldnQudG91Y2hlcy5sZW5ndGggPCAyKSB7CiAgICAgICAgICB0aGlzLm11bHRpcG9pbnRFbmQuZGlzcGF0Y2goZXZ0LCB0aGlzLmVsZW1lbnQpOwogICAgICAgICAgdGhpcy5zeDIgPSB0aGlzLnN5MiA9IG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy54MiAmJiBNYXRoLmFicyh0aGlzLngxIC0gdGhpcy54MikgPiAzMCB8fCB0aGlzLnkyICYmIE1hdGguYWJzKHRoaXMueTEgLSB0aGlzLnkyKSA+IDMwKSB7CiAgICAgICAgICBldnQuZGlyZWN0aW9uID0gdGhpcy5fc3dpcGVEaXJlY3Rpb24odGhpcy54MSwgdGhpcy54MiwgdGhpcy55MSwgdGhpcy55Mik7CiAgICAgICAgICB0aGlzLnN3aXBlVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzZWxmLnN3aXBlLmRpc3BhdGNoKGV2dCwgc2VsZi5lbGVtZW50KTsKICAgICAgICAgIH0sIDApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnRhcFRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKCFzZWxmLl9wcmV2ZW50VGFwKSB7CiAgICAgICAgICAgICAgc2VsZi50YXAuZGlzcGF0Y2goZXZ0LCBzZWxmLmVsZW1lbnQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc2VsZi5pc0RvdWJsZVRhcCkgewogICAgICAgICAgICAgIHNlbGYuZG91YmxlVGFwLmRpc3BhdGNoKGV2dCwgc2VsZi5lbGVtZW50KTsKICAgICAgICAgICAgICBzZWxmLmlzRG91YmxlVGFwID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIDApOwoKICAgICAgICAgIGlmICghc2VsZi5pc0RvdWJsZVRhcCkgewogICAgICAgICAgICBzZWxmLnNpbmdsZVRhcFRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBzZWxmLnNpbmdsZVRhcC5kaXNwYXRjaChldnQsIHNlbGYuZWxlbWVudCk7CiAgICAgICAgICAgIH0sIDI1MCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0aGlzLnRvdWNoRW5kLmRpc3BhdGNoKGV2dCwgdGhpcy5lbGVtZW50KTsKICAgICAgICB0aGlzLnByZVYueCA9IDA7CiAgICAgICAgdGhpcy5wcmVWLnkgPSAwOwogICAgICAgIHRoaXMuem9vbSA9IDE7CiAgICAgICAgdGhpcy5waW5jaFN0YXJ0TGVuID0gbnVsbDsKICAgICAgICB0aGlzLngxID0gdGhpcy54MiA9IHRoaXMueTEgPSB0aGlzLnkyID0gbnVsbDsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJjYW5jZWxBbGwiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gY2FuY2VsQWxsKCkgewogICAgICAgIHRoaXMuX3ByZXZlbnRUYXAgPSB0cnVlOwogICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNpbmdsZVRhcFRpbWVvdXQpOwogICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRhcFRpbWVvdXQpOwogICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmxvbmdUYXBUaW1lb3V0KTsKICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5zd2lwZVRpbWVvdXQpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNhbmNlbCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjYW5jZWwoZXZ0KSB7CiAgICAgICAgdGhpcy5jYW5jZWxBbGwoKTsKICAgICAgICB0aGlzLnRvdWNoQ2FuY2VsLmRpc3BhdGNoKGV2dCwgdGhpcy5lbGVtZW50KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJfY2FuY2VsTG9uZ1RhcCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBfY2FuY2VsTG9uZ1RhcCgpIHsKICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5sb25nVGFwVGltZW91dCk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiX2NhbmNlbFNpbmdsZVRhcCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBfY2FuY2VsU2luZ2xlVGFwKCkgewogICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNpbmdsZVRhcFRpbWVvdXQpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIl9zd2lwZURpcmVjdGlvbiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc3dpcGVEaXJlY3Rpb24oeDEsIHgyLCB5MSwgeTIpIHsKICAgICAgICByZXR1cm4gTWF0aC5hYnMoeDEgLSB4MikgPj0gTWF0aC5hYnMoeTEgLSB5MikgPyB4MSAtIHgyID4gMCA/ICdMZWZ0JyA6ICdSaWdodCcgOiB5MSAtIHkyID4gMCA/ICdVcCcgOiAnRG93bic7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAib24iLAogICAgICB2YWx1ZTogZnVuY3Rpb24gb24oZXZ0LCBoYW5kbGVyKSB7CiAgICAgICAgaWYgKHRoaXNbZXZ0XSkgewogICAgICAgICAgdGhpc1tldnRdLmFkZChoYW5kbGVyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAib2ZmIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9mZihldnQsIGhhbmRsZXIpIHsKICAgICAgICBpZiAodGhpc1tldnRdKSB7CiAgICAgICAgICB0aGlzW2V2dF0uZGVsKGhhbmRsZXIpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJkZXN0cm95IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7CiAgICAgICAgaWYgKHRoaXMuc2luZ2xlVGFwVGltZW91dCkgewogICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc2luZ2xlVGFwVGltZW91dCk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy50YXBUaW1lb3V0KSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50YXBUaW1lb3V0KTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmxvbmdUYXBUaW1lb3V0KSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5sb25nVGFwVGltZW91dCk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5zd2lwZVRpbWVvdXQpIHsKICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnN3aXBlVGltZW91dCk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIHRoaXMuc3RhcnQpOwogICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0aGlzLm1vdmUpOwogICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMuZW5kKTsKICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hjYW5jZWwnLCB0aGlzLmNhbmNlbCk7CiAgICAgICAgdGhpcy5yb3RhdGUuZGVsKCk7CiAgICAgICAgdGhpcy50b3VjaFN0YXJ0LmRlbCgpOwogICAgICAgIHRoaXMubXVsdGlwb2ludFN0YXJ0LmRlbCgpOwogICAgICAgIHRoaXMubXVsdGlwb2ludEVuZC5kZWwoKTsKICAgICAgICB0aGlzLnBpbmNoLmRlbCgpOwogICAgICAgIHRoaXMuc3dpcGUuZGVsKCk7CiAgICAgICAgdGhpcy50YXAuZGVsKCk7CiAgICAgICAgdGhpcy5kb3VibGVUYXAuZGVsKCk7CiAgICAgICAgdGhpcy5sb25nVGFwLmRlbCgpOwogICAgICAgIHRoaXMuc2luZ2xlVGFwLmRlbCgpOwogICAgICAgIHRoaXMucHJlc3NNb3ZlLmRlbCgpOwogICAgICAgIHRoaXMudHdvRmluZ2VyUHJlc3NNb3ZlLmRlbCgpOwogICAgICAgIHRoaXMudG91Y2hNb3ZlLmRlbCgpOwogICAgICAgIHRoaXMudG91Y2hFbmQuZGVsKCk7CiAgICAgICAgdGhpcy50b3VjaENhbmNlbC5kZWwoKTsKICAgICAgICB0aGlzLnByZVYgPSB0aGlzLnBpbmNoU3RhcnRMZW4gPSB0aGlzLnpvb20gPSB0aGlzLmlzRG91YmxlVGFwID0gdGhpcy5kZWx0YSA9IHRoaXMubGFzdCA9IHRoaXMubm93ID0gdGhpcy50YXBUaW1lb3V0ID0gdGhpcy5zaW5nbGVUYXBUaW1lb3V0ID0gdGhpcy5sb25nVGFwVGltZW91dCA9IHRoaXMuc3dpcGVUaW1lb3V0ID0gdGhpcy54MSA9IHRoaXMueDIgPSB0aGlzLnkxID0gdGhpcy55MiA9IHRoaXMucHJlVGFwUG9zaXRpb24gPSB0aGlzLnJvdGF0ZSA9IHRoaXMudG91Y2hTdGFydCA9IHRoaXMubXVsdGlwb2ludFN0YXJ0ID0gdGhpcy5tdWx0aXBvaW50RW5kID0gdGhpcy5waW5jaCA9IHRoaXMuc3dpcGUgPSB0aGlzLnRhcCA9IHRoaXMuZG91YmxlVGFwID0gdGhpcy5sb25nVGFwID0gdGhpcy5zaW5nbGVUYXAgPSB0aGlzLnByZXNzTW92ZSA9IHRoaXMudG91Y2hNb3ZlID0gdGhpcy50b3VjaEVuZCA9IHRoaXMudG91Y2hDYW5jZWwgPSB0aGlzLnR3b0ZpbmdlclByZXNzTW92ZSA9IG51bGw7CiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuX2NhbmNlbEFsbEhhbmRsZXIpOwogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9XSk7CgogICAgcmV0dXJuIFRvdWNoRXZlbnRzOwogIH0oKTsKCiAgZnVuY3Rpb24gcmVzZXRTbGlkZU1vdmUoc2xpZGUpIHsKICAgIHZhciB0cmFuc2l0aW9uRW5kID0gd2hpY2hUcmFuc2l0aW9uRXZlbnQoKTsKICAgIHZhciBtZWRpYSA9IGhhc0NsYXNzKHNsaWRlLCAnZ3NsaWRlLW1lZGlhJykgPyBzbGlkZSA6IHNsaWRlLnF1ZXJ5U2VsZWN0b3IoJy5nc2xpZGUtbWVkaWEnKTsKICAgIHZhciBkZXNjID0gc2xpZGUucXVlcnlTZWxlY3RvcignLmdzbGlkZS1kZXNjcmlwdGlvbicpOwogICAgYWRkQ2xhc3MobWVkaWEsICdncmVzZXQnKTsKICAgIGNzc1RyYW5zZm9ybShtZWRpYSwgJ3RyYW5zbGF0ZTNkKDAsIDAsIDApJyk7CiAgICBhZGRFdmVudCh0cmFuc2l0aW9uRW5kLCB7CiAgICAgIG9uRWxlbWVudDogbWVkaWEsCiAgICAgIG9uY2U6IHRydWUsCiAgICAgIHdpdGhDYWxsYmFjazogZnVuY3Rpb24gd2l0aENhbGxiYWNrKGV2ZW50LCB0YXJnZXQpIHsKICAgICAgICByZW1vdmVDbGFzcyhtZWRpYSwgJ2dyZXNldCcpOwogICAgICB9CiAgICB9KTsKICAgIG1lZGlhLnN0eWxlLm9wYWNpdHkgPSAnJzsKCiAgICBpZiAoZGVzYykgewogICAgICBkZXNjLnN0eWxlLm9wYWNpdHkgPSAnJzsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHRvdWNoTmF2aWdhdGlvbihpbnN0YW5jZSkgewogICAgaWYgKGluc3RhbmNlLmV2ZW50cy5oYXNPd25Qcm9wZXJ0eSgndG91Y2gnKSkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdmFyIHdpblNpemUgPSB3aW5kb3dTaXplKCk7CiAgICB2YXIgd2luV2lkdGggPSB3aW5TaXplLndpZHRoOwogICAgdmFyIHdpbkhlaWdodCA9IHdpblNpemUuaGVpZ2h0OwogICAgdmFyIHByb2Nlc3MgPSBmYWxzZTsKICAgIHZhciBjdXJyZW50U2xpZGUgPSBudWxsOwogICAgdmFyIG1lZGlhID0gbnVsbDsKICAgIHZhciBtZWRpYUltYWdlID0gbnVsbDsKICAgIHZhciBkb2luZ01vdmUgPSBmYWxzZTsKICAgIHZhciBpbml0U2NhbGUgPSAxOwogICAgdmFyIG1heFNjYWxlID0gNC41OwogICAgdmFyIGN1cnJlbnRTY2FsZSA9IDE7CiAgICB2YXIgZG9pbmdab29tID0gZmFsc2U7CiAgICB2YXIgaW1hZ2Vab29tZWQgPSBmYWxzZTsKICAgIHZhciB6b29tZWRQb3NYID0gbnVsbDsKICAgIHZhciB6b29tZWRQb3NZID0gbnVsbDsKICAgIHZhciBsYXN0Wm9vbWVkUG9zWCA9IG51bGw7CiAgICB2YXIgbGFzdFpvb21lZFBvc1kgPSBudWxsOwogICAgdmFyIGhEaXN0YW5jZTsKICAgIHZhciB2RGlzdGFuY2U7CiAgICB2YXIgaERpc3RhbmNlUGVyY2VudCA9IDA7CiAgICB2YXIgdkRpc3RhbmNlUGVyY2VudCA9IDA7CiAgICB2YXIgdlN3aXBlID0gZmFsc2U7CiAgICB2YXIgaFN3aXBlID0gZmFsc2U7CiAgICB2YXIgc3RhcnRDb29yZHMgPSB7fTsKICAgIHZhciBlbmRDb29yZHMgPSB7fTsKICAgIHZhciB4RG93biA9IDA7CiAgICB2YXIgeURvd24gPSAwOwogICAgdmFyIGlzSW5saW5lZDsKICAgIHZhciBzbGlkZXJXcmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dsaWdodGJveC1zbGlkZXInKTsKICAgIHZhciBvdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdvdmVybGF5Jyk7CiAgICB2YXIgdG91Y2hJbnN0YW5jZSA9IG5ldyBUb3VjaEV2ZW50cyhzbGlkZXJXcmFwcGVyLCB7CiAgICAgIHRvdWNoU3RhcnQ6IGZ1bmN0aW9uIHRvdWNoU3RhcnQoZSkgewogICAgICAgIHByb2Nlc3MgPSB0cnVlOwoKICAgICAgICBpZiAoaGFzQ2xhc3MoZS50YXJnZXRUb3VjaGVzWzBdLnRhcmdldCwgJ2dpbm5lci1jb250YWluZXInKSB8fCBjbG9zZXN0KGUudGFyZ2V0VG91Y2hlc1swXS50YXJnZXQsICcuZ3NsaWRlLWRlc2MnKSB8fCBlLnRhcmdldFRvdWNoZXNbMF0udGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT0gJ2EnKSB7CiAgICAgICAgICBwcm9jZXNzID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAoY2xvc2VzdChlLnRhcmdldFRvdWNoZXNbMF0udGFyZ2V0LCAnLmdzbGlkZS1pbmxpbmUnKSAmJiAhaGFzQ2xhc3MoZS50YXJnZXRUb3VjaGVzWzBdLnRhcmdldC5wYXJlbnROb2RlLCAnZ3NsaWRlLWlubGluZScpKSB7CiAgICAgICAgICBwcm9jZXNzID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAocHJvY2VzcykgewogICAgICAgICAgZW5kQ29vcmRzID0gZS50YXJnZXRUb3VjaGVzWzBdOwogICAgICAgICAgc3RhcnRDb29yZHMucGFnZVggPSBlLnRhcmdldFRvdWNoZXNbMF0ucGFnZVg7CiAgICAgICAgICBzdGFydENvb3Jkcy5wYWdlWSA9IGUudGFyZ2V0VG91Y2hlc1swXS5wYWdlWTsKICAgICAgICAgIHhEb3duID0gZS50YXJnZXRUb3VjaGVzWzBdLmNsaWVudFg7CiAgICAgICAgICB5RG93biA9IGUudGFyZ2V0VG91Y2hlc1swXS5jbGllbnRZOwogICAgICAgICAgY3VycmVudFNsaWRlID0gaW5zdGFuY2UuYWN0aXZlU2xpZGU7CiAgICAgICAgICBtZWRpYSA9IGN1cnJlbnRTbGlkZS5xdWVyeVNlbGVjdG9yKCcuZ3NsaWRlLW1lZGlhJyk7CiAgICAgICAgICBpc0lubGluZWQgPSBjdXJyZW50U2xpZGUucXVlcnlTZWxlY3RvcignLmdzbGlkZS1pbmxpbmUnKTsKICAgICAgICAgIG1lZGlhSW1hZ2UgPSBudWxsOwoKICAgICAgICAgIGlmIChoYXNDbGFzcyhtZWRpYSwgJ2dzbGlkZS1pbWFnZScpKSB7CiAgICAgICAgICAgIG1lZGlhSW1hZ2UgPSBtZWRpYS5xdWVyeVNlbGVjdG9yKCdpbWcnKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZW1vdmVDbGFzcyhvdmVybGF5LCAnZ3Jlc2V0Jyk7CgogICAgICAgICAgaWYgKGUucGFnZVggPiAyMCAmJiBlLnBhZ2VYIDwgd2luZG93LmlubmVyV2lkdGggLSAyMCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdG91Y2hNb3ZlOiBmdW5jdGlvbiB0b3VjaE1vdmUoZSkgewogICAgICAgIGlmICghcHJvY2VzcykgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgZW5kQ29vcmRzID0gZS50YXJnZXRUb3VjaGVzWzBdOwoKICAgICAgICBpZiAoZG9pbmdab29tIHx8IGltYWdlWm9vbWVkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoaXNJbmxpbmVkICYmIGlzSW5saW5lZC5vZmZzZXRIZWlnaHQgPiB3aW5IZWlnaHQpIHsKICAgICAgICAgIHZhciBtb3ZlZCA9IHN0YXJ0Q29vcmRzLnBhZ2VYIC0gZW5kQ29vcmRzLnBhZ2VYOwoKICAgICAgICAgIGlmIChNYXRoLmFicyhtb3ZlZCkgPD0gMTMpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZG9pbmdNb3ZlID0gdHJ1ZTsKICAgICAgICB2YXIgeFVwID0gZS50YXJnZXRUb3VjaGVzWzBdLmNsaWVudFg7CiAgICAgICAgdmFyIHlVcCA9IGUudGFyZ2V0VG91Y2hlc1swXS5jbGllbnRZOwogICAgICAgIHZhciB4RGlmZiA9IHhEb3duIC0geFVwOwogICAgICAgIHZhciB5RGlmZiA9IHlEb3duIC0geVVwOwoKICAgICAgICBpZiAoTWF0aC5hYnMoeERpZmYpID4gTWF0aC5hYnMoeURpZmYpKSB7CiAgICAgICAgICB2U3dpcGUgPSBmYWxzZTsKICAgICAgICAgIGhTd2lwZSA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGhTd2lwZSA9IGZhbHNlOwogICAgICAgICAgdlN3aXBlID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGhEaXN0YW5jZSA9IGVuZENvb3Jkcy5wYWdlWCAtIHN0YXJ0Q29vcmRzLnBhZ2VYOwogICAgICAgIGhEaXN0YW5jZVBlcmNlbnQgPSBoRGlzdGFuY2UgKiAxMDAgLyB3aW5XaWR0aDsKICAgICAgICB2RGlzdGFuY2UgPSBlbmRDb29yZHMucGFnZVkgLSBzdGFydENvb3Jkcy5wYWdlWTsKICAgICAgICB2RGlzdGFuY2VQZXJjZW50ID0gdkRpc3RhbmNlICogMTAwIC8gd2luSGVpZ2h0OwogICAgICAgIHZhciBvcGFjaXR5OwoKICAgICAgICBpZiAodlN3aXBlICYmIG1lZGlhSW1hZ2UpIHsKICAgICAgICAgIG9wYWNpdHkgPSAxIC0gTWF0aC5hYnModkRpc3RhbmNlKSAvIHdpbkhlaWdodDsKICAgICAgICAgIG92ZXJsYXkuc3R5bGUub3BhY2l0eSA9IG9wYWNpdHk7CgogICAgICAgICAgaWYgKGluc3RhbmNlLnNldHRpbmdzLnRvdWNoRm9sbG93QXhpcykgewogICAgICAgICAgICBoRGlzdGFuY2VQZXJjZW50ID0gMDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChoU3dpcGUpIHsKICAgICAgICAgIG9wYWNpdHkgPSAxIC0gTWF0aC5hYnMoaERpc3RhbmNlKSAvIHdpbldpZHRoOwogICAgICAgICAgbWVkaWEuc3R5bGUub3BhY2l0eSA9IG9wYWNpdHk7CgogICAgICAgICAgaWYgKGluc3RhbmNlLnNldHRpbmdzLnRvdWNoRm9sbG93QXhpcykgewogICAgICAgICAgICB2RGlzdGFuY2VQZXJjZW50ID0gMDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICghbWVkaWFJbWFnZSkgewogICAgICAgICAgcmV0dXJuIGNzc1RyYW5zZm9ybShtZWRpYSwgInRyYW5zbGF0ZTNkKCIuY29uY2F0KGhEaXN0YW5jZVBlcmNlbnQsICIlLCAwLCAwKSIpKTsKICAgICAgICB9CgogICAgICAgIGNzc1RyYW5zZm9ybShtZWRpYSwgInRyYW5zbGF0ZTNkKCIuY29uY2F0KGhEaXN0YW5jZVBlcmNlbnQsICIlLCAiKS5jb25jYXQodkRpc3RhbmNlUGVyY2VudCwgIiUsIDApIikpOwogICAgICB9LAogICAgICB0b3VjaEVuZDogZnVuY3Rpb24gdG91Y2hFbmQoKSB7CiAgICAgICAgaWYgKCFwcm9jZXNzKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBkb2luZ01vdmUgPSBmYWxzZTsKCiAgICAgICAgaWYgKGltYWdlWm9vbWVkIHx8IGRvaW5nWm9vbSkgewogICAgICAgICAgbGFzdFpvb21lZFBvc1ggPSB6b29tZWRQb3NYOwogICAgICAgICAgbGFzdFpvb21lZFBvc1kgPSB6b29tZWRQb3NZOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIHYgPSBNYXRoLmFicyhwYXJzZUludCh2RGlzdGFuY2VQZXJjZW50KSk7CiAgICAgICAgdmFyIGggPSBNYXRoLmFicyhwYXJzZUludChoRGlzdGFuY2VQZXJjZW50KSk7CgogICAgICAgIGlmICh2ID4gMjkgJiYgbWVkaWFJbWFnZSkgewogICAgICAgICAgaW5zdGFuY2UuY2xvc2UoKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh2IDwgMjkgJiYgaCA8IDI1KSB7CiAgICAgICAgICBhZGRDbGFzcyhvdmVybGF5LCAnZ3Jlc2V0Jyk7CiAgICAgICAgICBvdmVybGF5LnN0eWxlLm9wYWNpdHkgPSAxOwogICAgICAgICAgcmV0dXJuIHJlc2V0U2xpZGVNb3ZlKG1lZGlhKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG11bHRpcG9pbnRFbmQ6IGZ1bmN0aW9uIG11bHRpcG9pbnRFbmQoKSB7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBkb2luZ1pvb20gPSBmYWxzZTsKICAgICAgICB9LCA1MCk7CiAgICAgIH0sCiAgICAgIG11bHRpcG9pbnRTdGFydDogZnVuY3Rpb24gbXVsdGlwb2ludFN0YXJ0KCkgewogICAgICAgIGRvaW5nWm9vbSA9IHRydWU7CiAgICAgICAgaW5pdFNjYWxlID0gY3VycmVudFNjYWxlID8gY3VycmVudFNjYWxlIDogMTsKICAgICAgfSwKICAgICAgcGluY2g6IGZ1bmN0aW9uIHBpbmNoKGV2dCkgewogICAgICAgIGlmICghbWVkaWFJbWFnZSB8fCBkb2luZ01vdmUpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGRvaW5nWm9vbSA9IHRydWU7CiAgICAgICAgbWVkaWFJbWFnZS5zY2FsZVggPSBtZWRpYUltYWdlLnNjYWxlWSA9IGluaXRTY2FsZSAqIGV2dC56b29tOwogICAgICAgIHZhciBzY2FsZSA9IGluaXRTY2FsZSAqIGV2dC56b29tOwogICAgICAgIGltYWdlWm9vbWVkID0gdHJ1ZTsKCiAgICAgICAgaWYgKHNjYWxlIDw9IDEpIHsKICAgICAgICAgIGltYWdlWm9vbWVkID0gZmFsc2U7CiAgICAgICAgICBzY2FsZSA9IDE7CiAgICAgICAgICBsYXN0Wm9vbWVkUG9zWSA9IG51bGw7CiAgICAgICAgICBsYXN0Wm9vbWVkUG9zWCA9IG51bGw7CiAgICAgICAgICB6b29tZWRQb3NYID0gbnVsbDsKICAgICAgICAgIHpvb21lZFBvc1kgPSBudWxsOwogICAgICAgICAgbWVkaWFJbWFnZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJycpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKHNjYWxlID4gbWF4U2NhbGUpIHsKICAgICAgICAgIHNjYWxlID0gbWF4U2NhbGU7CiAgICAgICAgfQoKICAgICAgICBtZWRpYUltYWdlLnN0eWxlLnRyYW5zZm9ybSA9ICJzY2FsZTNkKCIuY29uY2F0KHNjYWxlLCAiLCAiKS5jb25jYXQoc2NhbGUsICIsIDEpIik7CiAgICAgICAgY3VycmVudFNjYWxlID0gc2NhbGU7CiAgICAgIH0sCiAgICAgIHByZXNzTW92ZTogZnVuY3Rpb24gcHJlc3NNb3ZlKGUpIHsKICAgICAgICBpZiAoaW1hZ2Vab29tZWQgJiYgIWRvaW5nWm9vbSkgewogICAgICAgICAgdmFyIG1oRGlzdGFuY2UgPSBlbmRDb29yZHMucGFnZVggLSBzdGFydENvb3Jkcy5wYWdlWDsKICAgICAgICAgIHZhciBtdkRpc3RhbmNlID0gZW5kQ29vcmRzLnBhZ2VZIC0gc3RhcnRDb29yZHMucGFnZVk7CgogICAgICAgICAgaWYgKGxhc3Rab29tZWRQb3NYKSB7CiAgICAgICAgICAgIG1oRGlzdGFuY2UgPSBtaERpc3RhbmNlICsgbGFzdFpvb21lZFBvc1g7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGxhc3Rab29tZWRQb3NZKSB7CiAgICAgICAgICAgIG12RGlzdGFuY2UgPSBtdkRpc3RhbmNlICsgbGFzdFpvb21lZFBvc1k7CiAgICAgICAgICB9CgogICAgICAgICAgem9vbWVkUG9zWCA9IG1oRGlzdGFuY2U7CiAgICAgICAgICB6b29tZWRQb3NZID0gbXZEaXN0YW5jZTsKICAgICAgICAgIHZhciBzdHlsZSA9ICJ0cmFuc2xhdGUzZCgiLmNvbmNhdChtaERpc3RhbmNlLCAicHgsICIpLmNvbmNhdChtdkRpc3RhbmNlLCAicHgsIDApIik7CgogICAgICAgICAgaWYgKGN1cnJlbnRTY2FsZSkgewogICAgICAgICAgICBzdHlsZSArPSAiIHNjYWxlM2QoIi5jb25jYXQoY3VycmVudFNjYWxlLCAiLCAiKS5jb25jYXQoY3VycmVudFNjYWxlLCAiLCAxKSIpOwogICAgICAgICAgfQoKICAgICAgICAgIGNzc1RyYW5zZm9ybShtZWRpYUltYWdlLCBzdHlsZSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBzd2lwZTogZnVuY3Rpb24gc3dpcGUoZXZ0KSB7CiAgICAgICAgaWYgKGltYWdlWm9vbWVkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoZG9pbmdab29tKSB7CiAgICAgICAgICBkb2luZ1pvb20gPSBmYWxzZTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChldnQuZGlyZWN0aW9uID09ICdMZWZ0JykgewogICAgICAgICAgaWYgKGluc3RhbmNlLmluZGV4ID09IGluc3RhbmNlLmVsZW1lbnRzLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgcmV0dXJuIHJlc2V0U2xpZGVNb3ZlKG1lZGlhKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpbnN0YW5jZS5uZXh0U2xpZGUoKTsKICAgICAgICB9CgogICAgICAgIGlmIChldnQuZGlyZWN0aW9uID09ICdSaWdodCcpIHsKICAgICAgICAgIGlmIChpbnN0YW5jZS5pbmRleCA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiByZXNldFNsaWRlTW92ZShtZWRpYSk7CiAgICAgICAgICB9CgogICAgICAgICAgaW5zdGFuY2UucHJldlNsaWRlKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIGluc3RhbmNlLmV2ZW50c1sndG91Y2gnXSA9IHRvdWNoSW5zdGFuY2U7CiAgfQoKICB2YXIgWm9vbUltYWdlcyA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIFpvb21JbWFnZXMoZWwsIHNsaWRlKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgb25jbG9zZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogbnVsbDsKCiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBab29tSW1hZ2VzKTsKCiAgICAgIHRoaXMuaW1nID0gZWw7CiAgICAgIHRoaXMuc2xpZGUgPSBzbGlkZTsKICAgICAgdGhpcy5vbmNsb3NlID0gb25jbG9zZTsKCiAgICAgIGlmICh0aGlzLmltZy5zZXRab29tRXZlbnRzKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLnpvb21lZEluID0gZmFsc2U7CiAgICAgIHRoaXMuZHJhZ2dpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5jdXJyZW50WCA9IG51bGw7CiAgICAgIHRoaXMuY3VycmVudFkgPSBudWxsOwogICAgICB0aGlzLmluaXRpYWxYID0gbnVsbDsKICAgICAgdGhpcy5pbml0aWFsWSA9IG51bGw7CiAgICAgIHRoaXMueE9mZnNldCA9IDA7CiAgICAgIHRoaXMueU9mZnNldCA9IDA7CiAgICAgIHRoaXMuaW1nLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLmRyYWdTdGFydChlKTsKICAgICAgfSwgZmFsc2UpOwogICAgICB0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gX3RoaXMuZHJhZ0VuZChlKTsKICAgICAgfSwgZmFsc2UpOwogICAgICB0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBfdGhpcy5kcmFnKGUpOwogICAgICB9LCBmYWxzZSk7CiAgICAgIHRoaXMuaW1nLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICBpZiAoX3RoaXMuc2xpZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdkcmFnZ2luZy1uYXYnKSkgewogICAgICAgICAgX3RoaXMuem9vbU91dCgpOwoKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmICghX3RoaXMuem9vbWVkSW4pIHsKICAgICAgICAgIHJldHVybiBfdGhpcy56b29tSW4oKTsKICAgICAgICB9CgogICAgICAgIGlmIChfdGhpcy56b29tZWRJbiAmJiAhX3RoaXMuZHJhZ2dpbmcpIHsKICAgICAgICAgIF90aGlzLnpvb21PdXQoKTsKICAgICAgICB9CiAgICAgIH0sIGZhbHNlKTsKICAgICAgdGhpcy5pbWcuc2V0Wm9vbUV2ZW50cyA9IHRydWU7CiAgICB9CgogICAgX2NyZWF0ZUNsYXNzKFpvb21JbWFnZXMsIFt7CiAgICAgIGtleTogInpvb21JbiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB6b29tSW4oKSB7CiAgICAgICAgdmFyIHdpbldpZHRoID0gdGhpcy53aWRvd1dpZHRoKCk7CgogICAgICAgIGlmICh0aGlzLnpvb21lZEluIHx8IHdpbldpZHRoIDw9IDc2OCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGltZyA9IHRoaXMuaW1nOwogICAgICAgIGltZy5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3R5bGUnLCBpbWcuZ2V0QXR0cmlidXRlKCdzdHlsZScpKTsKICAgICAgICBpbWcuc3R5bGUubWF4V2lkdGggPSBpbWcubmF0dXJhbFdpZHRoICsgJ3B4JzsKICAgICAgICBpbWcuc3R5bGUubWF4SGVpZ2h0ID0gaW1nLm5hdHVyYWxIZWlnaHQgKyAncHgnOwoKICAgICAgICBpZiAoaW1nLm5hdHVyYWxXaWR0aCA+IHdpbldpZHRoKSB7CiAgICAgICAgICB2YXIgY2VudGVyWCA9IHdpbldpZHRoIC8gMiAtIGltZy5uYXR1cmFsV2lkdGggLyAyOwogICAgICAgICAgdGhpcy5zZXRUcmFuc2xhdGUodGhpcy5pbWcucGFyZW50Tm9kZSwgY2VudGVyWCwgMCk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnNsaWRlLmNsYXNzTGlzdC5hZGQoJ3pvb21lZCcpOwogICAgICAgIHRoaXMuem9vbWVkSW4gPSB0cnVlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInpvb21PdXQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gem9vbU91dCgpIHsKICAgICAgICB0aGlzLmltZy5wYXJlbnROb2RlLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnJyk7CiAgICAgICAgdGhpcy5pbWcuc2V0QXR0cmlidXRlKCdzdHlsZScsIHRoaXMuaW1nLmdldEF0dHJpYnV0ZSgnZGF0YS1zdHlsZScpKTsKICAgICAgICB0aGlzLnNsaWRlLmNsYXNzTGlzdC5yZW1vdmUoJ3pvb21lZCcpOwogICAgICAgIHRoaXMuem9vbWVkSW4gPSBmYWxzZTsKICAgICAgICB0aGlzLmN1cnJlbnRYID0gbnVsbDsKICAgICAgICB0aGlzLmN1cnJlbnRZID0gbnVsbDsKICAgICAgICB0aGlzLmluaXRpYWxYID0gbnVsbDsKICAgICAgICB0aGlzLmluaXRpYWxZID0gbnVsbDsKICAgICAgICB0aGlzLnhPZmZzZXQgPSAwOwogICAgICAgIHRoaXMueU9mZnNldCA9IDA7CgogICAgICAgIGlmICh0aGlzLm9uY2xvc2UgJiYgdHlwZW9mIHRoaXMub25jbG9zZSA9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICB0aGlzLm9uY2xvc2UoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZHJhZ1N0YXJ0IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYWdTdGFydChlKSB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICBpZiAoIXRoaXMuem9vbWVkSW4pIHsKICAgICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoZS50eXBlID09PSAndG91Y2hzdGFydCcpIHsKICAgICAgICAgIHRoaXMuaW5pdGlhbFggPSBlLnRvdWNoZXNbMF0uY2xpZW50WCAtIHRoaXMueE9mZnNldDsKICAgICAgICAgIHRoaXMuaW5pdGlhbFkgPSBlLnRvdWNoZXNbMF0uY2xpZW50WSAtIHRoaXMueU9mZnNldDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5pbml0aWFsWCA9IGUuY2xpZW50WCAtIHRoaXMueE9mZnNldDsKICAgICAgICAgIHRoaXMuaW5pdGlhbFkgPSBlLmNsaWVudFkgLSB0aGlzLnlPZmZzZXQ7CiAgICAgICAgfQoKICAgICAgICBpZiAoZS50YXJnZXQgPT09IHRoaXMuaW1nKSB7CiAgICAgICAgICB0aGlzLmFjdGl2ZSA9IHRydWU7CiAgICAgICAgICB0aGlzLmltZy5jbGFzc0xpc3QuYWRkKCdkcmFnZ2luZycpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJkcmFnRW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYWdFbmQoZSkgewogICAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgdGhpcy5pbml0aWFsWCA9IHRoaXMuY3VycmVudFg7CiAgICAgICAgdGhpcy5pbml0aWFsWSA9IHRoaXMuY3VycmVudFk7CiAgICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMi5kcmFnZ2luZyA9IGZhbHNlOwogICAgICAgICAgX3RoaXMyLmltZy5pc0RyYWdnaW5nID0gZmFsc2U7CgogICAgICAgICAgX3RoaXMyLmltZy5jbGFzc0xpc3QucmVtb3ZlKCdkcmFnZ2luZycpOwogICAgICAgIH0sIDEwMCk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZHJhZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBkcmFnKGUpIHsKICAgICAgICBpZiAodGhpcy5hY3RpdmUpIHsKICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKCiAgICAgICAgICBpZiAoZS50eXBlID09PSAndG91Y2htb3ZlJykgewogICAgICAgICAgICB0aGlzLmN1cnJlbnRYID0gZS50b3VjaGVzWzBdLmNsaWVudFggLSB0aGlzLmluaXRpYWxYOwogICAgICAgICAgICB0aGlzLmN1cnJlbnRZID0gZS50b3VjaGVzWzBdLmNsaWVudFkgLSB0aGlzLmluaXRpYWxZOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5jdXJyZW50WCA9IGUuY2xpZW50WCAtIHRoaXMuaW5pdGlhbFg7CiAgICAgICAgICAgIHRoaXMuY3VycmVudFkgPSBlLmNsaWVudFkgLSB0aGlzLmluaXRpYWxZOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMueE9mZnNldCA9IHRoaXMuY3VycmVudFg7CiAgICAgICAgICB0aGlzLnlPZmZzZXQgPSB0aGlzLmN1cnJlbnRZOwogICAgICAgICAgdGhpcy5pbWcuaXNEcmFnZ2luZyA9IHRydWU7CiAgICAgICAgICB0aGlzLmRyYWdnaW5nID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuc2V0VHJhbnNsYXRlKHRoaXMuaW1nLCB0aGlzLmN1cnJlbnRYLCB0aGlzLmN1cnJlbnRZKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAib25Nb3ZlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uTW92ZShlKSB7CiAgICAgICAgaWYgKCF0aGlzLnpvb21lZEluKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgeE9mZnNldCA9IGUuY2xpZW50WCAtIHRoaXMuaW1nLm5hdHVyYWxXaWR0aCAvIDI7CiAgICAgICAgdmFyIHlPZmZzZXQgPSBlLmNsaWVudFkgLSB0aGlzLmltZy5uYXR1cmFsSGVpZ2h0IC8gMjsKICAgICAgICB0aGlzLnNldFRyYW5zbGF0ZSh0aGlzLmltZywgeE9mZnNldCwgeU9mZnNldCk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic2V0VHJhbnNsYXRlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFRyYW5zbGF0ZShub2RlLCB4UG9zLCB5UG9zKSB7CiAgICAgICAgbm9kZS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoJyArIHhQb3MgKyAncHgsICcgKyB5UG9zICsgJ3B4LCAwKSc7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAid2lkb3dXaWR0aCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiB3aWRvd1dpZHRoKCkgewogICAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJXaWR0aCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggfHwgZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aDsKICAgICAgfQogICAgfV0pOwoKICAgIHJldHVybiBab29tSW1hZ2VzOwogIH0oKTsKCiAgdmFyIERyYWdTbGlkZXMgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBEcmFnU2xpZGVzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGNvbmZpZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRHJhZ1NsaWRlcyk7CgogICAgICB2YXIgZHJhZ0VsID0gY29uZmlnLmRyYWdFbCwKICAgICAgICAgIF9jb25maWckdG9sZXJhbmNlWCA9IGNvbmZpZy50b2xlcmFuY2VYLAogICAgICAgICAgdG9sZXJhbmNlWCA9IF9jb25maWckdG9sZXJhbmNlWCA9PT0gdm9pZCAwID8gNDAgOiBfY29uZmlnJHRvbGVyYW5jZVgsCiAgICAgICAgICBfY29uZmlnJHRvbGVyYW5jZVkgPSBjb25maWcudG9sZXJhbmNlWSwKICAgICAgICAgIHRvbGVyYW5jZVkgPSBfY29uZmlnJHRvbGVyYW5jZVkgPT09IHZvaWQgMCA/IDY1IDogX2NvbmZpZyR0b2xlcmFuY2VZLAogICAgICAgICAgX2NvbmZpZyRzbGlkZSA9IGNvbmZpZy5zbGlkZSwKICAgICAgICAgIHNsaWRlID0gX2NvbmZpZyRzbGlkZSA9PT0gdm9pZCAwID8gbnVsbCA6IF9jb25maWckc2xpZGUsCiAgICAgICAgICBfY29uZmlnJGluc3RhbmNlID0gY29uZmlnLmluc3RhbmNlLAogICAgICAgICAgaW5zdGFuY2UgPSBfY29uZmlnJGluc3RhbmNlID09PSB2b2lkIDAgPyBudWxsIDogX2NvbmZpZyRpbnN0YW5jZTsKICAgICAgdGhpcy5lbCA9IGRyYWdFbDsKICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy5kcmFnZ2luZyA9IGZhbHNlOwogICAgICB0aGlzLmN1cnJlbnRYID0gbnVsbDsKICAgICAgdGhpcy5jdXJyZW50WSA9IG51bGw7CiAgICAgIHRoaXMuaW5pdGlhbFggPSBudWxsOwogICAgICB0aGlzLmluaXRpYWxZID0gbnVsbDsKICAgICAgdGhpcy54T2Zmc2V0ID0gMDsKICAgICAgdGhpcy55T2Zmc2V0ID0gMDsKICAgICAgdGhpcy5kaXJlY3Rpb24gPSBudWxsOwogICAgICB0aGlzLmxhc3REaXJlY3Rpb24gPSBudWxsOwogICAgICB0aGlzLnRvbGVyYW5jZVggPSB0b2xlcmFuY2VYOwogICAgICB0aGlzLnRvbGVyYW5jZVkgPSB0b2xlcmFuY2VZOwogICAgICB0aGlzLnRvbGVyYW5jZVJlYWNoZWQgPSBmYWxzZTsKICAgICAgdGhpcy5kcmFnQ29udGFpbmVyID0gdGhpcy5lbDsKICAgICAgdGhpcy5zbGlkZSA9IHNsaWRlOwogICAgICB0aGlzLmluc3RhbmNlID0gaW5zdGFuY2U7CiAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICByZXR1cm4gX3RoaXMuZHJhZ1N0YXJ0KGUpOwogICAgICB9LCBmYWxzZSk7CiAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLmRyYWdFbmQoZSk7CiAgICAgIH0sIGZhbHNlKTsKICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBfdGhpcy5kcmFnKGUpOwogICAgICB9LCBmYWxzZSk7CiAgICB9CgogICAgX2NyZWF0ZUNsYXNzKERyYWdTbGlkZXMsIFt7CiAgICAgIGtleTogImRyYWdTdGFydCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBkcmFnU3RhcnQoZSkgewogICAgICAgIGlmICh0aGlzLnNsaWRlLmNsYXNzTGlzdC5jb250YWlucygnem9vbWVkJykpIHsKICAgICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoZS50eXBlID09PSAndG91Y2hzdGFydCcpIHsKICAgICAgICAgIHRoaXMuaW5pdGlhbFggPSBlLnRvdWNoZXNbMF0uY2xpZW50WCAtIHRoaXMueE9mZnNldDsKICAgICAgICAgIHRoaXMuaW5pdGlhbFkgPSBlLnRvdWNoZXNbMF0uY2xpZW50WSAtIHRoaXMueU9mZnNldDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5pbml0aWFsWCA9IGUuY2xpZW50WCAtIHRoaXMueE9mZnNldDsKICAgICAgICAgIHRoaXMuaW5pdGlhbFkgPSBlLmNsaWVudFkgLSB0aGlzLnlPZmZzZXQ7CiAgICAgICAgfQoKICAgICAgICB2YXIgY2xpY2tlZCA9IGUudGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgdmFyIGV4bHVkZUNsaWNrcyA9IFsnaW5wdXQnLCAnc2VsZWN0JywgJ3RleHRhcmVhJywgJ2J1dHRvbicsICdhJ107CgogICAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ25vZHJhZycpIHx8IGNsb3Nlc3QoZS50YXJnZXQsICcubm9kcmFnJykgfHwgZXhsdWRlQ2xpY2tzLmluZGV4T2YoY2xpY2tlZCkgIT09IC0xKSB7CiAgICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICBpZiAoZS50YXJnZXQgPT09IHRoaXMuZWwgfHwgY2xpY2tlZCAhPT0gJ2ltZycgJiYgY2xvc2VzdChlLnRhcmdldCwgJy5nc2xpZGUtaW5saW5lJykpIHsKICAgICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuZWwuY2xhc3NMaXN0LmFkZCgnZHJhZ2dpbmcnKTsKICAgICAgICAgIHRoaXMuZHJhZ0NvbnRhaW5lciA9IGNsb3Nlc3QoZS50YXJnZXQsICcuZ2lubmVyLWNvbnRhaW5lcicpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJkcmFnRW5kIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYWdFbmQoZSkgewogICAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgICBlICYmIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICB0aGlzLmluaXRpYWxYID0gMDsKICAgICAgICB0aGlzLmluaXRpYWxZID0gMDsKICAgICAgICB0aGlzLmN1cnJlbnRYID0gbnVsbDsKICAgICAgICB0aGlzLmN1cnJlbnRZID0gbnVsbDsKICAgICAgICB0aGlzLmluaXRpYWxYID0gbnVsbDsKICAgICAgICB0aGlzLmluaXRpYWxZID0gbnVsbDsKICAgICAgICB0aGlzLnhPZmZzZXQgPSAwOwogICAgICAgIHRoaXMueU9mZnNldCA9IDA7CiAgICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTsKCiAgICAgICAgaWYgKHRoaXMuZG9TbGlkZUNoYW5nZSkgewogICAgICAgICAgdGhpcy5pbnN0YW5jZS5wcmV2ZW50T3V0c2lkZUNsaWNrID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuZG9TbGlkZUNoYW5nZSA9PSAncmlnaHQnICYmIHRoaXMuaW5zdGFuY2UucHJldlNsaWRlKCk7CiAgICAgICAgICB0aGlzLmRvU2xpZGVDaGFuZ2UgPT0gJ2xlZnQnICYmIHRoaXMuaW5zdGFuY2UubmV4dFNsaWRlKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5kb1NsaWRlQ2xvc2UpIHsKICAgICAgICAgIHRoaXMuaW5zdGFuY2UuY2xvc2UoKTsKICAgICAgICB9CgogICAgICAgIGlmICghdGhpcy50b2xlcmFuY2VSZWFjaGVkKSB7CiAgICAgICAgICB0aGlzLnNldFRyYW5zbGF0ZSh0aGlzLmRyYWdDb250YWluZXIsIDAsIDAsIHRydWUpOwogICAgICAgIH0KCiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczIuaW5zdGFuY2UucHJldmVudE91dHNpZGVDbGljayA9IGZhbHNlOwogICAgICAgICAgX3RoaXMyLnRvbGVyYW5jZVJlYWNoZWQgPSBmYWxzZTsKICAgICAgICAgIF90aGlzMi5sYXN0RGlyZWN0aW9uID0gbnVsbDsKICAgICAgICAgIF90aGlzMi5kcmFnZ2luZyA9IGZhbHNlOwogICAgICAgICAgX3RoaXMyLmVsLmlzRHJhZ2dpbmcgPSBmYWxzZTsKCiAgICAgICAgICBfdGhpczIuZWwuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZ2dpbmcnKTsKCiAgICAgICAgICBfdGhpczIuc2xpZGUuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZ2dpbmctbmF2Jyk7CgogICAgICAgICAgX3RoaXMyLmRyYWdDb250YWluZXIuc3R5bGUudHJhbnNmb3JtID0gJyc7CiAgICAgICAgICBfdGhpczIuZHJhZ0NvbnRhaW5lci5zdHlsZS50cmFuc2l0aW9uID0gJyc7CiAgICAgICAgfSwgMTAwKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJkcmFnIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRyYWcoZSkgewogICAgICAgIGlmICh0aGlzLmFjdGl2ZSkgewogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgdGhpcy5zbGlkZS5jbGFzc0xpc3QuYWRkKCdkcmFnZ2luZy1uYXYnKTsKCiAgICAgICAgICBpZiAoZS50eXBlID09PSAndG91Y2htb3ZlJykgewogICAgICAgICAgICB0aGlzLmN1cnJlbnRYID0gZS50b3VjaGVzWzBdLmNsaWVudFggLSB0aGlzLmluaXRpYWxYOwogICAgICAgICAgICB0aGlzLmN1cnJlbnRZID0gZS50b3VjaGVzWzBdLmNsaWVudFkgLSB0aGlzLmluaXRpYWxZOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5jdXJyZW50WCA9IGUuY2xpZW50WCAtIHRoaXMuaW5pdGlhbFg7CiAgICAgICAgICAgIHRoaXMuY3VycmVudFkgPSBlLmNsaWVudFkgLSB0aGlzLmluaXRpYWxZOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMueE9mZnNldCA9IHRoaXMuY3VycmVudFg7CiAgICAgICAgICB0aGlzLnlPZmZzZXQgPSB0aGlzLmN1cnJlbnRZOwogICAgICAgICAgdGhpcy5lbC5pc0RyYWdnaW5nID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuZHJhZ2dpbmcgPSB0cnVlOwogICAgICAgICAgdGhpcy5kb1NsaWRlQ2hhbmdlID0gZmFsc2U7CiAgICAgICAgICB0aGlzLmRvU2xpZGVDbG9zZSA9IGZhbHNlOwogICAgICAgICAgdmFyIGN1cnJlbnRYSW50ID0gTWF0aC5hYnModGhpcy5jdXJyZW50WCk7CiAgICAgICAgICB2YXIgY3VycmVudFlJbnQgPSBNYXRoLmFicyh0aGlzLmN1cnJlbnRZKTsKCiAgICAgICAgICBpZiAoY3VycmVudFhJbnQgPiAwICYmIGN1cnJlbnRYSW50ID49IE1hdGguYWJzKHRoaXMuY3VycmVudFkpICYmICghdGhpcy5sYXN0RGlyZWN0aW9uIHx8IHRoaXMubGFzdERpcmVjdGlvbiA9PSAneCcpKSB7CiAgICAgICAgICAgIHRoaXMueU9mZnNldCA9IDA7CiAgICAgICAgICAgIHRoaXMubGFzdERpcmVjdGlvbiA9ICd4JzsKICAgICAgICAgICAgdGhpcy5zZXRUcmFuc2xhdGUodGhpcy5kcmFnQ29udGFpbmVyLCB0aGlzLmN1cnJlbnRYLCAwKTsKICAgICAgICAgICAgdmFyIGRvQ2hhbmdlID0gdGhpcy5zaG91bGRDaGFuZ2UoKTsKCiAgICAgICAgICAgIGlmICghdGhpcy5pbnN0YW5jZS5zZXR0aW5ncy5kcmFnQXV0b1NuYXAgJiYgZG9DaGFuZ2UpIHsKICAgICAgICAgICAgICB0aGlzLmRvU2xpZGVDaGFuZ2UgPSBkb0NoYW5nZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHRoaXMuaW5zdGFuY2Uuc2V0dGluZ3MuZHJhZ0F1dG9TbmFwICYmIGRvQ2hhbmdlKSB7CiAgICAgICAgICAgICAgdGhpcy5pbnN0YW5jZS5wcmV2ZW50T3V0c2lkZUNsaWNrID0gdHJ1ZTsKICAgICAgICAgICAgICB0aGlzLnRvbGVyYW5jZVJlYWNoZWQgPSB0cnVlOwogICAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy5pbnN0YW5jZS5wcmV2ZW50T3V0c2lkZUNsaWNrID0gdHJ1ZTsKICAgICAgICAgICAgICB0aGlzLmRyYWdFbmQobnVsbCk7CiAgICAgICAgICAgICAgZG9DaGFuZ2UgPT0gJ3JpZ2h0JyAmJiB0aGlzLmluc3RhbmNlLnByZXZTbGlkZSgpOwogICAgICAgICAgICAgIGRvQ2hhbmdlID09ICdsZWZ0JyAmJiB0aGlzLmluc3RhbmNlLm5leHRTbGlkZSgpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLnRvbGVyYW5jZVkgPiAwICYmIGN1cnJlbnRZSW50ID4gMCAmJiBjdXJyZW50WUludCA+PSBjdXJyZW50WEludCAmJiAoIXRoaXMubGFzdERpcmVjdGlvbiB8fCB0aGlzLmxhc3REaXJlY3Rpb24gPT0gJ3knKSkgewogICAgICAgICAgICB0aGlzLnhPZmZzZXQgPSAwOwogICAgICAgICAgICB0aGlzLmxhc3REaXJlY3Rpb24gPSAneSc7CiAgICAgICAgICAgIHRoaXMuc2V0VHJhbnNsYXRlKHRoaXMuZHJhZ0NvbnRhaW5lciwgMCwgdGhpcy5jdXJyZW50WSk7CiAgICAgICAgICAgIHZhciBkb0Nsb3NlID0gdGhpcy5zaG91bGRDbG9zZSgpOwoKICAgICAgICAgICAgaWYgKCF0aGlzLmluc3RhbmNlLnNldHRpbmdzLmRyYWdBdXRvU25hcCAmJiBkb0Nsb3NlKSB7CiAgICAgICAgICAgICAgdGhpcy5kb1NsaWRlQ2xvc2UgPSB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodGhpcy5pbnN0YW5jZS5zZXR0aW5ncy5kcmFnQXV0b1NuYXAgJiYgZG9DbG9zZSkgewogICAgICAgICAgICAgIHRoaXMuaW5zdGFuY2UuY2xvc2UoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJzaG91bGRDaGFuZ2UiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gc2hvdWxkQ2hhbmdlKCkgewogICAgICAgIHZhciBkb0NoYW5nZSA9IGZhbHNlOwogICAgICAgIHZhciBjdXJyZW50WEludCA9IE1hdGguYWJzKHRoaXMuY3VycmVudFgpOwoKICAgICAgICBpZiAoY3VycmVudFhJbnQgPj0gdGhpcy50b2xlcmFuY2VYKSB7CiAgICAgICAgICB2YXIgZHJhZ0RpciA9IHRoaXMuY3VycmVudFggPiAwID8gJ3JpZ2h0JyA6ICdsZWZ0JzsKCiAgICAgICAgICBpZiAoZHJhZ0RpciA9PSAnbGVmdCcgJiYgdGhpcy5zbGlkZSAhPT0gdGhpcy5zbGlkZS5wYXJlbnROb2RlLmxhc3RDaGlsZCB8fCBkcmFnRGlyID09ICdyaWdodCcgJiYgdGhpcy5zbGlkZSAhPT0gdGhpcy5zbGlkZS5wYXJlbnROb2RlLmZpcnN0Q2hpbGQpIHsKICAgICAgICAgICAgZG9DaGFuZ2UgPSBkcmFnRGlyOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGRvQ2hhbmdlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInNob3VsZENsb3NlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNob3VsZENsb3NlKCkgewogICAgICAgIHZhciBkb0Nsb3NlID0gZmFsc2U7CiAgICAgICAgdmFyIGN1cnJlbnRZSW50ID0gTWF0aC5hYnModGhpcy5jdXJyZW50WSk7CgogICAgICAgIGlmIChjdXJyZW50WUludCA+PSB0aGlzLnRvbGVyYW5jZVkpIHsKICAgICAgICAgIGRvQ2xvc2UgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGRvQ2xvc2U7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic2V0VHJhbnNsYXRlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFRyYW5zbGF0ZShub2RlLCB4UG9zLCB5UG9zKSB7CiAgICAgICAgdmFyIGFuaW1hdGVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiBmYWxzZTsKCiAgICAgICAgaWYgKGFuaW1hdGVkKSB7CiAgICAgICAgICBub2RlLnN0eWxlLnRyYW5zaXRpb24gPSAnYWxsIC4ycyBlYXNlJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbm9kZS5zdHlsZS50cmFuc2l0aW9uID0gJyc7CiAgICAgICAgfQoKICAgICAgICBub2RlLnN0eWxlLnRyYW5zZm9ybSA9ICJ0cmFuc2xhdGUzZCgiLmNvbmNhdCh4UG9zLCAicHgsICIpLmNvbmNhdCh5UG9zLCAicHgsIDApIik7CiAgICAgIH0KICAgIH1dKTsKCiAgICByZXR1cm4gRHJhZ1NsaWRlczsKICB9KCk7CgogIGZ1bmN0aW9uIHNsaWRlSW1hZ2Uoc2xpZGUsIGRhdGEsIGluZGV4LCBjYWxsYmFjaykgewogICAgdmFyIHNsaWRlTWVkaWEgPSBzbGlkZS5xdWVyeVNlbGVjdG9yKCcuZ3NsaWRlLW1lZGlhJyk7CiAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7CiAgICB2YXIgdGl0bGVJRCA9ICdnU2xpZGVUaXRsZV8nICsgaW5kZXg7CiAgICB2YXIgdGV4dElEID0gJ2dTbGlkZURlc2NfJyArIGluZGV4OwogICAgaW1nLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChpc0Z1bmN0aW9uKGNhbGxiYWNrKSkgewogICAgICAgIGNhbGxiYWNrKCk7CiAgICAgIH0KICAgIH0sIGZhbHNlKTsKICAgIGltZy5zcmMgPSBkYXRhLmhyZWY7CiAgICBpbWcuYWx0ID0gJyc7CgogICAgaWYgKGRhdGEudGl0bGUgIT09ICcnKSB7CiAgICAgIGltZy5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScsIHRpdGxlSUQpOwogICAgfQoKICAgIGlmIChkYXRhLmRlc2NyaXB0aW9uICE9PSAnJykgewogICAgICBpbWcuc2V0QXR0cmlidXRlKCdhcmlhLWRlc2NyaWJlZGJ5JywgdGV4dElEKTsKICAgIH0KCiAgICBzbGlkZU1lZGlhLmluc2VydEJlZm9yZShpbWcsIHNsaWRlTWVkaWEuZmlyc3RDaGlsZCk7CiAgICByZXR1cm47CiAgfQoKICBmdW5jdGlvbiBzbGlkZVZpZGVvKHNsaWRlLCBkYXRhLCBpbmRleCwgY2FsbGJhY2spIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdmFyIHNsaWRlQ29udGFpbmVyID0gc2xpZGUucXVlcnlTZWxlY3RvcignLmdpbm5lci1jb250YWluZXInKTsKICAgIHZhciB2aWRlb0lEID0gJ2d2aWRlbycgKyBpbmRleDsKICAgIHZhciBzbGlkZU1lZGlhID0gc2xpZGUucXVlcnlTZWxlY3RvcignLmdzbGlkZS1tZWRpYScpOwogICAgdmFyIHZpZGVvUGxheWVycyA9IHRoaXMuZ2V0QWxsUGxheWVycygpOwogICAgYWRkQ2xhc3Moc2xpZGVDb250YWluZXIsICdndmlkZW8tY29udGFpbmVyJyk7CiAgICBzbGlkZU1lZGlhLmluc2VydEJlZm9yZShjcmVhdGVIVE1MKCc8ZGl2IGNsYXNzPSJndmlkZW8td3JhcHBlciI+PC9kaXY+JyksIHNsaWRlTWVkaWEuZmlyc3RDaGlsZCk7CiAgICB2YXIgdmlkZW9XcmFwcGVyID0gc2xpZGUucXVlcnlTZWxlY3RvcignLmd2aWRlby13cmFwcGVyJyk7CiAgICBpbmplY3RBc3NldHModGhpcy5zZXR0aW5ncy5wbHlyLmNzcywgJ1BseXInKTsKICAgIHZhciB1cmwgPSBkYXRhLmhyZWY7CiAgICB2YXIgcHJvdG9jb2wgPSBsb2NhdGlvbi5wcm90b2NvbC5yZXBsYWNlKCc6JywgJycpOwogICAgdmFyIHZpZGVvU291cmNlID0gJyc7CiAgICB2YXIgZW1iZWRJRCA9ICcnOwogICAgdmFyIGN1c3RvbVBsYWNlaG9sZGVyID0gZmFsc2U7CgogICAgaWYgKHByb3RvY29sID09ICdmaWxlJykgewogICAgICBwcm90b2NvbCA9ICdodHRwJzsKICAgIH0KCiAgICBzbGlkZU1lZGlhLnN0eWxlLm1heFdpZHRoID0gZGF0YS53aWR0aDsKICAgIGluamVjdEFzc2V0cyh0aGlzLnNldHRpbmdzLnBseXIuanMsICdQbHlyJywgZnVuY3Rpb24gKCkgewogICAgICBpZiAodXJsLm1hdGNoKC92aW1lb1wuY29tXC8oWzAtOV0qKS8pKSB7CiAgICAgICAgdmFyIHZpbWVvSUQgPSAvdmltZW8uKlwvKFxkKykvaS5leGVjKHVybCk7CiAgICAgICAgdmlkZW9Tb3VyY2UgPSAndmltZW8nOwogICAgICAgIGVtYmVkSUQgPSB2aW1lb0lEWzFdOwogICAgICB9CgogICAgICBpZiAodXJsLm1hdGNoKC8oeW91dHViZVwuY29tfHlvdXR1YmUtbm9jb29raWVcLmNvbSlcL3dhdGNoXD92PShbYS16QS1aMC05XC1fXSspLykgfHwgdXJsLm1hdGNoKC95b3V0dVwuYmVcLyhbYS16QS1aMC05XC1fXSspLykgfHwgdXJsLm1hdGNoKC8oeW91dHViZVwuY29tfHlvdXR1YmUtbm9jb29raWVcLmNvbSlcL2VtYmVkXC8oW2EtekEtWjAtOVwtX10rKS8pKSB7CiAgICAgICAgdmFyIHlvdXR1YmVJRCA9IGdldFlvdXR1YmVJRCh1cmwpOwogICAgICAgIHZpZGVvU291cmNlID0gJ3lvdXR1YmUnOwogICAgICAgIGVtYmVkSUQgPSB5b3V0dWJlSUQ7CiAgICAgIH0KCiAgICAgIGlmICh1cmwubWF0Y2goL1wuKG1wNHxvZ2d8d2VibXxtb3YpJC8pICE9PSBudWxsKSB7CiAgICAgICAgdmlkZW9Tb3VyY2UgPSAnbG9jYWwnOwogICAgICAgIHZhciBodG1sID0gJzx2aWRlbyBpZD0iJyArIHZpZGVvSUQgKyAnIiAnOwogICAgICAgIGh0bWwgKz0gInN0eWxlPVwiYmFja2dyb3VuZDojMDAwOyBtYXgtd2lkdGg6ICIuY29uY2F0KGRhdGEud2lkdGgsICI7XCIgIik7CiAgICAgICAgaHRtbCArPSAncHJlbG9hZD0ibWV0YWRhdGEiICc7CiAgICAgICAgaHRtbCArPSAneC13ZWJraXQtYWlycGxheT0iYWxsb3ciICc7CiAgICAgICAgaHRtbCArPSAnd2Via2l0LXBsYXlzaW5saW5lPSIiICc7CiAgICAgICAgaHRtbCArPSAnY29udHJvbHMgJzsKICAgICAgICBodG1sICs9ICdjbGFzcz0iZ3ZpZGVvLWxvY2FsIj4nOwogICAgICAgIHZhciBmb3JtYXQgPSB1cmwudG9Mb3dlckNhc2UoKS5zcGxpdCgnLicpLnBvcCgpOwogICAgICAgIHZhciBzb3VyY2VzID0gewogICAgICAgICAgbXA0OiAnJywKICAgICAgICAgIG9nZzogJycsCiAgICAgICAgICB3ZWJtOiAnJwogICAgICAgIH07CiAgICAgICAgZm9ybWF0ID0gZm9ybWF0ID09ICdtb3YnID8gJ21wNCcgOiBmb3JtYXQ7CiAgICAgICAgc291cmNlc1tmb3JtYXRdID0gdXJsOwoKICAgICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlcykgewogICAgICAgICAgaWYgKHNvdXJjZXMuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICAgICAgICB2YXIgdmlkZW9GaWxlID0gc291cmNlc1trZXldOwoKICAgICAgICAgICAgaWYgKGRhdGEuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICAgICAgICAgIHZpZGVvRmlsZSA9IGRhdGFba2V5XTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHZpZGVvRmlsZSAhPT0gJycpIHsKICAgICAgICAgICAgICBodG1sICs9ICI8c291cmNlIHNyYz1cIiIuY29uY2F0KHZpZGVvRmlsZSwgIlwiIHR5cGU9XCJ2aWRlby8iKS5jb25jYXQoa2V5LCAiXCI+Iik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGh0bWwgKz0gJzwvdmlkZW8+JzsKICAgICAgICBjdXN0b21QbGFjZWhvbGRlciA9IGNyZWF0ZUhUTUwoaHRtbCk7CiAgICAgIH0KCiAgICAgIHZhciBwbGFjZWhvbGRlciA9IGN1c3RvbVBsYWNlaG9sZGVyID8gY3VzdG9tUGxhY2Vob2xkZXIgOiBjcmVhdGVIVE1MKCI8ZGl2IGlkPVwiIi5jb25jYXQodmlkZW9JRCwgIlwiIGRhdGEtcGx5ci1wcm92aWRlcj1cIiIpLmNvbmNhdCh2aWRlb1NvdXJjZSwgIlwiIGRhdGEtcGx5ci1lbWJlZC1pZD1cIiIpLmNvbmNhdChlbWJlZElELCAiXCI+PC9kaXY+IikpOwogICAgICBhZGRDbGFzcyh2aWRlb1dyYXBwZXIsICIiLmNvbmNhdCh2aWRlb1NvdXJjZSwgIi12aWRlbyBndmlkZW8iKSk7CiAgICAgIHZpZGVvV3JhcHBlci5hcHBlbmRDaGlsZChwbGFjZWhvbGRlcik7CiAgICAgIHZpZGVvV3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnLCB2aWRlb0lEKTsKICAgICAgdmlkZW9XcmFwcGVyLnNldEF0dHJpYnV0ZSgnZGF0YS1pbmRleCcsIGluZGV4KTsKICAgICAgdmFyIHBsYXllckNvbmZpZyA9IGhhcyhfdGhpcy5zZXR0aW5ncy5wbHlyLCAnY29uZmlnJykgPyBfdGhpcy5zZXR0aW5ncy5wbHlyLmNvbmZpZyA6IHt9OwogICAgICB2YXIgcGxheWVyID0gbmV3IFBseXIoJyMnICsgdmlkZW9JRCwgcGxheWVyQ29uZmlnKTsKICAgICAgcGxheWVyLm9uKCdyZWFkeScsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIHZhciBpbnN0YW5jZSA9IGV2ZW50LmRldGFpbC5wbHlyOwogICAgICAgIHZpZGVvUGxheWVyc1t2aWRlb0lEXSA9IGluc3RhbmNlOwoKICAgICAgICBpZiAoaXNGdW5jdGlvbihjYWxsYmFjaykpIHsKICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcGxheWVyLm9uKCdlbnRlcmZ1bGxzY3JlZW4nLCBoYW5kbGVNZWRpYUZ1bGxTY3JlZW4pOwogICAgICBwbGF5ZXIub24oJ2V4aXRmdWxsc2NyZWVuJywgaGFuZGxlTWVkaWFGdWxsU2NyZWVuKTsKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gZ2V0WW91dHViZUlEKHVybCkgewogICAgdmFyIHZpZGVvSUQgPSAnJzsKICAgIHVybCA9IHVybC5yZXBsYWNlKC8oPnw8KS9naSwgJycpLnNwbGl0KC8odmlcL3x2PXxcL3ZcL3x5b3V0dVwuYmVcL3xcL2VtYmVkXC8pLyk7CgogICAgaWYgKHVybFsyXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHZpZGVvSUQgPSB1cmxbMl0uc3BsaXQoL1teMC05YS16X1wtXS9pKTsKICAgICAgdmlkZW9JRCA9IHZpZGVvSURbMF07CiAgICB9IGVsc2UgewogICAgICB2aWRlb0lEID0gdXJsOwogICAgfQoKICAgIHJldHVybiB2aWRlb0lEOwogIH0KCiAgZnVuY3Rpb24gaGFuZGxlTWVkaWFGdWxsU2NyZWVuKGV2ZW50KSB7CiAgICB2YXIgbWVkaWEgPSBjbG9zZXN0KGV2ZW50LnRhcmdldCwgJy5nc2xpZGUtbWVkaWEnKTsKCiAgICBpZiAoZXZlbnQudHlwZSA9PSAnZW50ZXJmdWxsc2NyZWVuJykgewogICAgICBhZGRDbGFzcyhtZWRpYSwgJ2Z1bGxzY3JlZW4nKTsKICAgIH0KCiAgICBpZiAoZXZlbnQudHlwZSA9PSAnZXhpdGZ1bGxzY3JlZW4nKSB7CiAgICAgIHJlbW92ZUNsYXNzKG1lZGlhLCAnZnVsbHNjcmVlbicpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gc2xpZGVJbmxpbmUoc2xpZGUsIGRhdGEsIGluZGV4LCBjYWxsYmFjaykgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICB2YXIgc2xpZGVNZWRpYSA9IHNsaWRlLnF1ZXJ5U2VsZWN0b3IoJy5nc2xpZGUtbWVkaWEnKTsKICAgIHZhciBoYXNoID0gaGFzKGRhdGEsICdocmVmJykgJiYgZGF0YS5ocmVmID8gZGF0YS5ocmVmLnNwbGl0KCcjJykucG9wKCkudHJpbSgpIDogZmFsc2U7CiAgICB2YXIgY29udGVudCA9IGhhcyhkYXRhLCAnY29udGVudCcpICYmIGRhdGEuY29udGVudCA/IGRhdGEuY29udGVudCA6IGZhbHNlOwogICAgdmFyIGlubmVyQ29udGVudDsKCiAgICBpZiAoY29udGVudCkgewogICAgICBpZiAoaXNTdHJpbmcoY29udGVudCkpIHsKICAgICAgICBpbm5lckNvbnRlbnQgPSBjcmVhdGVIVE1MKCI8ZGl2IGNsYXNzPVwiZ2lubGluZWQtY29udGVudFwiPiIuY29uY2F0KGNvbnRlbnQsICI8L2Rpdj4iKSk7CiAgICAgIH0KCiAgICAgIGlmIChpc05vZGUoY29udGVudCkpIHsKICAgICAgICBpZiAoY29udGVudC5zdHlsZS5kaXNwbGF5ID09ICdub25lJykgewogICAgICAgICAgY29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICB9CgogICAgICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBjb250YWluZXIuY2xhc3NOYW1lID0gJ2dpbmxpbmVkLWNvbnRlbnQnOwogICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjb250ZW50KTsKICAgICAgICBpbm5lckNvbnRlbnQgPSBjb250YWluZXI7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoaGFzaCkgewogICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaGFzaCk7CgogICAgICBpZiAoIWRpdikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgdmFyIGNsb25lZCA9IGRpdi5jbG9uZU5vZGUodHJ1ZSk7CiAgICAgIGNsb25lZC5zdHlsZS5oZWlnaHQgPSBkYXRhLmhlaWdodDsKICAgICAgY2xvbmVkLnN0eWxlLm1heFdpZHRoID0gZGF0YS53aWR0aDsKICAgICAgYWRkQ2xhc3MoY2xvbmVkLCAnZ2lubGluZWQtY29udGVudCcpOwogICAgICBpbm5lckNvbnRlbnQgPSBjbG9uZWQ7CiAgICB9CgogICAgaWYgKCFpbm5lckNvbnRlbnQpIHsKICAgICAgY29uc29sZS5lcnJvcignVW5hYmxlIHRvIGFwcGVuZCBpbmxpbmUgc2xpZGUgY29udGVudCcsIGRhdGEpOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgc2xpZGVNZWRpYS5zdHlsZS5oZWlnaHQgPSBkYXRhLmhlaWdodDsKICAgIHNsaWRlTWVkaWEuc3R5bGUud2lkdGggPSBkYXRhLndpZHRoOwogICAgc2xpZGVNZWRpYS5hcHBlbmRDaGlsZChpbm5lckNvbnRlbnQpOwogICAgdGhpcy5ldmVudHNbJ2lubGluZWNsb3NlJyArIGhhc2hdID0gYWRkRXZlbnQoJ2NsaWNrJywgewogICAgICBvbkVsZW1lbnQ6IHNsaWRlTWVkaWEucXVlcnlTZWxlY3RvckFsbCgnLmd0cmlnZ2VyLWNsb3NlJyksCiAgICAgIHdpdGhDYWxsYmFjazogZnVuY3Rpb24gd2l0aENhbGxiYWNrKGUpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgIF90aGlzLmNsb3NlKCk7CiAgICAgIH0KICAgIH0pOwoKICAgIGlmIChpc0Z1bmN0aW9uKGNhbGxiYWNrKSkgewogICAgICBjYWxsYmFjaygpOwogICAgfQoKICAgIHJldHVybjsKICB9CgogIGZ1bmN0aW9uIHNsaWRlSWZyYW1lKHNsaWRlLCBkYXRhLCBpbmRleCwgY2FsbGJhY2spIHsKICAgIHZhciBzbGlkZU1lZGlhID0gc2xpZGUucXVlcnlTZWxlY3RvcignLmdzbGlkZS1tZWRpYScpOwogICAgdmFyIGlmcmFtZSA9IGNyZWF0ZUlmcmFtZSh7CiAgICAgIHVybDogZGF0YS5ocmVmLAogICAgICBjYWxsYmFjazogY2FsbGJhY2sKICAgIH0pOwogICAgc2xpZGVNZWRpYS5wYXJlbnROb2RlLnN0eWxlLm1heFdpZHRoID0gZGF0YS53aWR0aDsKICAgIHNsaWRlTWVkaWEucGFyZW50Tm9kZS5zdHlsZS5oZWlnaHQgPSBkYXRhLmhlaWdodDsKICAgIHNsaWRlTWVkaWEuYXBwZW5kQ2hpbGQoaWZyYW1lKTsKICAgIHJldHVybjsKICB9CgogIHZhciBTbGlkZUNvbmZpZ1BhcnNlciA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIFNsaWRlQ29uZmlnUGFyc2VyKCkgewogICAgICB2YXIgc2xpZGVQYXJhbWFzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKCiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTbGlkZUNvbmZpZ1BhcnNlcik7CgogICAgICB0aGlzLmRlZmF1bHRzID0gewogICAgICAgIGhyZWY6ICcnLAogICAgICAgIHRpdGxlOiAnJywKICAgICAgICB0eXBlOiAnJywKICAgICAgICBkZXNjcmlwdGlvbjogJycsCiAgICAgICAgZGVzY1Bvc2l0aW9uOiAnYm90dG9tJywKICAgICAgICBlZmZlY3Q6ICcnLAogICAgICAgIHdpZHRoOiAnJywKICAgICAgICBoZWlnaHQ6ICcnLAogICAgICAgIGNvbnRlbnQ6IGZhbHNlLAogICAgICAgIHpvb21hYmxlOiB0cnVlLAogICAgICAgIGRyYWdnYWJsZTogdHJ1ZQogICAgICB9OwoKICAgICAgaWYgKGlzT2JqZWN0KHNsaWRlUGFyYW1hcykpIHsKICAgICAgICB0aGlzLmRlZmF1bHRzID0gZXh0ZW5kKHRoaXMuZGVmYXVsdHMsIHNsaWRlUGFyYW1hcyk7CiAgICAgIH0KICAgIH0KCiAgICBfY3JlYXRlQ2xhc3MoU2xpZGVDb25maWdQYXJzZXIsIFt7CiAgICAgIGtleTogInNvdXJjZVR5cGUiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gc291cmNlVHlwZSh1cmwpIHsKICAgICAgICB2YXIgb3JpZ2luID0gdXJsOwogICAgICAgIHVybCA9IHVybC50b0xvd2VyQ2FzZSgpOwoKICAgICAgICBpZiAodXJsLm1hdGNoKC9cLihqcGVnfGpwZ3xqcGV8Z2lmfHBuZ3xhcG58d2VicHxzdmcpJC8pICE9PSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gJ2ltYWdlJzsKICAgICAgICB9CgogICAgICAgIGlmICh1cmwubWF0Y2goLyh5b3V0dWJlXC5jb218eW91dHViZS1ub2Nvb2tpZVwuY29tKVwvd2F0Y2hcP3Y9KFthLXpBLVowLTlcLV9dKykvKSB8fCB1cmwubWF0Y2goL3lvdXR1XC5iZVwvKFthLXpBLVowLTlcLV9dKykvKSB8fCB1cmwubWF0Y2goLyh5b3V0dWJlXC5jb218eW91dHViZS1ub2Nvb2tpZVwuY29tKVwvZW1iZWRcLyhbYS16QS1aMC05XC1fXSspLykpIHsKICAgICAgICAgIHJldHVybiAndmlkZW8nOwogICAgICAgIH0KCiAgICAgICAgaWYgKHVybC5tYXRjaCgvdmltZW9cLmNvbVwvKFswLTldKikvKSkgewogICAgICAgICAgcmV0dXJuICd2aWRlbyc7CiAgICAgICAgfQoKICAgICAgICBpZiAodXJsLm1hdGNoKC9cLihtcDR8b2dnfHdlYm18bW92KSQvKSAhPT0gbnVsbCkgewogICAgICAgICAgcmV0dXJuICd2aWRlbyc7CiAgICAgICAgfQoKICAgICAgICBpZiAodXJsLm1hdGNoKC9cLihtcDN8d2F2fHdtYXxhYWN8b2dnKSQvKSAhPT0gbnVsbCkgewogICAgICAgICAgcmV0dXJuICdhdWRpbyc7CiAgICAgICAgfQoKICAgICAgICBpZiAodXJsLmluZGV4T2YoJyMnKSA+IC0xKSB7CiAgICAgICAgICB2YXIgaGFzaCA9IG9yaWdpbi5zcGxpdCgnIycpLnBvcCgpOwoKICAgICAgICAgIGlmIChoYXNoLnRyaW0oKSAhPT0gJycpIHsKICAgICAgICAgICAgcmV0dXJuICdpbmxpbmUnOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHVybC5pbmRleE9mKCdnb2FqYXg9dHJ1ZScpID4gLTEpIHsKICAgICAgICAgIHJldHVybiAnYWpheCc7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJ2V4dGVybmFsJzsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJwYXJzZUNvbmZpZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZUNvbmZpZyhlbGVtZW50LCBzZXR0aW5ncykgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAgIHZhciBkYXRhID0gZXh0ZW5kKHsKICAgICAgICAgIGRlc2NQb3NpdGlvbjogc2V0dGluZ3MuZGVzY1Bvc2l0aW9uCiAgICAgICAgfSwgdGhpcy5kZWZhdWx0cyk7CgogICAgICAgIGlmIChpc09iamVjdChlbGVtZW50KSAmJiAhaXNOb2RlKGVsZW1lbnQpKSB7CiAgICAgICAgICBpZiAoIWhhcyhlbGVtZW50LCAndHlwZScpKSB7CiAgICAgICAgICAgIGlmIChoYXMoZWxlbWVudCwgJ2NvbnRlbnQnKSAmJiBlbGVtZW50LmNvbnRlbnQpIHsKICAgICAgICAgICAgICBlbGVtZW50LnR5cGUgPSAnaW5saW5lJzsKICAgICAgICAgICAgfSBlbHNlIGlmIChoYXMoZWxlbWVudCwgJ2hyZWYnKSkgewogICAgICAgICAgICAgIGVsZW1lbnQudHlwZSA9IHRoaXMuc291cmNlVHlwZShlbGVtZW50LmhyZWYpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIG9iamVjdERhdGEgPSBleHRlbmQoZGF0YSwgZWxlbWVudCk7CiAgICAgICAgICB0aGlzLnNldFNpemUob2JqZWN0RGF0YSwgc2V0dGluZ3MpOwogICAgICAgICAgcmV0dXJuIG9iamVjdERhdGE7CiAgICAgICAgfQoKICAgICAgICB2YXIgdXJsID0gJyc7CiAgICAgICAgdmFyIGNvbmZpZyA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWdsaWdodGJveCcpOwogICAgICAgIHZhciBub2RlVHlwZSA9IGVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCiAgICAgICAgaWYgKG5vZGVUeXBlID09PSAnYScpIHsKICAgICAgICAgIHVybCA9IGVsZW1lbnQuaHJlZjsKICAgICAgICB9CgogICAgICAgIGlmIChub2RlVHlwZSA9PT0gJ2ltZycpIHsKICAgICAgICAgIHVybCA9IGVsZW1lbnQuc3JjOwogICAgICAgIH0KCiAgICAgICAgZGF0YS5ocmVmID0gdXJsOwogICAgICAgIGVhY2goZGF0YSwgZnVuY3Rpb24gKHZhbCwga2V5KSB7CiAgICAgICAgICBpZiAoaGFzKHNldHRpbmdzLCBrZXkpICYmIGtleSAhPT0gJ3dpZHRoJykgewogICAgICAgICAgICBkYXRhW2tleV0gPSBzZXR0aW5nc1trZXldOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBub2RlRGF0YSA9IGVsZW1lbnQuZGF0YXNldFtrZXldOwoKICAgICAgICAgIGlmICghaXNOaWwobm9kZURhdGEpKSB7CiAgICAgICAgICAgIGRhdGFba2V5XSA9IF90aGlzLnNhbml0aXplVmFsdWUobm9kZURhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBpZiAoZGF0YS5jb250ZW50KSB7CiAgICAgICAgICBkYXRhLnR5cGUgPSAnaW5saW5lJzsKICAgICAgICB9CgogICAgICAgIGlmICghZGF0YS50eXBlICYmIHVybCkgewogICAgICAgICAgZGF0YS50eXBlID0gdGhpcy5zb3VyY2VUeXBlKHVybCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWlzTmlsKGNvbmZpZykpIHsKICAgICAgICAgIHZhciBjbGVhbktleXMgPSBbXTsKICAgICAgICAgIGVhY2goZGF0YSwgZnVuY3Rpb24gKHYsIGspIHsKICAgICAgICAgICAgY2xlYW5LZXlzLnB1c2goJztcXHM/JyArIGspOwogICAgICAgICAgfSk7CiAgICAgICAgICBjbGVhbktleXMgPSBjbGVhbktleXMuam9pbignXFxzPzp8Jyk7CgogICAgICAgICAgaWYgKGNvbmZpZy50cmltKCkgIT09ICcnKSB7CiAgICAgICAgICAgIGVhY2goZGF0YSwgZnVuY3Rpb24gKHZhbCwga2V5KSB7CiAgICAgICAgICAgICAgdmFyIHN0ciA9IGNvbmZpZzsKICAgICAgICAgICAgICB2YXIgbWF0Y2ggPSAnXHM/JyArIGtleSArICdccz86XHM/KC4qPykoJyArIGNsZWFuS2V5cyArICdccz86fCQpJzsKICAgICAgICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKG1hdGNoKTsKICAgICAgICAgICAgICB2YXIgbWF0Y2hlcyA9IHN0ci5tYXRjaChyZWdleCk7CgogICAgICAgICAgICAgIGlmIChtYXRjaGVzICYmIG1hdGNoZXMubGVuZ3RoICYmIG1hdGNoZXNbMV0pIHsKICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IG1hdGNoZXNbMV0udHJpbSgpLnJlcGxhY2UoLztccyokLywgJycpOwogICAgICAgICAgICAgICAgZGF0YVtrZXldID0gX3RoaXMuc2FuaXRpemVWYWx1ZSh2YWx1ZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKCFkYXRhLnRpdGxlICYmIG5vZGVUeXBlID09ICdhJykgewogICAgICAgICAgICB2YXIgdGl0bGUgPSBlbGVtZW50LnRpdGxlOwoKICAgICAgICAgICAgaWYgKCFpc05pbCh0aXRsZSkgJiYgdGl0bGUgIT09ICcnKSB7CiAgICAgICAgICAgICAgZGF0YS50aXRsZSA9IHRpdGxlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFkYXRhLnRpdGxlICYmIG5vZGVUeXBlID09ICdpbWcnKSB7CiAgICAgICAgICAgIHZhciBhbHQgPSBlbGVtZW50LmFsdDsKCiAgICAgICAgICAgIGlmICghaXNOaWwoYWx0KSAmJiBhbHQgIT09ICcnKSB7CiAgICAgICAgICAgICAgZGF0YS50aXRsZSA9IGFsdDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGRhdGEuZGVzY3JpcHRpb24gJiYgZGF0YS5kZXNjcmlwdGlvbi5zdWJzdHJpbmcoMCwgMSkgPT0gJy4nICYmIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGF0YS5kZXNjcmlwdGlvbikpIHsKICAgICAgICAgIGRhdGEuZGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRhdGEuZGVzY3JpcHRpb24pLmlubmVySFRNTDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIG5vZGVEZXNjID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZ2xpZ2h0Ym94LWRlc2MnKTsKCiAgICAgICAgICBpZiAobm9kZURlc2MpIHsKICAgICAgICAgICAgZGF0YS5kZXNjcmlwdGlvbiA9IG5vZGVEZXNjLmlubmVySFRNTDsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMuc2V0U2l6ZShkYXRhLCBzZXR0aW5ncyk7CiAgICAgICAgdGhpcy5zbGlkZUNvbmZpZyA9IGRhdGE7CiAgICAgICAgcmV0dXJuIGRhdGE7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic2V0U2l6ZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTaXplKGRhdGEsIHNldHRpbmdzKSB7CiAgICAgICAgdmFyIGRlZmF1bHRXaXRoID0gZGF0YS50eXBlID09ICd2aWRlbycgPyB0aGlzLmNoZWNrU2l6ZShzZXR0aW5ncy52aWRlb3NXaWR0aCkgOiB0aGlzLmNoZWNrU2l6ZShzZXR0aW5ncy53aWR0aCk7CiAgICAgICAgdmFyIGRlZmF1bHRIZWlnaHQgPSB0aGlzLmNoZWNrU2l6ZShzZXR0aW5ncy5oZWlnaHQpOwogICAgICAgIGRhdGEud2lkdGggPSBoYXMoZGF0YSwgJ3dpZHRoJykgJiYgZGF0YS53aWR0aCAhPT0gJycgPyB0aGlzLmNoZWNrU2l6ZShkYXRhLndpZHRoKSA6IGRlZmF1bHRXaXRoOwogICAgICAgIGRhdGEuaGVpZ2h0ID0gaGFzKGRhdGEsICdoZWlnaHQnKSAmJiBkYXRhLmhlaWdodCAhPT0gJycgPyB0aGlzLmNoZWNrU2l6ZShkYXRhLmhlaWdodCkgOiBkZWZhdWx0SGVpZ2h0OwogICAgICAgIHJldHVybiBkYXRhOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNoZWNrU2l6ZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjaGVja1NpemUoc2l6ZSkgewogICAgICAgIHJldHVybiBpc051bWJlcihzaXplKSA/ICIiLmNvbmNhdChzaXplLCAicHgiKSA6IHNpemU7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic2FuaXRpemVWYWx1ZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzYW5pdGl6ZVZhbHVlKHZhbCkgewogICAgICAgIGlmICh2YWwgIT09ICd0cnVlJyAmJiB2YWwgIT09ICdmYWxzZScpIHsKICAgICAgICAgIHJldHVybiB2YWw7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdmFsID09PSAndHJ1ZSc7CiAgICAgIH0KICAgIH1dKTsKCiAgICByZXR1cm4gU2xpZGVDb25maWdQYXJzZXI7CiAgfSgpOwoKICB2YXIgU2xpZGUgPSBmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiBTbGlkZShlbCwgaW5zdGFuY2UsIGluZGV4KSB7CiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTbGlkZSk7CgogICAgICB0aGlzLmVsZW1lbnQgPSBlbDsKICAgICAgdGhpcy5pbnN0YW5jZSA9IGluc3RhbmNlOwogICAgICB0aGlzLmluZGV4ID0gaW5kZXg7CiAgICB9CgogICAgX2NyZWF0ZUNsYXNzKFNsaWRlLCBbewogICAgICBrZXk6ICJzZXRDb250ZW50IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldENvbnRlbnQoKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgICAgdmFyIHNsaWRlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsOwogICAgICAgIHZhciBjYWxsYmFjayA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CgogICAgICAgIGlmIChoYXNDbGFzcyhzbGlkZSwgJ2xvYWRlZCcpKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB2YXIgc2V0dGluZ3MgPSB0aGlzLmluc3RhbmNlLnNldHRpbmdzOwogICAgICAgIHZhciBzbGlkZUNvbmZpZyA9IHRoaXMuc2xpZGVDb25maWc7CiAgICAgICAgdmFyIGlzTW9iaWxlRGV2aWNlID0gaXNNb2JpbGUoKTsKCiAgICAgICAgaWYgKGlzRnVuY3Rpb24oc2V0dGluZ3MuYmVmb3JlU2xpZGVMb2FkKSkgewogICAgICAgICAgc2V0dGluZ3MuYmVmb3JlU2xpZGVMb2FkKHsKICAgICAgICAgICAgaW5kZXg6IHRoaXMuaW5kZXgsCiAgICAgICAgICAgIHNsaWRlOiBzbGlkZSwKICAgICAgICAgICAgcGxheWVyOiBmYWxzZQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB2YXIgdHlwZSA9IHNsaWRlQ29uZmlnLnR5cGU7CiAgICAgICAgdmFyIHBvc2l0aW9uID0gc2xpZGVDb25maWcuZGVzY1Bvc2l0aW9uOwogICAgICAgIHZhciBzbGlkZU1lZGlhID0gc2xpZGUucXVlcnlTZWxlY3RvcignLmdzbGlkZS1tZWRpYScpOwogICAgICAgIHZhciBzbGlkZVRpdGxlID0gc2xpZGUucXVlcnlTZWxlY3RvcignLmdzbGlkZS10aXRsZScpOwogICAgICAgIHZhciBzbGlkZVRleHQgPSBzbGlkZS5xdWVyeVNlbGVjdG9yKCcuZ3NsaWRlLWRlc2MnKTsKICAgICAgICB2YXIgc2xpZGVEZXNjID0gc2xpZGUucXVlcnlTZWxlY3RvcignLmdkZXNjLWlubmVyJyk7CiAgICAgICAgdmFyIGZpbmFsQ2FsbGJhY2sgPSBjYWxsYmFjazsKICAgICAgICB2YXIgdGl0bGVJRCA9ICdnU2xpZGVUaXRsZV8nICsgdGhpcy5pbmRleDsKICAgICAgICB2YXIgdGV4dElEID0gJ2dTbGlkZURlc2NfJyArIHRoaXMuaW5kZXg7CgogICAgICAgIGlmIChpc0Z1bmN0aW9uKHNldHRpbmdzLmFmdGVyU2xpZGVMb2FkKSkgewogICAgICAgICAgZmluYWxDYWxsYmFjayA9IGZ1bmN0aW9uIGZpbmFsQ2FsbGJhY2soKSB7CiAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGNhbGxiYWNrKSkgewogICAgICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNldHRpbmdzLmFmdGVyU2xpZGVMb2FkKHsKICAgICAgICAgICAgICBpbmRleDogX3RoaXMuaW5kZXgsCiAgICAgICAgICAgICAgc2xpZGU6IHNsaWRlLAogICAgICAgICAgICAgIHBsYXllcjogX3RoaXMuaW5zdGFuY2UuZ2V0U2xpZGVQbGF5ZXJJbnN0YW5jZShfdGhpcy5pbmRleCkKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgaWYgKHNsaWRlQ29uZmlnLnRpdGxlID09ICcnICYmIHNsaWRlQ29uZmlnLmRlc2NyaXB0aW9uID09ICcnKSB7CiAgICAgICAgICBpZiAoc2xpZGVEZXNjKSB7CiAgICAgICAgICAgIHNsaWRlRGVzYy5wYXJlbnROb2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2xpZGVEZXNjLnBhcmVudE5vZGUpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoc2xpZGVUaXRsZSAmJiBzbGlkZUNvbmZpZy50aXRsZSAhPT0gJycpIHsKICAgICAgICAgICAgc2xpZGVUaXRsZS5pZCA9IHRpdGxlSUQ7CiAgICAgICAgICAgIHNsaWRlVGl0bGUuaW5uZXJIVE1MID0gc2xpZGVDb25maWcudGl0bGU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzbGlkZVRpdGxlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2xpZGVUaXRsZSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHNsaWRlVGV4dCAmJiBzbGlkZUNvbmZpZy5kZXNjcmlwdGlvbiAhPT0gJycpIHsKICAgICAgICAgICAgc2xpZGVUZXh0LmlkID0gdGV4dElEOwoKICAgICAgICAgICAgaWYgKGlzTW9iaWxlRGV2aWNlICYmIHNldHRpbmdzLm1vcmVMZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgc2xpZGVDb25maWcuc21hbGxEZXNjcmlwdGlvbiA9IHRoaXMuc2xpZGVTaG9ydERlc2Moc2xpZGVDb25maWcuZGVzY3JpcHRpb24sIHNldHRpbmdzLm1vcmVMZW5ndGgsIHNldHRpbmdzLm1vcmVUZXh0KTsKICAgICAgICAgICAgICBzbGlkZVRleHQuaW5uZXJIVE1MID0gc2xpZGVDb25maWcuc21hbGxEZXNjcmlwdGlvbjsKICAgICAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9uRXZlbnRzKHNsaWRlVGV4dCwgc2xpZGVDb25maWcpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHNsaWRlVGV4dC5pbm5lckhUTUwgPSBzbGlkZUNvbmZpZy5kZXNjcmlwdGlvbjsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2xpZGVUZXh0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2xpZGVUZXh0KTsKICAgICAgICAgIH0KCiAgICAgICAgICBhZGRDbGFzcyhzbGlkZU1lZGlhLnBhcmVudE5vZGUsICJkZXNjLSIuY29uY2F0KHBvc2l0aW9uKSk7CiAgICAgICAgICBhZGRDbGFzcyhzbGlkZURlc2MucGFyZW50Tm9kZSwgImRlc2NyaXB0aW9uLSIuY29uY2F0KHBvc2l0aW9uKSk7CiAgICAgICAgfQoKICAgICAgICBhZGRDbGFzcyhzbGlkZU1lZGlhLCAiZ3NsaWRlLSIuY29uY2F0KHR5cGUpKTsKICAgICAgICBhZGRDbGFzcyhzbGlkZSwgJ2xvYWRlZCcpOwoKICAgICAgICBpZiAodHlwZSA9PT0gJ3ZpZGVvJykgewogICAgICAgICAgc2xpZGVWaWRlby5hcHBseSh0aGlzLmluc3RhbmNlLCBbc2xpZGUsIHNsaWRlQ29uZmlnLCB0aGlzLmluZGV4LCBmaW5hbENhbGxiYWNrXSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZSA9PT0gJ2V4dGVybmFsJykgewogICAgICAgICAgc2xpZGVJZnJhbWUuYXBwbHkodGhpcywgW3NsaWRlLCBzbGlkZUNvbmZpZywgdGhpcy5pbmRleCwgZmluYWxDYWxsYmFja10pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKHR5cGUgPT09ICdpbmxpbmUnKSB7CiAgICAgICAgICBzbGlkZUlubGluZS5hcHBseSh0aGlzLmluc3RhbmNlLCBbc2xpZGUsIHNsaWRlQ29uZmlnLCB0aGlzLmluZGV4LCBmaW5hbENhbGxiYWNrXSk7CgogICAgICAgICAgaWYgKHNldHRpbmdzLmRyYWdnYWJsZSkgewogICAgICAgICAgICBuZXcgRHJhZ1NsaWRlcyh7CiAgICAgICAgICAgICAgZHJhZ0VsOiBzbGlkZS5xdWVyeVNlbGVjdG9yKCcuZ3NsaWRlLWlubGluZScpLAogICAgICAgICAgICAgIHRvbGVyYW5jZVg6IHNldHRpbmdzLmRyYWdUb2xlcmFuY2VYLAogICAgICAgICAgICAgIHRvbGVyYW5jZVk6IHNldHRpbmdzLmRyYWdUb2xlcmFuY2VZLAogICAgICAgICAgICAgIHNsaWRlOiBzbGlkZSwKICAgICAgICAgICAgICBpbnN0YW5jZTogdGhpcy5pbnN0YW5jZQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZSA9PT0gJ2ltYWdlJykgewogICAgICAgICAgc2xpZGVJbWFnZShzbGlkZSwgc2xpZGVDb25maWcsIHRoaXMuaW5kZXgsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIGltZyA9IHNsaWRlLnF1ZXJ5U2VsZWN0b3IoJ2ltZycpOwoKICAgICAgICAgICAgaWYgKHNldHRpbmdzLmRyYWdnYWJsZSkgewogICAgICAgICAgICAgIG5ldyBEcmFnU2xpZGVzKHsKICAgICAgICAgICAgICAgIGRyYWdFbDogaW1nLAogICAgICAgICAgICAgICAgdG9sZXJhbmNlWDogc2V0dGluZ3MuZHJhZ1RvbGVyYW5jZVgsCiAgICAgICAgICAgICAgICB0b2xlcmFuY2VZOiBzZXR0aW5ncy5kcmFnVG9sZXJhbmNlWSwKICAgICAgICAgICAgICAgIHNsaWRlOiBzbGlkZSwKICAgICAgICAgICAgICAgIGluc3RhbmNlOiBfdGhpcy5pbnN0YW5jZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoc2xpZGVDb25maWcuem9vbWFibGUgJiYgaW1nLm5hdHVyYWxXaWR0aCA+IGltZy5vZmZzZXRXaWR0aCkgewogICAgICAgICAgICAgIGFkZENsYXNzKGltZywgJ3pvb21hYmxlJyk7CiAgICAgICAgICAgICAgbmV3IFpvb21JbWFnZXMoaW1nLCBzbGlkZSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgX3RoaXMuaW5zdGFuY2UucmVzaXplKCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKGZpbmFsQ2FsbGJhY2spKSB7CiAgICAgICAgICAgICAgZmluYWxDYWxsYmFjaygpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChpc0Z1bmN0aW9uKGZpbmFsQ2FsbGJhY2spKSB7CiAgICAgICAgICBmaW5hbENhbGxiYWNrKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInNsaWRlU2hvcnREZXNjIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNsaWRlU2hvcnREZXNjKHN0cmluZykgewogICAgICAgIHZhciBuID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiA1MDsKICAgICAgICB2YXIgd29yZEJvdW5kYXJ5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiBmYWxzZTsKICAgICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgZGl2LmlubmVySFRNTCA9IHN0cmluZzsKICAgICAgICB2YXIgY2xlYW5lZFN0cmluZyA9IGRpdi5pbm5lclRleHQ7CiAgICAgICAgdmFyIHVzZVdvcmRCb3VuZGFyeSA9IHdvcmRCb3VuZGFyeTsKICAgICAgICBzdHJpbmcgPSBjbGVhbmVkU3RyaW5nLnRyaW0oKTsKCiAgICAgICAgaWYgKHN0cmluZy5sZW5ndGggPD0gbikgewogICAgICAgICAgcmV0dXJuIHN0cmluZzsKICAgICAgICB9CgogICAgICAgIHZhciBzdWJTdHJpbmcgPSBzdHJpbmcuc3Vic3RyKDAsIG4gLSAxKTsKCiAgICAgICAgaWYgKCF1c2VXb3JkQm91bmRhcnkpIHsKICAgICAgICAgIHJldHVybiBzdWJTdHJpbmc7CiAgICAgICAgfQoKICAgICAgICBkaXYgPSBudWxsOwogICAgICAgIHJldHVybiBzdWJTdHJpbmcgKyAnLi4uIDxhIGhyZWY9IiMiIGNsYXNzPSJkZXNjLW1vcmUiPicgKyB3b3JkQm91bmRhcnkgKyAnPC9hPic7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZGVzY3JpcHRpb25FdmVudHMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzY3JpcHRpb25FdmVudHMoZGVzYywgZGF0YSkgewogICAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgICB2YXIgbW9yZUxpbmsgPSBkZXNjLnF1ZXJ5U2VsZWN0b3IoJy5kZXNjLW1vcmUnKTsKCiAgICAgICAgaWYgKCFtb3JlTGluaykgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgYWRkRXZlbnQoJ2NsaWNrJywgewogICAgICAgICAgb25FbGVtZW50OiBtb3JlTGluaywKICAgICAgICAgIHdpdGhDYWxsYmFjazogZnVuY3Rpb24gd2l0aENhbGxiYWNrKGV2ZW50LCB0YXJnZXQpIHsKICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgdmFyIGJvZHkgPSBkb2N1bWVudC5ib2R5OwogICAgICAgICAgICB2YXIgZGVzYyA9IGNsb3Nlc3QodGFyZ2V0LCAnLmdzbGlkZS1kZXNjJyk7CgogICAgICAgICAgICBpZiAoIWRlc2MpIHsKICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGRlc2MuaW5uZXJIVE1MID0gZGF0YS5kZXNjcmlwdGlvbjsKICAgICAgICAgICAgYWRkQ2xhc3MoYm9keSwgJ2dkZXNjLW9wZW4nKTsKICAgICAgICAgICAgdmFyIHNob3J0RXZlbnQgPSBhZGRFdmVudCgnY2xpY2snLCB7CiAgICAgICAgICAgICAgb25FbGVtZW50OiBbYm9keSwgY2xvc2VzdChkZXNjLCAnLmdzbGlkZS1kZXNjcmlwdGlvbicpXSwKICAgICAgICAgICAgICB3aXRoQ2FsbGJhY2s6IGZ1bmN0aW9uIHdpdGhDYWxsYmFjayhldmVudCwgdGFyZ2V0KSB7CiAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICdhJykgewogICAgICAgICAgICAgICAgICByZW1vdmVDbGFzcyhib2R5LCAnZ2Rlc2Mtb3BlbicpOwogICAgICAgICAgICAgICAgICBhZGRDbGFzcyhib2R5LCAnZ2Rlc2MtY2xvc2VkJyk7CiAgICAgICAgICAgICAgICAgIGRlc2MuaW5uZXJIVE1MID0gZGF0YS5zbWFsbERlc2NyaXB0aW9uOwoKICAgICAgICAgICAgICAgICAgX3RoaXMyLmRlc2NyaXB0aW9uRXZlbnRzKGRlc2MsIGRhdGEpOwoKICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MoYm9keSwgJ2dkZXNjLWNsb3NlZCcpOwogICAgICAgICAgICAgICAgICB9LCA0MDApOwogICAgICAgICAgICAgICAgICBzaG9ydEV2ZW50LmRlc3Ryb3koKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNyZWF0ZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGUoKSB7CiAgICAgICAgcmV0dXJuIGNyZWF0ZUhUTUwodGhpcy5pbnN0YW5jZS5zZXR0aW5ncy5zbGlkZUhUTUwpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdldENvbmZpZyIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDb25maWcoKSB7CiAgICAgICAgdmFyIHBhcnNlciA9IG5ldyBTbGlkZUNvbmZpZ1BhcnNlcih0aGlzLmluc3RhbmNlLnNldHRpbmdzLnNsaWRlRXh0cmFBdHRyaWJ1dGVzKTsKICAgICAgICB0aGlzLnNsaWRlQ29uZmlnID0gcGFyc2VyLnBhcnNlQ29uZmlnKHRoaXMuZWxlbWVudCwgdGhpcy5pbnN0YW5jZS5zZXR0aW5ncyk7CiAgICAgICAgcmV0dXJuIHRoaXMuc2xpZGVDb25maWc7CiAgICAgIH0KICAgIH1dKTsKCiAgICByZXR1cm4gU2xpZGU7CiAgfSgpOwoKICB2YXIgX3ZlcnNpb24gPSAnMy4wLjcnOwogIHZhciBpc01vYmlsZSQxID0gaXNNb2JpbGUoKTsKICB2YXIgaXNUb3VjaCQxID0gaXNUb3VjaCgpOwogIHZhciBodG1sID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2h0bWwnKVswXTsKICB2YXIgZGVmYXVsdHMgPSB7CiAgICBzZWxlY3RvcjogJy5nbGlnaHRib3gnLAogICAgZWxlbWVudHM6IG51bGwsCiAgICBza2luOiAnY2xlYW4nLAogICAgdGhlbWU6ICdjbGVhbicsCiAgICBjbG9zZUJ1dHRvbjogdHJ1ZSwKICAgIHN0YXJ0QXQ6IG51bGwsCiAgICBhdXRvcGxheVZpZGVvczogdHJ1ZSwKICAgIGF1dG9mb2N1c1ZpZGVvczogdHJ1ZSwKICAgIGRlc2NQb3NpdGlvbjogJ2JvdHRvbScsCiAgICB3aWR0aDogJzkwMHB4JywKICAgIGhlaWdodDogJzUwNnB4JywKICAgIHZpZGVvc1dpZHRoOiAnOTYwcHgnLAogICAgYmVmb3JlU2xpZGVDaGFuZ2U6IG51bGwsCiAgICBhZnRlclNsaWRlQ2hhbmdlOiBudWxsLAogICAgYmVmb3JlU2xpZGVMb2FkOiBudWxsLAogICAgYWZ0ZXJTbGlkZUxvYWQ6IG51bGwsCiAgICBzbGlkZUluc2VydGVkOiBudWxsLAogICAgc2xpZGVSZW1vdmVkOiBudWxsLAogICAgc2xpZGVFeHRyYUF0dHJpYnV0ZXM6IG51bGwsCiAgICBvbk9wZW46IG51bGwsCiAgICBvbkNsb3NlOiBudWxsLAogICAgbG9vcDogZmFsc2UsCiAgICB6b29tYWJsZTogdHJ1ZSwKICAgIGRyYWdnYWJsZTogdHJ1ZSwKICAgIGRyYWdBdXRvU25hcDogZmFsc2UsCiAgICBkcmFnVG9sZXJhbmNlWDogNDAsCiAgICBkcmFnVG9sZXJhbmNlWTogNjUsCiAgICBwcmVsb2FkOiB0cnVlLAogICAgb25lU2xpZGVQZXJPcGVuOiBmYWxzZSwKICAgIHRvdWNoTmF2aWdhdGlvbjogdHJ1ZSwKICAgIHRvdWNoRm9sbG93QXhpczogdHJ1ZSwKICAgIGtleWJvYXJkTmF2aWdhdGlvbjogdHJ1ZSwKICAgIGNsb3NlT25PdXRzaWRlQ2xpY2s6IHRydWUsCiAgICBwbHVnaW5zOiBmYWxzZSwKICAgIHBseXI6IHsKICAgICAgY3NzOiAnaHR0cHM6Ly9jZG4ucGx5ci5pby8zLjYuMy9wbHlyLmNzcycsCiAgICAgIGpzOiAnaHR0cHM6Ly9jZG4ucGx5ci5pby8zLjYuMy9wbHlyLmpzJywKICAgICAgY29uZmlnOiB7CiAgICAgICAgcmF0aW86ICcxNjo5JywKICAgICAgICBmdWxsc2NyZWVuOiB7CiAgICAgICAgICBlbmFibGVkOiB0cnVlLAogICAgICAgICAgaW9zTmF0aXZlOiB0cnVlCiAgICAgICAgfSwKICAgICAgICB5b3V0dWJlOiB7CiAgICAgICAgICBub0Nvb2tpZTogdHJ1ZSwKICAgICAgICAgIHJlbDogMCwKICAgICAgICAgIHNob3dpbmZvOiAwLAogICAgICAgICAgaXZfbG9hZF9wb2xpY3k6IDMKICAgICAgICB9LAogICAgICAgIHZpbWVvOiB7CiAgICAgICAgICBieWxpbmU6IGZhbHNlLAogICAgICAgICAgcG9ydHJhaXQ6IGZhbHNlLAogICAgICAgICAgdGl0bGU6IGZhbHNlLAogICAgICAgICAgdHJhbnNwYXJlbnQ6IGZhbHNlCiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgb3BlbkVmZmVjdDogJ3pvb20nLAogICAgY2xvc2VFZmZlY3Q6ICd6b29tJywKICAgIHNsaWRlRWZmZWN0OiAnc2xpZGUnLAogICAgbW9yZVRleHQ6ICdTZWUgbW9yZScsCiAgICBtb3JlTGVuZ3RoOiA2MCwKICAgIGNzc0VmZWN0czogewogICAgICBmYWRlOiB7CiAgICAgICAgImluIjogJ2ZhZGVJbicsCiAgICAgICAgb3V0OiAnZmFkZU91dCcKICAgICAgfSwKICAgICAgem9vbTogewogICAgICAgICJpbiI6ICd6b29tSW4nLAogICAgICAgIG91dDogJ3pvb21PdXQnCiAgICAgIH0sCiAgICAgIHNsaWRlOiB7CiAgICAgICAgImluIjogJ3NsaWRlSW5SaWdodCcsCiAgICAgICAgb3V0OiAnc2xpZGVPdXRMZWZ0JwogICAgICB9LAogICAgICBzbGlkZUJhY2s6IHsKICAgICAgICAiaW4iOiAnc2xpZGVJbkxlZnQnLAogICAgICAgIG91dDogJ3NsaWRlT3V0UmlnaHQnCiAgICAgIH0sCiAgICAgIG5vbmU6IHsKICAgICAgICAiaW4iOiAnbm9uZScsCiAgICAgICAgb3V0OiAnbm9uZScKICAgICAgfQogICAgfSwKICAgIHN2ZzogewogICAgICBjbG9zZTogJzxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB4bWw6c3BhY2U9InByZXNlcnZlIj48Zz48Zz48cGF0aCBkPSJNNTA1Ljk0Myw2LjA1OGMtOC4wNzctOC4wNzctMjEuMTcyLTguMDc3LTI5LjI0OSwwTDYuMDU4LDQ3Ni42OTNjLTguMDc3LDguMDc3LTguMDc3LDIxLjE3MiwwLDI5LjI0OUMxMC4wOTYsNTA5Ljk4MiwxNS4zOSw1MTIsMjAuNjgzLDUxMmM1LjI5MywwLDEwLjU4Ni0yLjAxOSwxNC42MjUtNi4wNTlMNTA1Ljk0MywzNS4zMDZDNTE0LjAxOSwyNy4yMyw1MTQuMDE5LDE0LjEzNSw1MDUuOTQzLDYuMDU4eiIvPjwvZz48L2c+PGc+PGc+PHBhdGggZD0iTTUwNS45NDIsNDc2LjY5NEwzNS4zMDYsNi4wNTljLTguMDc2LTguMDc3LTIxLjE3Mi04LjA3Ny0yOS4yNDgsMGMtOC4wNzcsOC4wNzYtOC4wNzcsMjEuMTcxLDAsMjkuMjQ4bDQ3MC42MzYsNDcwLjYzNmM0LjAzOCw0LjAzOSw5LjMzMiw2LjA1OCwxNC42MjUsNi4wNThjNS4yOTMsMCwxMC41ODctMi4wMTksMTQuNjI0LTYuMDU3QzUxNC4wMTgsNDk3Ljg2Niw1MTQuMDE4LDQ4NC43NzEsNTA1Ljk0Miw0NzYuNjk0eiIvPjwvZz48L2c+PC9zdmc+JywKICAgICAgbmV4dDogJzxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDQ3Ny4xNzUgNDc3LjE3NSIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+IDxnPjxwYXRoIGQ9Ik0zNjAuNzMxLDIyOS4wNzVsLTIyNS4xLTIyNS4xYy01LjMtNS4zLTEzLjgtNS4zLTE5LjEsMHMtNS4zLDEzLjgsMCwxOS4xbDIxNS41LDIxNS41bC0yMTUuNSwyMTUuNWMtNS4zLDUuMy01LjMsMTMuOCwwLDE5LjFjMi42LDIuNiw2LjEsNCw5LjUsNGMzLjQsMCw2LjktMS4zLDkuNS00bDIyNS4xLTIyNS4xQzM2NS45MzEsMjQyLjg3NSwzNjUuOTMxLDIzNC4yNzUsMzYwLjczMSwyMjkuMDc1eiIvPjwvZz48L3N2Zz4nLAogICAgICBwcmV2OiAnPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgNDc3LjE3NSA0NzcuMTc1IiB4bWw6c3BhY2U9InByZXNlcnZlIj48Zz48cGF0aCBkPSJNMTQ1LjE4OCwyMzguNTc1bDIxNS41LTIxNS41YzUuMy01LjMsNS4zLTEzLjgsMC0xOS4xcy0xMy44LTUuMy0xOS4xLDBsLTIyNS4xLDIyNS4xYy01LjMsNS4zLTUuMywxMy44LDAsMTkuMWwyMjUuMSwyMjVjMi42LDIuNiw2LjEsNCw5LjUsNHM2LjktMS4zLDkuNS00YzUuMy01LjMsNS4zLTEzLjgsMC0xOS4xTDE0NS4xODgsMjM4LjU3NXoiLz48L2c+PC9zdmc+JwogICAgfQogIH07CiAgZGVmYXVsdHMuc2xpZGVIVE1MID0gIjxkaXYgY2xhc3M9XCJnc2xpZGVcIj5cbiAgICA8ZGl2IGNsYXNzPVwiZ3NsaWRlLWlubmVyLWNvbnRlbnRcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImdpbm5lci1jb250YWluZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJnc2xpZGUtbWVkaWFcIj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImdzbGlkZS1kZXNjcmlwdGlvblwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJnZGVzYy1pbm5lclwiPlxuICAgICAgICAgICAgICAgICAgICA8aDQgY2xhc3M9XCJnc2xpZGUtdGl0bGVcIj48L2g0PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZ3NsaWRlLWRlc2NcIj48L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbjwvZGl2PiI7CiAgZGVmYXVsdHMubGlnaHRib3hIVE1MID0gIjxkaXYgaWQ9XCJnbGlnaHRib3gtYm9keVwiIGNsYXNzPVwiZ2xpZ2h0Ym94LWNvbnRhaW5lclwiPlxuICAgIDxkaXYgY2xhc3M9XCJnbG9hZGVyIHZpc2libGVcIj48L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwiZ292ZXJsYXlcIj48L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwiZ2NvbnRhaW5lclwiPlxuICAgIDxkaXYgaWQ9XCJnbGlnaHRib3gtc2xpZGVyXCIgY2xhc3M9XCJnc2xpZGVyXCI+PC9kaXY+XG4gICAgPGJ1dHRvbiBjbGFzcz1cImduZXh0IGdidG5cIiB0YWJpbmRleD1cIjBcIiBhcmlhLWxhYmVsPVwiTmV4dFwiPntuZXh0U1ZHfTwvYnV0dG9uPlxuICAgIDxidXR0b24gY2xhc3M9XCJncHJldiBnYnRuXCIgdGFiaW5kZXg9XCIxXCIgYXJpYS1sYWJlbD1cIlByZXZpb3VzXCI+e3ByZXZTVkd9PC9idXR0b24+XG4gICAgPGJ1dHRvbiBjbGFzcz1cImdjbG9zZSBnYnRuXCIgdGFiaW5kZXg9XCIyXCIgYXJpYS1sYWJlbD1cIkNsb3NlXCI+e2Nsb3NlU1ZHfTwvYnV0dG9uPlxuPC9kaXY+XG48L2Rpdj4iOwoKICB2YXIgR2xpZ2h0Ym94SW5pdCA9IGZ1bmN0aW9uICgpIHsKICAgIGZ1bmN0aW9uIEdsaWdodGJveEluaXQoKSB7CiAgICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKCiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBHbGlnaHRib3hJbml0KTsKCiAgICAgIHRoaXMuc2V0dGluZ3MgPSBleHRlbmQoZGVmYXVsdHMsIG9wdGlvbnMpOwogICAgICB0aGlzLmVmZmVjdHNDbGFzc2VzID0gdGhpcy5nZXRBbmltYXRpb25DbGFzc2VzKCk7CiAgICAgIHRoaXMudmlkZW9QbGF5ZXJzID0ge307CiAgICAgIHRoaXMuYXBpRXZlbnRzID0gW107CiAgICAgIHRoaXMuZnVsbEVsZW1lbnRzTGlzdCA9IGZhbHNlOwogICAgfQoKICAgIF9jcmVhdGVDbGFzcyhHbGlnaHRib3hJbml0LCBbewogICAgICBrZXk6ICJpbml0IiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgICAgdmFyIHNlbGVjdG9yID0gdGhpcy5nZXRTZWxlY3RvcigpOwoKICAgICAgICBpZiAoc2VsZWN0b3IpIHsKICAgICAgICAgIHRoaXMuYmFzZUV2ZW50cyA9IGFkZEV2ZW50KCdjbGljaycsIHsKICAgICAgICAgICAgb25FbGVtZW50OiBzZWxlY3RvciwKICAgICAgICAgICAgd2l0aENhbGxiYWNrOiBmdW5jdGlvbiB3aXRoQ2FsbGJhY2soZSwgdGFyZ2V0KSB7CiAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICAgICAgICBfdGhpcy5vcGVuKHRhcmdldCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5lbGVtZW50cyA9IHRoaXMuZ2V0RWxlbWVudHMoKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJvcGVuIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW4oKSB7CiAgICAgICAgdmFyIGVsZW1lbnQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IG51bGw7CiAgICAgICAgdmFyIHN0YXJ0QXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IG51bGw7CgogICAgICAgIGlmICh0aGlzLmVsZW1lbnRzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmFjdGl2ZVNsaWRlID0gbnVsbDsKICAgICAgICB0aGlzLnByZXZBY3RpdmVTbGlkZUluZGV4ID0gbnVsbDsKICAgICAgICB0aGlzLnByZXZBY3RpdmVTbGlkZSA9IG51bGw7CiAgICAgICAgdmFyIGluZGV4ID0gaXNOdW1iZXIoc3RhcnRBdCkgPyBzdGFydEF0IDogdGhpcy5zZXR0aW5ncy5zdGFydEF0OwoKICAgICAgICBpZiAoaXNOb2RlKGVsZW1lbnQpKSB7CiAgICAgICAgICB2YXIgZ2FsbGVyeSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWdhbGxlcnknKTsKCiAgICAgICAgICBpZiAoZ2FsbGVyeSkgewogICAgICAgICAgICB0aGlzLmZ1bGxFbGVtZW50c0xpc3QgPSB0aGlzLmVsZW1lbnRzOwogICAgICAgICAgICB0aGlzLmVsZW1lbnRzID0gdGhpcy5nZXRHYWxsZXJ5RWxlbWVudHModGhpcy5lbGVtZW50cywgZ2FsbGVyeSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGlzTmlsKGluZGV4KSkgewogICAgICAgICAgICBpbmRleCA9IHRoaXMuZ2V0RWxlbWVudEluZGV4KGVsZW1lbnQpOwoKICAgICAgICAgICAgaWYgKGluZGV4IDwgMCkgewogICAgICAgICAgICAgIGluZGV4ID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCFpc051bWJlcihpbmRleCkpIHsKICAgICAgICAgIGluZGV4ID0gMDsKICAgICAgICB9CgogICAgICAgIHRoaXMuYnVpbGQoKTsKICAgICAgICBhbmltYXRlRWxlbWVudCh0aGlzLm92ZXJsYXksIHRoaXMuc2V0dGluZ3Mub3BlbkVmZmVjdCA9PSAnbm9uZScgPyAnbm9uZScgOiB0aGlzLnNldHRpbmdzLmNzc0VmZWN0cy5mYWRlWyJpbiJdKTsKICAgICAgICB2YXIgYm9keSA9IGRvY3VtZW50LmJvZHk7CiAgICAgICAgdmFyIHNjcm9sbEJhciA9IHdpbmRvdy5pbm5lcldpZHRoIC0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoOwoKICAgICAgICBpZiAoc2Nyb2xsQmFyID4gMCkgewogICAgICAgICAgdmFyIHN0eWxlU2hlZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpOwogICAgICAgICAgc3R5bGVTaGVldC50eXBlID0gJ3RleHQvY3NzJzsKICAgICAgICAgIHN0eWxlU2hlZXQuY2xhc3NOYW1lID0gJ2djc3Mtc3R5bGVzJzsKICAgICAgICAgIHN0eWxlU2hlZXQuaW5uZXJUZXh0ID0gIi5nc2Nyb2xsYmFyLWZpeGVyIHttYXJnaW4tcmlnaHQ6ICIuY29uY2F0KHNjcm9sbEJhciwgInB4fSIpOwogICAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZVNoZWV0KTsKICAgICAgICAgIGFkZENsYXNzKGJvZHksICdnc2Nyb2xsYmFyLWZpeGVyJyk7CiAgICAgICAgfQoKICAgICAgICBhZGRDbGFzcyhib2R5LCAnZ2xpZ2h0Ym94LW9wZW4nKTsKICAgICAgICBhZGRDbGFzcyhodG1sLCAnZ2xpZ2h0Ym94LW9wZW4nKTsKCiAgICAgICAgaWYgKGlzTW9iaWxlJDEpIHsKICAgICAgICAgIGFkZENsYXNzKGRvY3VtZW50LmJvZHksICdnbGlnaHRib3gtbW9iaWxlJyk7CiAgICAgICAgICB0aGlzLnNldHRpbmdzLnNsaWRlRWZmZWN0ID0gJ3NsaWRlJzsKICAgICAgICB9CgogICAgICAgIHRoaXMuc2hvd1NsaWRlKGluZGV4LCB0cnVlKTsKCiAgICAgICAgaWYgKHRoaXMuZWxlbWVudHMubGVuZ3RoID09IDEpIHsKICAgICAgICAgIGFkZENsYXNzKHRoaXMucHJldkJ1dHRvbiwgJ2dsaWdodGJveC1idXR0b24taGlkZGVuJyk7CiAgICAgICAgICBhZGRDbGFzcyh0aGlzLm5leHRCdXR0b24sICdnbGlnaHRib3gtYnV0dG9uLWhpZGRlbicpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZW1vdmVDbGFzcyh0aGlzLnByZXZCdXR0b24sICdnbGlnaHRib3gtYnV0dG9uLWhpZGRlbicpOwogICAgICAgICAgcmVtb3ZlQ2xhc3ModGhpcy5uZXh0QnV0dG9uLCAnZ2xpZ2h0Ym94LWJ1dHRvbi1oaWRkZW4nKTsKICAgICAgICB9CgogICAgICAgIHRoaXMubGlnaHRib3hPcGVuID0gdHJ1ZTsKICAgICAgICB0aGlzLnRyaWdnZXIoJ29wZW4nKTsKCiAgICAgICAgaWYgKGlzRnVuY3Rpb24odGhpcy5zZXR0aW5ncy5vbk9wZW4pKSB7CiAgICAgICAgICB0aGlzLnNldHRpbmdzLm9uT3BlbigpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGlzVG91Y2gkMSAmJiB0aGlzLnNldHRpbmdzLnRvdWNoTmF2aWdhdGlvbikgewogICAgICAgICAgdG91Y2hOYXZpZ2F0aW9uKHRoaXMpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3Mua2V5Ym9hcmROYXZpZ2F0aW9uKSB7CiAgICAgICAgICBrZXlib2FyZE5hdmlnYXRpb24odGhpcyk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm9wZW5BdCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuQXQoKSB7CiAgICAgICAgdmFyIGluZGV4ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAwOwogICAgICAgIHRoaXMub3BlbihudWxsLCBpbmRleCk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic2hvd1NsaWRlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNob3dTbGlkZSgpIHsKICAgICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgICAgdmFyIGluZGV4ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAwOwogICAgICAgIHZhciBmaXJzdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CiAgICAgICAgc2hvdyh0aGlzLmxvYWRlcik7CiAgICAgICAgdGhpcy5pbmRleCA9IHBhcnNlSW50KGluZGV4KTsKICAgICAgICB2YXIgY3VycmVudCA9IHRoaXMuc2xpZGVzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5jdXJyZW50Jyk7CgogICAgICAgIGlmIChjdXJyZW50KSB7CiAgICAgICAgICByZW1vdmVDbGFzcyhjdXJyZW50LCAnY3VycmVudCcpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5zbGlkZUFuaW1hdGVPdXQoKTsKICAgICAgICB2YXIgc2xpZGVOb2RlID0gdGhpcy5zbGlkZXNDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmdzbGlkZScpW2luZGV4XTsKCiAgICAgICAgaWYgKGhhc0NsYXNzKHNsaWRlTm9kZSwgJ2xvYWRlZCcpKSB7CiAgICAgICAgICB0aGlzLnNsaWRlQW5pbWF0ZUluKHNsaWRlTm9kZSwgZmlyc3QpOwogICAgICAgICAgaGlkZSh0aGlzLmxvYWRlcik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNob3codGhpcy5sb2FkZXIpOwogICAgICAgICAgdmFyIHNsaWRlID0gdGhpcy5lbGVtZW50c1tpbmRleF07CiAgICAgICAgICB2YXIgc2xpZGVEYXRhID0gewogICAgICAgICAgICBpbmRleDogdGhpcy5pbmRleCwKICAgICAgICAgICAgc2xpZGU6IHNsaWRlTm9kZSwKICAgICAgICAgICAgc2xpZGVOb2RlOiBzbGlkZU5vZGUsCiAgICAgICAgICAgIHNsaWRlQ29uZmlnOiBzbGlkZS5zbGlkZUNvbmZpZywKICAgICAgICAgICAgc2xpZGVJbmRleDogdGhpcy5pbmRleCwKICAgICAgICAgICAgdHJpZ2dlcjogc2xpZGUubm9kZSwKICAgICAgICAgICAgcGxheWVyOiBudWxsCiAgICAgICAgICB9OwogICAgICAgICAgdGhpcy50cmlnZ2VyKCdzbGlkZV9iZWZvcmVfbG9hZCcsIHNsaWRlRGF0YSk7CiAgICAgICAgICBzbGlkZS5pbnN0YW5jZS5zZXRDb250ZW50KHNsaWRlTm9kZSwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICBoaWRlKF90aGlzMi5sb2FkZXIpOwoKICAgICAgICAgICAgX3RoaXMyLnJlc2l6ZSgpOwoKICAgICAgICAgICAgX3RoaXMyLnNsaWRlQW5pbWF0ZUluKHNsaWRlTm9kZSwgZmlyc3QpOwoKICAgICAgICAgICAgX3RoaXMyLnRyaWdnZXIoJ3NsaWRlX2FmdGVyX2xvYWQnLCBzbGlkZURhdGEpOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnNsaWRlRGVzY3JpcHRpb24gPSBzbGlkZU5vZGUucXVlcnlTZWxlY3RvcignLmdzbGlkZS1kZXNjcmlwdGlvbicpOwogICAgICAgIHRoaXMuc2xpZGVEZXNjcmlwdGlvbkNvbnRhaW5lZCA9IHRoaXMuc2xpZGVEZXNjcmlwdGlvbiAmJiBoYXNDbGFzcyh0aGlzLnNsaWRlRGVzY3JpcHRpb24ucGFyZW50Tm9kZSwgJ2dzbGlkZS1tZWRpYScpOwoKICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5wcmVsb2FkKSB7CiAgICAgICAgICB0aGlzLnByZWxvYWRTbGlkZShpbmRleCArIDEpOwogICAgICAgICAgdGhpcy5wcmVsb2FkU2xpZGUoaW5kZXggLSAxKTsKICAgICAgICB9CgogICAgICAgIHRoaXMudXBkYXRlTmF2aWdhdGlvbkNsYXNzZXMoKTsKICAgICAgICB0aGlzLmFjdGl2ZVNsaWRlID0gc2xpZGVOb2RlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInByZWxvYWRTbGlkZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBwcmVsb2FkU2xpZGUoaW5kZXgpIHsKICAgICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+IHRoaXMuZWxlbWVudHMubGVuZ3RoIC0gMSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGlzTmlsKHRoaXMuZWxlbWVudHNbaW5kZXhdKSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdmFyIHNsaWRlTm9kZSA9IHRoaXMuc2xpZGVzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5nc2xpZGUnKVtpbmRleF07CgogICAgICAgIGlmIChoYXNDbGFzcyhzbGlkZU5vZGUsICdsb2FkZWQnKSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdmFyIHNsaWRlID0gdGhpcy5lbGVtZW50c1tpbmRleF07CiAgICAgICAgdmFyIHR5cGUgPSBzbGlkZS50eXBlOwogICAgICAgIHZhciBzbGlkZURhdGEgPSB7CiAgICAgICAgICBpbmRleDogaW5kZXgsCiAgICAgICAgICBzbGlkZTogc2xpZGVOb2RlLAogICAgICAgICAgc2xpZGVOb2RlOiBzbGlkZU5vZGUsCiAgICAgICAgICBzbGlkZUNvbmZpZzogc2xpZGUuc2xpZGVDb25maWcsCiAgICAgICAgICBzbGlkZUluZGV4OiBpbmRleCwKICAgICAgICAgIHRyaWdnZXI6IHNsaWRlLm5vZGUsCiAgICAgICAgICBwbGF5ZXI6IG51bGwKICAgICAgICB9OwogICAgICAgIHRoaXMudHJpZ2dlcignc2xpZGVfYmVmb3JlX2xvYWQnLCBzbGlkZURhdGEpOwoKICAgICAgICBpZiAodHlwZSA9PSAndmlkZW8nIHx8IHR5cGUgPT0gJ2V4dGVybmFsJykgewogICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHNsaWRlLmluc3RhbmNlLnNldENvbnRlbnQoc2xpZGVOb2RlLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgX3RoaXMzLnRyaWdnZXIoJ3NsaWRlX2FmdGVyX2xvYWQnLCBzbGlkZURhdGEpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0sIDIwMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNsaWRlLmluc3RhbmNlLnNldENvbnRlbnQoc2xpZGVOb2RlLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIF90aGlzMy50cmlnZ2VyKCdzbGlkZV9hZnRlcl9sb2FkJywgc2xpZGVEYXRhKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJwcmV2U2xpZGUiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gcHJldlNsaWRlKCkgewogICAgICAgIHRoaXMuZ29Ub1NsaWRlKHRoaXMuaW5kZXggLSAxKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJuZXh0U2xpZGUiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gbmV4dFNsaWRlKCkgewogICAgICAgIHRoaXMuZ29Ub1NsaWRlKHRoaXMuaW5kZXggKyAxKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJnb1RvU2xpZGUiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ29Ub1NsaWRlKCkgewogICAgICAgIHZhciBpbmRleCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7CiAgICAgICAgdGhpcy5wcmV2QWN0aXZlU2xpZGUgPSB0aGlzLmFjdGl2ZVNsaWRlOwogICAgICAgIHRoaXMucHJldkFjdGl2ZVNsaWRlSW5kZXggPSB0aGlzLmluZGV4OwoKICAgICAgICBpZiAoIXRoaXMubG9vcCgpICYmIChpbmRleCA8IDAgfHwgaW5kZXggPiB0aGlzLmVsZW1lbnRzLmxlbmd0aCAtIDEpKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAoaW5kZXggPCAwKSB7CiAgICAgICAgICBpbmRleCA9IHRoaXMuZWxlbWVudHMubGVuZ3RoIC0gMTsKICAgICAgICB9IGVsc2UgaWYgKGluZGV4ID49IHRoaXMuZWxlbWVudHMubGVuZ3RoKSB7CiAgICAgICAgICBpbmRleCA9IDA7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnNob3dTbGlkZShpbmRleCk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiaW5zZXJ0U2xpZGUiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zZXJ0U2xpZGUoKSB7CiAgICAgICAgdmFyIGNvbmZpZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgICAgICAgdmFyIGluZGV4ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAtMTsKCiAgICAgICAgaWYgKGluZGV4IDwgMCkgewogICAgICAgICAgaW5kZXggPSB0aGlzLmVsZW1lbnRzLmxlbmd0aDsKICAgICAgICB9CgogICAgICAgIHZhciBzbGlkZSA9IG5ldyBTbGlkZShjb25maWcsIHRoaXMsIGluZGV4KTsKICAgICAgICB2YXIgZGF0YSA9IHNsaWRlLmdldENvbmZpZygpOwogICAgICAgIHZhciBzbGlkZUluZm8gPSBleHRlbmQoe30sIGRhdGEpOwogICAgICAgIHZhciBuZXdTbGlkZSA9IHNsaWRlLmNyZWF0ZSgpOwogICAgICAgIHZhciB0b3RhbFNsaWRlcyA9IHRoaXMuZWxlbWVudHMubGVuZ3RoIC0gMTsKICAgICAgICBzbGlkZUluZm8uaW5kZXggPSBpbmRleDsKICAgICAgICBzbGlkZUluZm8ubm9kZSA9IGZhbHNlOwogICAgICAgIHNsaWRlSW5mby5pbnN0YW5jZSA9IHNsaWRlOwogICAgICAgIHNsaWRlSW5mby5zbGlkZUNvbmZpZyA9IGRhdGE7CiAgICAgICAgdGhpcy5lbGVtZW50cy5zcGxpY2UoaW5kZXgsIDAsIHNsaWRlSW5mbyk7CiAgICAgICAgdmFyIGFkZGVkU2xpZGVOb2RlID0gbnVsbDsKICAgICAgICB2YXIgYWRkZWRTbGlkZVBsYXllciA9IG51bGw7CgogICAgICAgIGlmICh0aGlzLnNsaWRlc0NvbnRhaW5lcikgewogICAgICAgICAgaWYgKGluZGV4ID4gdG90YWxTbGlkZXMpIHsKICAgICAgICAgICAgdGhpcy5zbGlkZXNDb250YWluZXIuYXBwZW5kQ2hpbGQobmV3U2xpZGUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIGV4aXN0aW5nU2xpZGUgPSB0aGlzLnNsaWRlc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuZ3NsaWRlJylbaW5kZXhdOwogICAgICAgICAgICB0aGlzLnNsaWRlc0NvbnRhaW5lci5pbnNlcnRCZWZvcmUobmV3U2xpZGUsIGV4aXN0aW5nU2xpZGUpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnByZWxvYWQgJiYgdGhpcy5pbmRleCA9PSAwICYmIGluZGV4ID09IDAgfHwgdGhpcy5pbmRleCAtIDEgPT0gaW5kZXggfHwgdGhpcy5pbmRleCArIDEgPT0gaW5kZXgpIHsKICAgICAgICAgICAgdGhpcy5wcmVsb2FkU2xpZGUoaW5kZXgpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0aGlzLmluZGV4ID09IDAgJiYgaW5kZXggPT0gMCkgewogICAgICAgICAgICB0aGlzLmluZGV4ID0gMTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnVwZGF0ZU5hdmlnYXRpb25DbGFzc2VzKCk7CiAgICAgICAgICBhZGRlZFNsaWRlTm9kZSA9IHRoaXMuc2xpZGVzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5nc2xpZGUnKVtpbmRleF07CiAgICAgICAgICBhZGRlZFNsaWRlUGxheWVyID0gdGhpcy5nZXRTbGlkZVBsYXllckluc3RhbmNlKGluZGV4KTsKICAgICAgICAgIHNsaWRlSW5mby5zbGlkZU5vZGUgPSBhZGRlZFNsaWRlTm9kZTsKICAgICAgICB9CgogICAgICAgIHRoaXMudHJpZ2dlcignc2xpZGVfaW5zZXJ0ZWQnLCB7CiAgICAgICAgICBpbmRleDogaW5kZXgsCiAgICAgICAgICBzbGlkZTogYWRkZWRTbGlkZU5vZGUsCiAgICAgICAgICBzbGlkZU5vZGU6IGFkZGVkU2xpZGVOb2RlLAogICAgICAgICAgc2xpZGVDb25maWc6IGRhdGEsCiAgICAgICAgICBzbGlkZUluZGV4OiBpbmRleCwKICAgICAgICAgIHRyaWdnZXI6IG51bGwsCiAgICAgICAgICBwbGF5ZXI6IGFkZGVkU2xpZGVQbGF5ZXIKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGlzRnVuY3Rpb24odGhpcy5zZXR0aW5ncy5zbGlkZUluc2VydGVkKSkgewogICAgICAgICAgdGhpcy5zZXR0aW5ncy5zbGlkZUluc2VydGVkKHsKICAgICAgICAgICAgaW5kZXg6IGluZGV4LAogICAgICAgICAgICBzbGlkZTogYWRkZWRTbGlkZU5vZGUsCiAgICAgICAgICAgIHBsYXllcjogYWRkZWRTbGlkZVBsYXllcgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInJlbW92ZVNsaWRlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVNsaWRlKCkgewogICAgICAgIHZhciBpbmRleCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogLTE7CgogICAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPiB0aGlzLmVsZW1lbnRzLmxlbmd0aCAtIDEpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHZhciBzbGlkZSA9IHRoaXMuc2xpZGVzQ29udGFpbmVyICYmIHRoaXMuc2xpZGVzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5nc2xpZGUnKVtpbmRleF07CgogICAgICAgIGlmIChzbGlkZSkgewogICAgICAgICAgaWYgKHRoaXMuZ2V0QWN0aXZlU2xpZGVJbmRleCgpID09IGluZGV4KSB7CiAgICAgICAgICAgIGlmIChpbmRleCA9PSB0aGlzLmVsZW1lbnRzLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgICB0aGlzLnByZXZTbGlkZSgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMubmV4dFNsaWRlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBzbGlkZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNsaWRlKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuZWxlbWVudHMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICB0aGlzLnRyaWdnZXIoJ3NsaWRlX3JlbW92ZWQnLCBpbmRleCk7CgogICAgICAgIGlmIChpc0Z1bmN0aW9uKHRoaXMuc2V0dGluZ3Muc2xpZGVSZW1vdmVkKSkgewogICAgICAgICAgdGhpcy5zZXR0aW5ncy5zbGlkZVJlbW92ZWQoaW5kZXgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJzbGlkZUFuaW1hdGVJbiIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzbGlkZUFuaW1hdGVJbihzbGlkZSwgZmlyc3QpIHsKICAgICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgICAgdmFyIHNsaWRlTWVkaWEgPSBzbGlkZS5xdWVyeVNlbGVjdG9yKCcuZ3NsaWRlLW1lZGlhJyk7CiAgICAgICAgdmFyIHNsaWRlRGVzYyA9IHNsaWRlLnF1ZXJ5U2VsZWN0b3IoJy5nc2xpZGUtZGVzY3JpcHRpb24nKTsKICAgICAgICB2YXIgcHJldkRhdGEgPSB7CiAgICAgICAgICBpbmRleDogdGhpcy5wcmV2QWN0aXZlU2xpZGVJbmRleCwKICAgICAgICAgIHNsaWRlOiB0aGlzLnByZXZBY3RpdmVTbGlkZSwKICAgICAgICAgIHNsaWRlTm9kZTogdGhpcy5wcmV2QWN0aXZlU2xpZGUsCiAgICAgICAgICBzbGlkZUluZGV4OiB0aGlzLnByZXZBY3RpdmVTbGlkZSwKICAgICAgICAgIHNsaWRlQ29uZmlnOiBpc05pbCh0aGlzLnByZXZBY3RpdmVTbGlkZUluZGV4KSA/IG51bGwgOiB0aGlzLmVsZW1lbnRzW3RoaXMucHJldkFjdGl2ZVNsaWRlSW5kZXhdLnNsaWRlQ29uZmlnLAogICAgICAgICAgdHJpZ2dlcjogaXNOaWwodGhpcy5wcmV2QWN0aXZlU2xpZGVJbmRleCkgPyBudWxsIDogdGhpcy5lbGVtZW50c1t0aGlzLnByZXZBY3RpdmVTbGlkZUluZGV4XS5ub2RlLAogICAgICAgICAgcGxheWVyOiB0aGlzLmdldFNsaWRlUGxheWVySW5zdGFuY2UodGhpcy5wcmV2QWN0aXZlU2xpZGVJbmRleCkKICAgICAgICB9OwogICAgICAgIHZhciBuZXh0RGF0YSA9IHsKICAgICAgICAgIGluZGV4OiB0aGlzLmluZGV4LAogICAgICAgICAgc2xpZGU6IHRoaXMuYWN0aXZlU2xpZGUsCiAgICAgICAgICBzbGlkZU5vZGU6IHRoaXMuYWN0aXZlU2xpZGUsCiAgICAgICAgICBzbGlkZUNvbmZpZzogdGhpcy5lbGVtZW50c1t0aGlzLmluZGV4XS5zbGlkZUNvbmZpZywKICAgICAgICAgIHNsaWRlSW5kZXg6IHRoaXMuaW5kZXgsCiAgICAgICAgICB0cmlnZ2VyOiB0aGlzLmVsZW1lbnRzW3RoaXMuaW5kZXhdLm5vZGUsCiAgICAgICAgICBwbGF5ZXI6IHRoaXMuZ2V0U2xpZGVQbGF5ZXJJbnN0YW5jZSh0aGlzLmluZGV4KQogICAgICAgIH07CgogICAgICAgIGlmIChzbGlkZU1lZGlhLm9mZnNldFdpZHRoID4gMCAmJiBzbGlkZURlc2MpIHsKICAgICAgICAgIGhpZGUoc2xpZGVEZXNjKTsKICAgICAgICAgIHNsaWRlRGVzYy5zdHlsZS5kaXNwbGF5ID0gJyc7CiAgICAgICAgfQoKICAgICAgICByZW1vdmVDbGFzcyhzbGlkZSwgdGhpcy5lZmZlY3RzQ2xhc3Nlcyk7CgogICAgICAgIGlmIChmaXJzdCkgewogICAgICAgICAgYW5pbWF0ZUVsZW1lbnQoc2xpZGUsIHRoaXMuc2V0dGluZ3MuY3NzRWZlY3RzW3RoaXMuc2V0dGluZ3Mub3BlbkVmZmVjdF1bImluIl0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKF90aGlzNC5zZXR0aW5ncy5hdXRvcGxheVZpZGVvcykgewogICAgICAgICAgICAgIF90aGlzNC5zbGlkZVBsYXllclBsYXkoc2xpZGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczQudHJpZ2dlcignc2xpZGVfY2hhbmdlZCcsIHsKICAgICAgICAgICAgICBwcmV2OiBwcmV2RGF0YSwKICAgICAgICAgICAgICBjdXJyZW50OiBuZXh0RGF0YQogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKF90aGlzNC5zZXR0aW5ncy5hZnRlclNsaWRlQ2hhbmdlKSkgewogICAgICAgICAgICAgIF90aGlzNC5zZXR0aW5ncy5hZnRlclNsaWRlQ2hhbmdlLmFwcGx5KF90aGlzNCwgW3ByZXZEYXRhLCBuZXh0RGF0YV0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIGVmZmVjdE5hbWUgPSB0aGlzLnNldHRpbmdzLnNsaWRlRWZmZWN0OwogICAgICAgICAgdmFyIGFuaW1JbiA9IGVmZmVjdE5hbWUgIT09ICdub25lJyA/IHRoaXMuc2V0dGluZ3MuY3NzRWZlY3RzW2VmZmVjdE5hbWVdWyJpbiJdIDogZWZmZWN0TmFtZTsKCiAgICAgICAgICBpZiAodGhpcy5wcmV2QWN0aXZlU2xpZGVJbmRleCA+IHRoaXMuaW5kZXgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3Muc2xpZGVFZmZlY3QgPT0gJ3NsaWRlJykgewogICAgICAgICAgICAgIGFuaW1JbiA9IHRoaXMuc2V0dGluZ3MuY3NzRWZlY3RzLnNsaWRlQmFja1siaW4iXTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGFuaW1hdGVFbGVtZW50KHNsaWRlLCBhbmltSW4sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKF90aGlzNC5zZXR0aW5ncy5hdXRvcGxheVZpZGVvcykgewogICAgICAgICAgICAgIF90aGlzNC5zbGlkZVBsYXllclBsYXkoc2xpZGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczQudHJpZ2dlcignc2xpZGVfY2hhbmdlZCcsIHsKICAgICAgICAgICAgICBwcmV2OiBwcmV2RGF0YSwKICAgICAgICAgICAgICBjdXJyZW50OiBuZXh0RGF0YQogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKF90aGlzNC5zZXR0aW5ncy5hZnRlclNsaWRlQ2hhbmdlKSkgewogICAgICAgICAgICAgIF90aGlzNC5zZXR0aW5ncy5hZnRlclNsaWRlQ2hhbmdlLmFwcGx5KF90aGlzNCwgW3ByZXZEYXRhLCBuZXh0RGF0YV0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXM0LnJlc2l6ZShzbGlkZSk7CiAgICAgICAgfSwgMTAwKTsKICAgICAgICBhZGRDbGFzcyhzbGlkZSwgJ2N1cnJlbnQnKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJzbGlkZUFuaW1hdGVPdXQiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gc2xpZGVBbmltYXRlT3V0KCkgewogICAgICAgIGlmICghdGhpcy5wcmV2QWN0aXZlU2xpZGUpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHZhciBwcmV2U2xpZGUgPSB0aGlzLnByZXZBY3RpdmVTbGlkZTsKICAgICAgICByZW1vdmVDbGFzcyhwcmV2U2xpZGUsIHRoaXMuZWZmZWN0c0NsYXNzZXMpOwogICAgICAgIGFkZENsYXNzKHByZXZTbGlkZSwgJ3ByZXYnKTsKICAgICAgICB2YXIgYW5pbWF0aW9uID0gdGhpcy5zZXR0aW5ncy5zbGlkZUVmZmVjdDsKICAgICAgICB2YXIgYW5pbU91dCA9IGFuaW1hdGlvbiAhPT0gJ25vbmUnID8gdGhpcy5zZXR0aW5ncy5jc3NFZmVjdHNbYW5pbWF0aW9uXS5vdXQgOiBhbmltYXRpb247CiAgICAgICAgdGhpcy5zbGlkZVBsYXllclBhdXNlKHByZXZTbGlkZSk7CiAgICAgICAgdGhpcy50cmlnZ2VyKCdzbGlkZV9iZWZvcmVfY2hhbmdlJywgewogICAgICAgICAgcHJldjogewogICAgICAgICAgICBpbmRleDogdGhpcy5wcmV2QWN0aXZlU2xpZGVJbmRleCwKICAgICAgICAgICAgc2xpZGU6IHRoaXMucHJldkFjdGl2ZVNsaWRlLAogICAgICAgICAgICBzbGlkZU5vZGU6IHRoaXMucHJldkFjdGl2ZVNsaWRlLAogICAgICAgICAgICBzbGlkZUluZGV4OiB0aGlzLnByZXZBY3RpdmVTbGlkZUluZGV4LAogICAgICAgICAgICBzbGlkZUNvbmZpZzogaXNOaWwodGhpcy5wcmV2QWN0aXZlU2xpZGVJbmRleCkgPyBudWxsIDogdGhpcy5lbGVtZW50c1t0aGlzLnByZXZBY3RpdmVTbGlkZUluZGV4XS5zbGlkZUNvbmZpZywKICAgICAgICAgICAgdHJpZ2dlcjogaXNOaWwodGhpcy5wcmV2QWN0aXZlU2xpZGVJbmRleCkgPyBudWxsIDogdGhpcy5lbGVtZW50c1t0aGlzLnByZXZBY3RpdmVTbGlkZUluZGV4XS5ub2RlLAogICAgICAgICAgICBwbGF5ZXI6IHRoaXMuZ2V0U2xpZGVQbGF5ZXJJbnN0YW5jZSh0aGlzLnByZXZBY3RpdmVTbGlkZUluZGV4KQogICAgICAgICAgfSwKICAgICAgICAgIGN1cnJlbnQ6IHsKICAgICAgICAgICAgaW5kZXg6IHRoaXMuaW5kZXgsCiAgICAgICAgICAgIHNsaWRlOiB0aGlzLmFjdGl2ZVNsaWRlLAogICAgICAgICAgICBzbGlkZU5vZGU6IHRoaXMuYWN0aXZlU2xpZGUsCiAgICAgICAgICAgIHNsaWRlSW5kZXg6IHRoaXMuaW5kZXgsCiAgICAgICAgICAgIHNsaWRlQ29uZmlnOiB0aGlzLmVsZW1lbnRzW3RoaXMuaW5kZXhdLnNsaWRlQ29uZmlnLAogICAgICAgICAgICB0cmlnZ2VyOiB0aGlzLmVsZW1lbnRzW3RoaXMuaW5kZXhdLm5vZGUsCiAgICAgICAgICAgIHBsYXllcjogdGhpcy5nZXRTbGlkZVBsYXllckluc3RhbmNlKHRoaXMuaW5kZXgpCiAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIGlmIChpc0Z1bmN0aW9uKHRoaXMuc2V0dGluZ3MuYmVmb3JlU2xpZGVDaGFuZ2UpKSB7CiAgICAgICAgICB0aGlzLnNldHRpbmdzLmJlZm9yZVNsaWRlQ2hhbmdlLmFwcGx5KHRoaXMsIFt7CiAgICAgICAgICAgIGluZGV4OiB0aGlzLnByZXZBY3RpdmVTbGlkZUluZGV4LAogICAgICAgICAgICBzbGlkZTogdGhpcy5wcmV2QWN0aXZlU2xpZGUsCiAgICAgICAgICAgIHBsYXllcjogdGhpcy5nZXRTbGlkZVBsYXllckluc3RhbmNlKHRoaXMucHJldkFjdGl2ZVNsaWRlSW5kZXgpCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGluZGV4OiB0aGlzLmluZGV4LAogICAgICAgICAgICBzbGlkZTogdGhpcy5hY3RpdmVTbGlkZSwKICAgICAgICAgICAgcGxheWVyOiB0aGlzLmdldFNsaWRlUGxheWVySW5zdGFuY2UodGhpcy5pbmRleCkKICAgICAgICAgIH1dKTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLnByZXZBY3RpdmVTbGlkZUluZGV4ID4gdGhpcy5pbmRleCAmJiB0aGlzLnNldHRpbmdzLnNsaWRlRWZmZWN0ID09ICdzbGlkZScpIHsKICAgICAgICAgIGFuaW1PdXQgPSB0aGlzLnNldHRpbmdzLmNzc0VmZWN0cy5zbGlkZUJhY2sub3V0OwogICAgICAgIH0KCiAgICAgICAgYW5pbWF0ZUVsZW1lbnQocHJldlNsaWRlLCBhbmltT3V0LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgbWVkaWEgPSBwcmV2U2xpZGUucXVlcnlTZWxlY3RvcignLmdzbGlkZS1tZWRpYScpOwogICAgICAgICAgdmFyIGRlc2MgPSBwcmV2U2xpZGUucXVlcnlTZWxlY3RvcignLmdzbGlkZS1kZXNjcmlwdGlvbicpOwogICAgICAgICAgbWVkaWEuc3R5bGUudHJhbnNmb3JtID0gJyc7CiAgICAgICAgICByZW1vdmVDbGFzcyhtZWRpYSwgJ2dyZXNldCcpOwogICAgICAgICAgbWVkaWEuc3R5bGUub3BhY2l0eSA9ICcnOwoKICAgICAgICAgIGlmIChkZXNjKSB7CiAgICAgICAgICAgIGRlc2Muc3R5bGUub3BhY2l0eSA9ICcnOwogICAgICAgICAgfQoKICAgICAgICAgIHJlbW92ZUNsYXNzKHByZXZTbGlkZSwgJ3ByZXYnKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJnZXRBbGxQbGF5ZXJzIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFsbFBsYXllcnMoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudmlkZW9QbGF5ZXJzOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdldFNsaWRlUGxheWVySW5zdGFuY2UiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U2xpZGVQbGF5ZXJJbnN0YW5jZShpbmRleCkgewogICAgICAgIHZhciBpZCA9ICdndmlkZW8nICsgaW5kZXg7CiAgICAgICAgdmFyIHZpZGVvUGxheWVycyA9IHRoaXMuZ2V0QWxsUGxheWVycygpOwoKICAgICAgICBpZiAoaGFzKHZpZGVvUGxheWVycywgaWQpICYmIHZpZGVvUGxheWVyc1tpZF0pIHsKICAgICAgICAgIHJldHVybiB2aWRlb1BsYXllcnNbaWRdOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInN0b3BTbGlkZVZpZGVvIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3BTbGlkZVZpZGVvKHNsaWRlKSB7CiAgICAgICAgaWYgKGlzTm9kZShzbGlkZSkpIHsKICAgICAgICAgIHZhciBub2RlID0gc2xpZGUucXVlcnlTZWxlY3RvcignLmd2aWRlby13cmFwcGVyJyk7CgogICAgICAgICAgaWYgKG5vZGUpIHsKICAgICAgICAgICAgc2xpZGUgPSBub2RlLmdldEF0dHJpYnV0ZSgnZGF0YS1pbmRleCcpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29uc29sZS5sb2coJ3N0b3BTbGlkZVZpZGVvIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbGlkZVBsYXllclBhdXNlJyk7CiAgICAgICAgdmFyIHBsYXllciA9IHRoaXMuZ2V0U2xpZGVQbGF5ZXJJbnN0YW5jZShzbGlkZSk7CgogICAgICAgIGlmIChwbGF5ZXIgJiYgcGxheWVyLnBsYXlpbmcpIHsKICAgICAgICAgIHBsYXllci5wYXVzZSgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJzbGlkZVBsYXllclBhdXNlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNsaWRlUGxheWVyUGF1c2Uoc2xpZGUpIHsKICAgICAgICBpZiAoaXNOb2RlKHNsaWRlKSkgewogICAgICAgICAgdmFyIG5vZGUgPSBzbGlkZS5xdWVyeVNlbGVjdG9yKCcuZ3ZpZGVvLXdyYXBwZXInKTsKCiAgICAgICAgICBpZiAobm9kZSkgewogICAgICAgICAgICBzbGlkZSA9IG5vZGUuZ2V0QXR0cmlidXRlKCdkYXRhLWluZGV4Jyk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgcGxheWVyID0gdGhpcy5nZXRTbGlkZVBsYXllckluc3RhbmNlKHNsaWRlKTsKCiAgICAgICAgaWYgKHBsYXllciAmJiBwbGF5ZXIucGxheWluZykgewogICAgICAgICAgcGxheWVyLnBhdXNlKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInBsYXlTbGlkZVZpZGVvIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBsYXlTbGlkZVZpZGVvKHNsaWRlKSB7CiAgICAgICAgaWYgKGlzTm9kZShzbGlkZSkpIHsKICAgICAgICAgIHZhciBub2RlID0gc2xpZGUucXVlcnlTZWxlY3RvcignLmd2aWRlby13cmFwcGVyJyk7CgogICAgICAgICAgaWYgKG5vZGUpIHsKICAgICAgICAgICAgc2xpZGUgPSBub2RlLmdldEF0dHJpYnV0ZSgnZGF0YS1pbmRleCcpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29uc29sZS5sb2coJ3BsYXlTbGlkZVZpZGVvIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbGlkZVBsYXllclBsYXknKTsKICAgICAgICB2YXIgcGxheWVyID0gdGhpcy5nZXRTbGlkZVBsYXllckluc3RhbmNlKHNsaWRlKTsKCiAgICAgICAgaWYgKHBsYXllciAmJiAhcGxheWVyLnBsYXlpbmcpIHsKICAgICAgICAgIHBsYXllci5wbGF5KCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInNsaWRlUGxheWVyUGxheSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzbGlkZVBsYXllclBsYXkoc2xpZGUpIHsKICAgICAgICBpZiAoaXNOb2RlKHNsaWRlKSkgewogICAgICAgICAgdmFyIG5vZGUgPSBzbGlkZS5xdWVyeVNlbGVjdG9yKCcuZ3ZpZGVvLXdyYXBwZXInKTsKCiAgICAgICAgICBpZiAobm9kZSkgewogICAgICAgICAgICBzbGlkZSA9IG5vZGUuZ2V0QXR0cmlidXRlKCdkYXRhLWluZGV4Jyk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgcGxheWVyID0gdGhpcy5nZXRTbGlkZVBsYXllckluc3RhbmNlKHNsaWRlKTsKICAgICAgICBjb25zb2xlLmxvZygnUGxheWVyIGlzJyk7CiAgICAgICAgY29uc29sZS5sb2cocGxheWVyKTsKCiAgICAgICAgaWYgKHBsYXllciAmJiAhcGxheWVyLnBsYXlpbmcpIHsKICAgICAgICAgIHBsYXllci5wbGF5KCk7CgogICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuYXV0b2ZvY3VzVmlkZW9zKSB7CiAgICAgICAgICAgIHBsYXllci5lbGVtZW50cy5jb250YWluZXIuZm9jdXMoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAic2V0RWxlbWVudHMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RWxlbWVudHMoZWxlbWVudHMpIHsKICAgICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgICAgdGhpcy5zZXR0aW5ncy5lbGVtZW50cyA9IGZhbHNlOwogICAgICAgIHZhciBuZXdFbGVtZW50cyA9IFtdOwoKICAgICAgICBpZiAoZWxlbWVudHMgJiYgZWxlbWVudHMubGVuZ3RoKSB7CiAgICAgICAgICBlYWNoKGVsZW1lbnRzLCBmdW5jdGlvbiAoZWwsIGkpIHsKICAgICAgICAgICAgdmFyIHNsaWRlID0gbmV3IFNsaWRlKGVsLCBfdGhpczUsIGkpOwogICAgICAgICAgICB2YXIgZGF0YSA9IHNsaWRlLmdldENvbmZpZygpOwogICAgICAgICAgICB2YXIgc2xpZGVJbmZvID0gZXh0ZW5kKHt9LCBkYXRhKTsKICAgICAgICAgICAgc2xpZGVJbmZvLnNsaWRlQ29uZmlnID0gZGF0YTsKICAgICAgICAgICAgc2xpZGVJbmZvLmluc3RhbmNlID0gc2xpZGU7CiAgICAgICAgICAgIHNsaWRlSW5mby5pbmRleCA9IGk7CiAgICAgICAgICAgIG5ld0VsZW1lbnRzLnB1c2goc2xpZGVJbmZvKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5lbGVtZW50cyA9IG5ld0VsZW1lbnRzOwoKICAgICAgICBpZiAodGhpcy5saWdodGJveE9wZW4pIHsKICAgICAgICAgIHRoaXMuc2xpZGVzQ29udGFpbmVyLmlubmVySFRNTCA9ICcnOwoKICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnRzLmxlbmd0aCkgewogICAgICAgICAgICBlYWNoKHRoaXMuZWxlbWVudHMsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgc2xpZGUgPSBjcmVhdGVIVE1MKF90aGlzNS5zZXR0aW5ncy5zbGlkZUhUTUwpOwoKICAgICAgICAgICAgICBfdGhpczUuc2xpZGVzQ29udGFpbmVyLmFwcGVuZENoaWxkKHNsaWRlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHRoaXMuc2hvd1NsaWRlKDAsIHRydWUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJnZXRFbGVtZW50SW5kZXgiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RWxlbWVudEluZGV4KG5vZGUpIHsKICAgICAgICB2YXIgaW5kZXggPSBmYWxzZTsKICAgICAgICBlYWNoKHRoaXMuZWxlbWVudHMsIGZ1bmN0aW9uIChlbCwgaSkgewogICAgICAgICAgaWYgKGhhcyhlbCwgJ25vZGUnKSAmJiBlbC5ub2RlID09IG5vZGUpIHsKICAgICAgICAgICAgaW5kZXggPSBpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICByZXR1cm4gaW5kZXg7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZ2V0RWxlbWVudHMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RWxlbWVudHMoKSB7CiAgICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICAgIHZhciBsaXN0ID0gW107CiAgICAgICAgdGhpcy5lbGVtZW50cyA9IHRoaXMuZWxlbWVudHMgPyB0aGlzLmVsZW1lbnRzIDogW107CgogICAgICAgIGlmICghaXNOaWwodGhpcy5zZXR0aW5ncy5lbGVtZW50cykgJiYgaXNBcnJheSh0aGlzLnNldHRpbmdzLmVsZW1lbnRzKSAmJiB0aGlzLnNldHRpbmdzLmVsZW1lbnRzLmxlbmd0aCkgewogICAgICAgICAgZWFjaCh0aGlzLnNldHRpbmdzLmVsZW1lbnRzLCBmdW5jdGlvbiAoZWwsIGkpIHsKICAgICAgICAgICAgdmFyIHNsaWRlID0gbmV3IFNsaWRlKGVsLCBfdGhpczYsIGkpOwogICAgICAgICAgICB2YXIgZWxEYXRhID0gc2xpZGUuZ2V0Q29uZmlnKCk7CiAgICAgICAgICAgIHZhciBzbGlkZUluZm8gPSBleHRlbmQoe30sIGVsRGF0YSk7CiAgICAgICAgICAgIHNsaWRlSW5mby5ub2RlID0gZmFsc2U7CiAgICAgICAgICAgIHNsaWRlSW5mby5pbmRleCA9IGk7CiAgICAgICAgICAgIHNsaWRlSW5mby5pbnN0YW5jZSA9IHNsaWRlOwogICAgICAgICAgICBzbGlkZUluZm8uc2xpZGVDb25maWcgPSBlbERhdGE7CiAgICAgICAgICAgIGxpc3QucHVzaChzbGlkZUluZm8pOwogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB2YXIgbm9kZXMgPSBmYWxzZTsKICAgICAgICB2YXIgc2VsZWN0b3IgPSB0aGlzLmdldFNlbGVjdG9yKCk7CgogICAgICAgIGlmIChzZWxlY3RvcikgewogICAgICAgICAgbm9kZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuZ2V0U2VsZWN0b3IoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIW5vZGVzKSB7CiAgICAgICAgICByZXR1cm4gbGlzdDsKICAgICAgICB9CgogICAgICAgIGVhY2gobm9kZXMsIGZ1bmN0aW9uIChlbCwgaSkgewogICAgICAgICAgdmFyIHNsaWRlID0gbmV3IFNsaWRlKGVsLCBfdGhpczYsIGkpOwogICAgICAgICAgdmFyIGVsRGF0YSA9IHNsaWRlLmdldENvbmZpZygpOwogICAgICAgICAgdmFyIHNsaWRlSW5mbyA9IGV4dGVuZCh7fSwgZWxEYXRhKTsKICAgICAgICAgIHNsaWRlSW5mby5ub2RlID0gZWw7CiAgICAgICAgICBzbGlkZUluZm8uaW5kZXggPSBpOwogICAgICAgICAgc2xpZGVJbmZvLmluc3RhbmNlID0gc2xpZGU7CiAgICAgICAgICBzbGlkZUluZm8uc2xpZGVDb25maWcgPSBlbERhdGE7CiAgICAgICAgICBzbGlkZUluZm8uZ2FsbGVyeSA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1nYWxsZXJ5Jyk7CiAgICAgICAgICBsaXN0LnB1c2goc2xpZGVJbmZvKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gbGlzdDsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJnZXRHYWxsZXJ5RWxlbWVudHMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0R2FsbGVyeUVsZW1lbnRzKGxpc3QsIGdhbGxlcnkpIHsKICAgICAgICByZXR1cm4gbGlzdC5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gZWwuZ2FsbGVyeSA9PSBnYWxsZXJ5OwogICAgICAgIH0pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdldFNlbGVjdG9yIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNlbGVjdG9yKCkgewogICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmVsZW1lbnRzKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5zZWxlY3RvciAmJiB0aGlzLnNldHRpbmdzLnNlbGVjdG9yLnN1YnN0cmluZygwLCA1KSA9PSAnZGF0YS0nKSB7CiAgICAgICAgICByZXR1cm4gIipbIi5jb25jYXQodGhpcy5zZXR0aW5ncy5zZWxlY3RvciwgIl0iKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLnNlbGVjdG9yOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdldEFjdGl2ZVNsaWRlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFjdGl2ZVNsaWRlKCkgewogICAgICAgIHJldHVybiB0aGlzLnNsaWRlc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuZ3NsaWRlJylbdGhpcy5pbmRleF07CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZ2V0QWN0aXZlU2xpZGVJbmRleCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBY3RpdmVTbGlkZUluZGV4KCkgewogICAgICAgIHJldHVybiB0aGlzLmluZGV4OwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImdldEFuaW1hdGlvbkNsYXNzZXMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QW5pbWF0aW9uQ2xhc3NlcygpIHsKICAgICAgICB2YXIgZWZmZWN0cyA9IFtdOwoKICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5zZXR0aW5ncy5jc3NFZmVjdHMpIHsKICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmNzc0VmZWN0cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAgICAgICAgIHZhciBlZmZlY3QgPSB0aGlzLnNldHRpbmdzLmNzc0VmZWN0c1trZXldOwogICAgICAgICAgICBlZmZlY3RzLnB1c2goImciLmNvbmNhdChlZmZlY3RbImluIl0pKTsKICAgICAgICAgICAgZWZmZWN0cy5wdXNoKCJnIi5jb25jYXQoZWZmZWN0Lm91dCkpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGVmZmVjdHMuam9pbignICcpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImJ1aWxkIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJ1aWxkKCkgewogICAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgICBpZiAodGhpcy5idWlsdCkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgdmFyIG5leHRTVkcgPSBoYXModGhpcy5zZXR0aW5ncy5zdmcsICduZXh0JykgPyB0aGlzLnNldHRpbmdzLnN2Zy5uZXh0IDogJyc7CiAgICAgICAgdmFyIHByZXZTVkcgPSBoYXModGhpcy5zZXR0aW5ncy5zdmcsICdwcmV2JykgPyB0aGlzLnNldHRpbmdzLnN2Zy5wcmV2IDogJyc7CiAgICAgICAgdmFyIGNsb3NlU1ZHID0gaGFzKHRoaXMuc2V0dGluZ3Muc3ZnLCAnY2xvc2UnKSA/IHRoaXMuc2V0dGluZ3Muc3ZnLmNsb3NlIDogJyc7CiAgICAgICAgdmFyIGxpZ2h0Ym94SFRNTCA9IHRoaXMuc2V0dGluZ3MubGlnaHRib3hIVE1MOwogICAgICAgIGxpZ2h0Ym94SFRNTCA9IGxpZ2h0Ym94SFRNTC5yZXBsYWNlKC97bmV4dFNWR30vZywgbmV4dFNWRyk7CiAgICAgICAgbGlnaHRib3hIVE1MID0gbGlnaHRib3hIVE1MLnJlcGxhY2UoL3twcmV2U1ZHfS9nLCBwcmV2U1ZHKTsKICAgICAgICBsaWdodGJveEhUTUwgPSBsaWdodGJveEhUTUwucmVwbGFjZSgve2Nsb3NlU1ZHfS9nLCBjbG9zZVNWRyk7CiAgICAgICAgbGlnaHRib3hIVE1MID0gY3JlYXRlSFRNTChsaWdodGJveEhUTUwpOwogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGlnaHRib3hIVE1MKTsKICAgICAgICB2YXIgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2xpZ2h0Ym94LWJvZHknKTsKICAgICAgICB0aGlzLm1vZGFsID0gbW9kYWw7CiAgICAgICAgdmFyIGNsb3NlQnV0dG9uID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmdjbG9zZScpOwogICAgICAgIHRoaXMucHJldkJ1dHRvbiA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5ncHJldicpOwogICAgICAgIHRoaXMubmV4dEJ1dHRvbiA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5nbmV4dCcpOwogICAgICAgIHRoaXMub3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5nb3ZlcmxheScpOwogICAgICAgIHRoaXMubG9hZGVyID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmdsb2FkZXInKTsKICAgICAgICB0aGlzLnNsaWRlc0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnbGlnaHRib3gtc2xpZGVyJyk7CiAgICAgICAgdGhpcy5ldmVudHMgPSB7fTsKICAgICAgICBhZGRDbGFzcyh0aGlzLm1vZGFsLCAnZ2xpZ2h0Ym94LScgKyB0aGlzLnNldHRpbmdzLnNraW4pOwoKICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5jbG9zZUJ1dHRvbiAmJiBjbG9zZUJ1dHRvbikgewogICAgICAgICAgdGhpcy5ldmVudHNbJ2Nsb3NlJ10gPSBhZGRFdmVudCgnY2xpY2snLCB7CiAgICAgICAgICAgIG9uRWxlbWVudDogY2xvc2VCdXR0b24sCiAgICAgICAgICAgIHdpdGhDYWxsYmFjazogZnVuY3Rpb24gd2l0aENhbGxiYWNrKGUsIHRhcmdldCkgewogICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKCiAgICAgICAgICAgICAgX3RoaXM3LmNsb3NlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKGNsb3NlQnV0dG9uICYmICF0aGlzLnNldHRpbmdzLmNsb3NlQnV0dG9uKSB7CiAgICAgICAgICBjbG9zZUJ1dHRvbi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNsb3NlQnV0dG9uKTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm5leHRCdXR0b24pIHsKICAgICAgICAgIHRoaXMuZXZlbnRzWyduZXh0J10gPSBhZGRFdmVudCgnY2xpY2snLCB7CiAgICAgICAgICAgIG9uRWxlbWVudDogdGhpcy5uZXh0QnV0dG9uLAogICAgICAgICAgICB3aXRoQ2FsbGJhY2s6IGZ1bmN0aW9uIHdpdGhDYWxsYmFjayhlLCB0YXJnZXQpIHsKICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CgogICAgICAgICAgICAgIF90aGlzNy5uZXh0U2xpZGUoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5wcmV2QnV0dG9uKSB7CiAgICAgICAgICB0aGlzLmV2ZW50c1sncHJldiddID0gYWRkRXZlbnQoJ2NsaWNrJywgewogICAgICAgICAgICBvbkVsZW1lbnQ6IHRoaXMucHJldkJ1dHRvbiwKICAgICAgICAgICAgd2l0aENhbGxiYWNrOiBmdW5jdGlvbiB3aXRoQ2FsbGJhY2soZSwgdGFyZ2V0KSB7CiAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICAgICAgICBfdGhpczcucHJldlNsaWRlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuY2xvc2VPbk91dHNpZGVDbGljaykgewogICAgICAgICAgdGhpcy5ldmVudHNbJ291dENsb3NlJ10gPSBhZGRFdmVudCgnY2xpY2snLCB7CiAgICAgICAgICAgIG9uRWxlbWVudDogbW9kYWwsCiAgICAgICAgICAgIHdpdGhDYWxsYmFjazogZnVuY3Rpb24gd2l0aENhbGxiYWNrKGUsIHRhcmdldCkgewogICAgICAgICAgICAgIGlmICghX3RoaXM3LnByZXZlbnRPdXRzaWRlQ2xpY2sgJiYgIWhhc0NsYXNzKGRvY3VtZW50LmJvZHksICdnbGlnaHRib3gtbW9iaWxlJykgJiYgIWNsb3Nlc3QoZS50YXJnZXQsICcuZ2lubmVyLWNvbnRhaW5lcicpKSB7CiAgICAgICAgICAgICAgICBpZiAoIWNsb3Nlc3QoZS50YXJnZXQsICcuZ2J0bicpICYmICFoYXNDbGFzcyhlLnRhcmdldCwgJ2duZXh0JykgJiYgIWhhc0NsYXNzKGUudGFyZ2V0LCAnZ3ByZXYnKSkgewogICAgICAgICAgICAgICAgICBfdGhpczcuY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgZWFjaCh0aGlzLmVsZW1lbnRzLCBmdW5jdGlvbiAoc2xpZGUsIGkpIHsKICAgICAgICAgIF90aGlzNy5zbGlkZXNDb250YWluZXIuYXBwZW5kQ2hpbGQoc2xpZGUuaW5zdGFuY2UuY3JlYXRlKCkpOwoKICAgICAgICAgIHNsaWRlLnNsaWRlTm9kZSA9IF90aGlzNy5zbGlkZXNDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmdzbGlkZScpW2ldOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoaXNUb3VjaCQxKSB7CiAgICAgICAgICBhZGRDbGFzcyhkb2N1bWVudC5ib2R5LCAnZ2xpZ2h0Ym94LXRvdWNoJyk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmV2ZW50c1sncmVzaXplJ10gPSBhZGRFdmVudCgncmVzaXplJywgewogICAgICAgICAgb25FbGVtZW50OiB3aW5kb3csCiAgICAgICAgICB3aXRoQ2FsbGJhY2s6IGZ1bmN0aW9uIHdpdGhDYWxsYmFjaygpIHsKICAgICAgICAgICAgX3RoaXM3LnJlc2l6ZSgpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHRoaXMuYnVpbHQgPSB0cnVlOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInJlc2l6ZSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiByZXNpemUoKSB7CiAgICAgICAgdmFyIHNsaWRlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBudWxsOwogICAgICAgIHNsaWRlID0gIXNsaWRlID8gdGhpcy5hY3RpdmVTbGlkZSA6IHNsaWRlOwoKICAgICAgICBpZiAoIXNsaWRlIHx8IGhhc0NsYXNzKHNsaWRlLCAnem9vbWVkJykpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciB3aW5TaXplID0gd2luZG93U2l6ZSgpOwogICAgICAgIHZhciB2aWRlbyA9IHNsaWRlLnF1ZXJ5U2VsZWN0b3IoJy5ndmlkZW8td3JhcHBlcicpOwogICAgICAgIHZhciBpbWFnZSA9IHNsaWRlLnF1ZXJ5U2VsZWN0b3IoJy5nc2xpZGUtaW1hZ2UnKTsKICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSB0aGlzLnNsaWRlRGVzY3JpcHRpb247CiAgICAgICAgdmFyIHdpbldpZHRoID0gd2luU2l6ZS53aWR0aDsKICAgICAgICB2YXIgd2luSGVpZ2h0ID0gd2luU2l6ZS5oZWlnaHQ7CgogICAgICAgIGlmICh3aW5XaWR0aCA8PSA3NjgpIHsKICAgICAgICAgIGFkZENsYXNzKGRvY3VtZW50LmJvZHksICdnbGlnaHRib3gtbW9iaWxlJyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlbW92ZUNsYXNzKGRvY3VtZW50LmJvZHksICdnbGlnaHRib3gtbW9iaWxlJyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIXZpZGVvICYmICFpbWFnZSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGRlc2NyaXB0aW9uUmVzaXplID0gZmFsc2U7CgogICAgICAgIGlmIChkZXNjcmlwdGlvbiAmJiAoaGFzQ2xhc3MoZGVzY3JpcHRpb24sICdkZXNjcmlwdGlvbi1ib3R0b20nKSB8fCBoYXNDbGFzcyhkZXNjcmlwdGlvbiwgJ2Rlc2NyaXB0aW9uLXRvcCcpKSAmJiAhaGFzQ2xhc3MoZGVzY3JpcHRpb24sICdnYWJzb2x1dGUnKSkgewogICAgICAgICAgZGVzY3JpcHRpb25SZXNpemUgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGltYWdlKSB7CiAgICAgICAgICBpZiAod2luV2lkdGggPD0gNzY4KSB7CiAgICAgICAgICAgIHZhciBpbWdOb2RlID0gaW1hZ2UucXVlcnlTZWxlY3RvcignaW1nJyk7CiAgICAgICAgICAgIGltZ05vZGUuc2V0QXR0cmlidXRlKCdzdHlsZScsICcnKTsKICAgICAgICAgIH0gZWxzZSBpZiAoZGVzY3JpcHRpb25SZXNpemUpIHsKICAgICAgICAgICAgdmFyIGRlc2NIZWlnaHQgPSBkZXNjcmlwdGlvbi5vZmZzZXRIZWlnaHQ7CgogICAgICAgICAgICB2YXIgX2ltZ05vZGUgPSBpbWFnZS5xdWVyeVNlbGVjdG9yKCdpbWcnKTsKCiAgICAgICAgICAgIF9pbWdOb2RlLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAibWF4LWhlaWdodDogY2FsYygxMDB2aCAtICIuY29uY2F0KGRlc2NIZWlnaHQsICJweCkiKSk7CgogICAgICAgICAgICBkZXNjcmlwdGlvbi5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgIm1heC13aWR0aDogIi5jb25jYXQoX2ltZ05vZGUub2Zmc2V0V2lkdGgsICJweDsiKSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAodmlkZW8pIHsKICAgICAgICAgIHZhciByYXRpbyA9IGhhcyh0aGlzLnNldHRpbmdzLnBseXIuY29uZmlnLCAncmF0aW8nKSA/IHRoaXMuc2V0dGluZ3MucGx5ci5jb25maWcucmF0aW8gOiAnMTY6OSc7CiAgICAgICAgICB2YXIgdmlkZW9SYXRpbyA9IHJhdGlvLnNwbGl0KCc6Jyk7CiAgICAgICAgICB2YXIgbWF4V2lkdGggPSA5MDA7CiAgICAgICAgICB2YXIgbWF4SGVpZ2h0ID0gbWF4V2lkdGggLyAocGFyc2VJbnQodmlkZW9SYXRpb1swXSkgLyBwYXJzZUludCh2aWRlb1JhdGlvWzFdKSk7CiAgICAgICAgICBtYXhIZWlnaHQgPSBNYXRoLmZsb29yKG1heEhlaWdodCk7CgogICAgICAgICAgaWYgKGRlc2NyaXB0aW9uUmVzaXplKSB7CiAgICAgICAgICAgIHdpbkhlaWdodCA9IHdpbkhlaWdodCAtIGRlc2NyaXB0aW9uLm9mZnNldEhlaWdodDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAod2luSGVpZ2h0IDwgbWF4SGVpZ2h0ICYmIHdpbldpZHRoID4gbWF4V2lkdGgpIHsKICAgICAgICAgICAgdmFyIHZ3aWR0aCA9IHZpZGVvLm9mZnNldFdpZHRoOwogICAgICAgICAgICB2YXIgdmhlaWdodCA9IHZpZGVvLm9mZnNldEhlaWdodDsKCiAgICAgICAgICAgIHZhciBfcmF0aW8gPSB3aW5IZWlnaHQgLyB2aGVpZ2h0OwoKICAgICAgICAgICAgdmFyIHZzaXplID0gewogICAgICAgICAgICAgIHdpZHRoOiB2d2lkdGggKiBfcmF0aW8sCiAgICAgICAgICAgICAgaGVpZ2h0OiB2aGVpZ2h0ICogX3JhdGlvCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHZpZGVvLnBhcmVudE5vZGUuc2V0QXR0cmlidXRlKCdzdHlsZScsICJtYXgtd2lkdGg6ICIuY29uY2F0KHZzaXplLndpZHRoLCAicHgiKSk7CgogICAgICAgICAgICBpZiAoZGVzY3JpcHRpb25SZXNpemUpIHsKICAgICAgICAgICAgICBkZXNjcmlwdGlvbi5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgIm1heC13aWR0aDogIi5jb25jYXQodnNpemUud2lkdGgsICJweDsiKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZpZGVvLnBhcmVudE5vZGUuc3R5bGUubWF4V2lkdGggPSAiIi5jb25jYXQobWF4V2lkdGgsICJweCIpOwoKICAgICAgICAgICAgaWYgKGRlc2NyaXB0aW9uUmVzaXplKSB7CiAgICAgICAgICAgICAgZGVzY3JpcHRpb24uc2V0QXR0cmlidXRlKCdzdHlsZScsICJtYXgtd2lkdGg6ICIuY29uY2F0KG1heFdpZHRoLCAicHg7IikpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInJlbG9hZCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWxvYWQoKSB7CiAgICAgICAgdGhpcy5pbml0KCk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAidXBkYXRlTmF2aWdhdGlvbkNsYXNzZXMiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlTmF2aWdhdGlvbkNsYXNzZXMoKSB7CiAgICAgICAgdmFyIGxvb3AgPSB0aGlzLmxvb3AoKTsKICAgICAgICByZW1vdmVDbGFzcyh0aGlzLm5leHRCdXR0b24sICdkaXNhYmxlZCcpOwogICAgICAgIHJlbW92ZUNsYXNzKHRoaXMucHJldkJ1dHRvbiwgJ2Rpc2FibGVkJyk7CgogICAgICAgIGlmICh0aGlzLmluZGV4ID09IDAgJiYgdGhpcy5lbGVtZW50cy5sZW5ndGggLSAxID09IDApIHsKICAgICAgICAgIGFkZENsYXNzKHRoaXMucHJldkJ1dHRvbiwgJ2Rpc2FibGVkJyk7CiAgICAgICAgICBhZGRDbGFzcyh0aGlzLm5leHRCdXR0b24sICdkaXNhYmxlZCcpOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5pbmRleCA9PT0gMCAmJiAhbG9vcCkgewogICAgICAgICAgYWRkQ2xhc3ModGhpcy5wcmV2QnV0dG9uLCAnZGlzYWJsZWQnKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaW5kZXggPT09IHRoaXMuZWxlbWVudHMubGVuZ3RoIC0gMSAmJiAhbG9vcCkgewogICAgICAgICAgYWRkQ2xhc3ModGhpcy5uZXh0QnV0dG9uLCAnZGlzYWJsZWQnKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAibG9vcCIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb29wKCkgewogICAgICAgIHZhciBsb29wID0gaGFzKHRoaXMuc2V0dGluZ3MsICdsb29wQXRFbmQnKSA/IHRoaXMuc2V0dGluZ3MubG9vcEF0RW5kIDogbnVsbDsKICAgICAgICBsb29wID0gaGFzKHRoaXMuc2V0dGluZ3MsICdsb29wJykgPyB0aGlzLnNldHRpbmdzLmxvb3AgOiBsb29wOwogICAgICAgIHJldHVybiBsb29wOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNsb3NlIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb3NlKCkgewogICAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgICBpZiAoIXRoaXMubGlnaHRib3hPcGVuKSB7CiAgICAgICAgICBpZiAodGhpcy5ldmVudHMpIHsKICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuZXZlbnRzKSB7CiAgICAgICAgICAgICAgaWYgKHRoaXMuZXZlbnRzLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRzW2tleV0uZGVzdHJveSgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy5ldmVudHMgPSBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmNsb3NpbmcpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHRoaXMuY2xvc2luZyA9IHRydWU7CiAgICAgICAgdGhpcy5zbGlkZVBsYXllclBhdXNlKHRoaXMuYWN0aXZlU2xpZGUpOwoKICAgICAgICBpZiAodGhpcy5mdWxsRWxlbWVudHNMaXN0KSB7CiAgICAgICAgICB0aGlzLmVsZW1lbnRzID0gdGhpcy5mdWxsRWxlbWVudHNMaXN0OwogICAgICAgIH0KCiAgICAgICAgYWRkQ2xhc3ModGhpcy5tb2RhbCwgJ2dsaWdodGJveC1jbG9zaW5nJyk7CiAgICAgICAgYW5pbWF0ZUVsZW1lbnQodGhpcy5vdmVybGF5LCB0aGlzLnNldHRpbmdzLm9wZW5FZmZlY3QgPT0gJ25vbmUnID8gJ25vbmUnIDogdGhpcy5zZXR0aW5ncy5jc3NFZmVjdHMuZmFkZS5vdXQpOwogICAgICAgIGFuaW1hdGVFbGVtZW50KHRoaXMuYWN0aXZlU2xpZGUsIHRoaXMuc2V0dGluZ3MuY3NzRWZlY3RzW3RoaXMuc2V0dGluZ3MuY2xvc2VFZmZlY3RdLm91dCwgZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXM4LmFjdGl2ZVNsaWRlID0gbnVsbDsKICAgICAgICAgIF90aGlzOC5wcmV2QWN0aXZlU2xpZGVJbmRleCA9IG51bGw7CiAgICAgICAgICBfdGhpczgucHJldkFjdGl2ZVNsaWRlID0gbnVsbDsKICAgICAgICAgIF90aGlzOC5idWlsdCA9IGZhbHNlOwoKICAgICAgICAgIGlmIChfdGhpczguZXZlbnRzKSB7CiAgICAgICAgICAgIGZvciAodmFyIF9rZXkgaW4gX3RoaXM4LmV2ZW50cykgewogICAgICAgICAgICAgIGlmIChfdGhpczguZXZlbnRzLmhhc093blByb3BlcnR5KF9rZXkpKSB7CiAgICAgICAgICAgICAgICBfdGhpczguZXZlbnRzW19rZXldLmRlc3Ryb3koKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIF90aGlzOC5ldmVudHMgPSBudWxsOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBib2R5ID0gZG9jdW1lbnQuYm9keTsKICAgICAgICAgIHJlbW92ZUNsYXNzKGh0bWwsICdnbGlnaHRib3gtb3BlbicpOwogICAgICAgICAgcmVtb3ZlQ2xhc3MoYm9keSwgJ2dsaWdodGJveC1vcGVuIHRvdWNoaW5nIGdkZXNjLW9wZW4gZ2xpZ2h0Ym94LXRvdWNoIGdsaWdodGJveC1tb2JpbGUgZ3Njcm9sbGJhci1maXhlcicpOwoKICAgICAgICAgIF90aGlzOC5tb2RhbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKF90aGlzOC5tb2RhbCk7CgogICAgICAgICAgX3RoaXM4LnRyaWdnZXIoJ2Nsb3NlJyk7CgogICAgICAgICAgaWYgKGlzRnVuY3Rpb24oX3RoaXM4LnNldHRpbmdzLm9uQ2xvc2UpKSB7CiAgICAgICAgICAgIF90aGlzOC5zZXR0aW5ncy5vbkNsb3NlKCk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIHN0eWxlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nY3NzLXN0eWxlcycpOwoKICAgICAgICAgIGlmIChzdHlsZXMpIHsKICAgICAgICAgICAgc3R5bGVzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc3R5bGVzKTsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczgubGlnaHRib3hPcGVuID0gZmFsc2U7CiAgICAgICAgICBfdGhpczguY2xvc2luZyA9IG51bGw7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sIHsKICAgICAga2V5OiAiZGVzdHJveSIsCiAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkgewogICAgICAgIHRoaXMuY2xvc2UoKTsKICAgICAgICB0aGlzLmNsZWFyQWxsRXZlbnRzKCk7CgogICAgICAgIGlmICh0aGlzLmJhc2VFdmVudHMpIHsKICAgICAgICAgIHRoaXMuYmFzZUV2ZW50cy5kZXN0cm95KCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm9uIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uKGV2dCwgY2FsbGJhY2spIHsKICAgICAgICB2YXIgb25jZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CgogICAgICAgIGlmICghZXZ0IHx8ICFpc0Z1bmN0aW9uKGNhbGxiYWNrKSkgewogICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRXZlbnQgbmFtZSBhbmQgY2FsbGJhY2sgbXVzdCBiZSBkZWZpbmVkJyk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmFwaUV2ZW50cy5wdXNoKHsKICAgICAgICAgIGV2dDogZXZ0LAogICAgICAgICAgb25jZTogb25jZSwKICAgICAgICAgIGNhbGxiYWNrOiBjYWxsYmFjawogICAgICAgIH0pOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogIm9uY2UiLAogICAgICB2YWx1ZTogZnVuY3Rpb24gb25jZShldnQsIGNhbGxiYWNrKSB7CiAgICAgICAgdGhpcy5vbihldnQsIGNhbGxiYWNrLCB0cnVlKTsKICAgICAgfQogICAgfSwgewogICAgICBrZXk6ICJ0cmlnZ2VyIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRyaWdnZXIoZXZlbnROYW1lKSB7CiAgICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICAgIHZhciBkYXRhID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBudWxsOwogICAgICAgIHZhciBvbmNlVHJpZ2dlcmVkID0gW107CiAgICAgICAgZWFjaCh0aGlzLmFwaUV2ZW50cywgZnVuY3Rpb24gKGV2ZW50LCBpKSB7CiAgICAgICAgICB2YXIgZXZ0ID0gZXZlbnQuZXZ0LAogICAgICAgICAgICAgIG9uY2UgPSBldmVudC5vbmNlLAogICAgICAgICAgICAgIGNhbGxiYWNrID0gZXZlbnQuY2FsbGJhY2s7CgogICAgICAgICAgaWYgKGV2dCA9PSBldmVudE5hbWUpIHsKICAgICAgICAgICAgY2FsbGJhY2soZGF0YSk7CgogICAgICAgICAgICBpZiAob25jZSkgewogICAgICAgICAgICAgIG9uY2VUcmlnZ2VyZWQucHVzaChpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBpZiAob25jZVRyaWdnZXJlZC5sZW5ndGgpIHsKICAgICAgICAgIGVhY2gob25jZVRyaWdnZXJlZCwgZnVuY3Rpb24gKGkpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzOS5hcGlFdmVudHMuc3BsaWNlKGksIDEpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogImNsZWFyQWxsRXZlbnRzIiwKICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsZWFyQWxsRXZlbnRzKCkgewogICAgICAgIHRoaXMuYXBpRXZlbnRzLnNwbGljZSgwLCB0aGlzLmFwaUV2ZW50cy5sZW5ndGgpOwogICAgICB9CiAgICB9LCB7CiAgICAgIGtleTogInZlcnNpb24iLAogICAgICB2YWx1ZTogZnVuY3Rpb24gdmVyc2lvbigpIHsKICAgICAgICByZXR1cm4gX3ZlcnNpb247CiAgICAgIH0KICAgIH1dKTsKCiAgICByZXR1cm4gR2xpZ2h0Ym94SW5pdDsKICB9KCk7CgogIGZ1bmN0aW9uIGdsaWdodGJveCgpIHsKICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKICAgIHZhciBpbnN0YW5jZSA9IG5ldyBHbGlnaHRib3hJbml0KG9wdGlvbnMpOwogICAgaW5zdGFuY2UuaW5pdCgpOwogICAgcmV0dXJuIGluc3RhbmNlOwogIH0KCiAgcmV0dXJuIGdsaWdodGJveDsKfSk7"},{"version":3,"sources":["C:/Users/multicampus/swfront2/swfront/src/assets/vendor/glightbox/js/glightbox.js"],"names":["global","factory","exports","module","define","amd","self","GLightbox","_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","Array","isArray","_arrayLikeToArray","iter","from","o","minLen","n","toString","call","slice","name","test","len","arr2","uid","Date","now","extend","extended","deep","arguments","merge","prop","hasOwnProperty","each","collection","callback","isNode","window","document","isArrayLike","isObject","size","l","has","getNodeEvents","node","undefined","fn","cache","data","all","evt","found","cl","eventName","addEvent","_ref","onElement","withCallback","_ref$avoidDuplicate","avoidDuplicate","_ref$once","once","_ref$useCapture","useCapture","thisArg","element","isString","querySelectorAll","handler","event","isFunction","destroy","el","events","splice","removeEventListener","addEventListener","push","addClass","split","classList","add","removeClass","remove","hasClass","contains","closest","elem","selector","body","parentElement","matches","msMatchesSelector","animateElement","animation","animationEnd","whichAnimationEvent","animationNames","cssTransform","translate","style","webkitTransform","MozTransform","msTransform","OTransform","transform","show","display","hide","createHTML","htmlStr","frag","createDocumentFragment","temp","createElement","innerHTML","firstChild","appendChild","windowSize","width","innerWidth","documentElement","clientWidth","height","innerHeight","clientHeight","t","animations","OAnimation","MozAnimation","WebkitAnimation","whichTransitionEvent","transitions","transition","OTransition","MozTransition","WebkitTransition","createIframe","config","url","allow","appendTo","iframe","className","src","setAttribute","onload","waitUntil","check","onComplete","delay","timeout","timeoutPointer","intervalPointer","setInterval","clearInterval","clearTimeout","setTimeout","injectAssets","waitFor","isNil","console","error","indexOf","head","getElementsByTagName","headStyles","link","rel","type","href","media","insertBefore","script","isMobile","navigator","userAgent","match","isTouch","createTouch","msMaxTouchPoints","f","s","nodeType","ar","isFinite","keys","k","isNumber","isNaN","parseFloat","keyboardNavigation","keyCode","activeElement","nodeName","toLocaleLowerCase","preventDefault","btns","focused","filter","item","first","querySelector","focus","forEach","tabindex","getAttribute","newIndex","parseInt","next","concat","nextSlide","prevSlide","close","getLen","v","Math","sqrt","x","y","dot","v1","v2","getAngle","mr","r","acos","cross","getRotateAngle","angle","PI","EventsHandlerAdmin","handlers","value","del","dispatch","apply","wrapFunc","EventshandlerAdmin","TouchEvents","option","start","bind","move","end","cancel","preV","pinchStartLen","zoom","isDoubleTap","noop","rotate","touchStart","multipointStart","multipointEnd","pinch","swipe","tap","doubleTap","longTap","singleTap","pressMove","twoFingerPressMove","touchMove","touchEnd","touchCancel","_cancelAllHandler","cancelAll","delta","last","tapTimeout","singleTapTimeout","longTapTimeout","swipeTimeout","x1","x2","y1","y2","preTapPosition","touches","pageX","pageY","abs","_cancelLongTap","_cancelSingleTap","_preventTap","currentX","currentY","sCurrentX","sCurrentY","sx2","deltaX","deltaY","sy2","movedX","movedY","changedTouches","direction","_swipeDirection","on","off","resetSlideMove","slide","transitionEnd","desc","opacity","touchNavigation","winSize","winWidth","winHeight","process","currentSlide","mediaImage","doingMove","initScale","maxScale","currentScale","doingZoom","imageZoomed","zoomedPosX","zoomedPosY","lastZoomedPosX","lastZoomedPosY","hDistance","vDistance","hDistancePercent","vDistancePercent","vSwipe","hSwipe","startCoords","endCoords","xDown","yDown","isInlined","sliderWrapper","getElementById","overlay","touchInstance","e","targetTouches","toLowerCase","parentNode","clientX","clientY","activeSlide","offsetHeight","moved","xUp","yUp","xDiff","yDiff","settings","touchFollowAxis","h","scaleX","scaleY","scale","mhDistance","mvDistance","index","elements","ZoomImages","_this","onclose","img","setZoomEvents","active","zoomedIn","dragging","initialX","initialY","xOffset","yOffset","dragStart","dragEnd","drag","zoomOut","zoomIn","widowWidth","maxWidth","naturalWidth","maxHeight","naturalHeight","centerX","setTranslate","_this2","isDragging","onMove","xPos","yPos","DragSlides","dragEl","_config$toleranceX","toleranceX","_config$toleranceY","toleranceY","_config$slide","_config$instance","lastDirection","toleranceReached","dragContainer","clicked","exludeClicks","doSlideChange","preventOutsideClick","doSlideClose","currentXInt","currentYInt","doChange","shouldChange","dragAutoSnap","doClose","shouldClose","dragDir","lastChild","animated","slideImage","slideMedia","Image","titleID","textID","alt","title","description","slideVideo","slideContainer","videoID","videoPlayers","getAllPlayers","videoWrapper","plyr","css","protocol","location","replace","videoSource","embedID","customPlaceholder","js","vimeoID","exec","youtubeID","getYoutubeID","html","format","pop","sources","mp4","ogg","webm","videoFile","placeholder","playerConfig","player","Plyr","detail","handleMediaFullScreen","slideInline","hash","trim","content","innerContent","container","div","cloned","cloneNode","slideIframe","SlideConfigParser","slideParamas","defaults","descPosition","effect","zoomable","draggable","sourceType","origin","parseConfig","objectData","setSize","val","nodeData","dataset","sanitizeValue","cleanKeys","join","str","regex","RegExp","substring","nodeDesc","slideConfig","defaultWith","checkSize","videosWidth","defaultHeight","Slide","setContent","isMobileDevice","beforeSlideLoad","position","slideTitle","slideText","slideDesc","finalCallback","afterSlideLoad","getSlidePlayerInstance","removeChild","id","moreLength","smallDescription","slideShortDesc","moreText","descriptionEvents","dragToleranceX","dragToleranceY","offsetWidth","resize","string","wordBoundary","cleanedString","innerText","useWordBoundary","subString","substr","moreLink","shortEvent","create","slideHTML","getConfig","parser","slideExtraAttributes","_version","isMobile$1","isTouch$1","skin","theme","closeButton","startAt","autoplayVideos","autofocusVideos","beforeSlideChange","afterSlideChange","slideInserted","slideRemoved","onOpen","onClose","loop","preload","oneSlidePerOpen","closeOnOutsideClick","plugins","ratio","fullscreen","enabled","iosNative","youtube","noCookie","showinfo","iv_load_policy","vimeo","byline","portrait","transparent","openEffect","closeEffect","slideEffect","cssEfects","fade","out","slideBack","none","svg","prev","lightboxHTML","GlightboxInit","options","effectsClasses","getAnimationClasses","apiEvents","fullElementsList","init","getSelector","baseEvents","open","getElements","prevActiveSlideIndex","prevActiveSlide","gallery","getGalleryElements","getElementIndex","build","scrollBar","styleSheet","showSlide","prevButton","nextButton","lightboxOpen","trigger","openAt","loader","current","slidesContainer","slideAnimateOut","slideNode","slideAnimateIn","slideData","slideIndex","slideDescription","slideDescriptionContained","preloadSlide","updateNavigationClasses","_this3","goToSlide","insertSlide","slideInfo","newSlide","totalSlides","addedSlideNode","addedSlidePlayer","existingSlide","removeSlide","getActiveSlideIndex","_this4","prevData","nextData","slidePlayerPlay","effectName","animIn","animOut","slidePlayerPause","stopSlideVideo","log","playing","pause","playSlideVideo","play","setElements","_this5","newElements","_this6","list","elData","nodes","getActiveSlide","effects","_this7","built","nextSVG","prevSVG","closeSVG","modal","video","image","descriptionResize","imgNode","descHeight","_imgNode","videoRatio","floor","vwidth","vheight","_ratio","vsize","reload","loopAtEnd","_this8","closing","_key","styles","clearAllEvents","_this9","onceTriggered","version","glightbox"],"mappings":"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","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.GLightbox = factory());\n}(this, (function () { 'use strict';\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n  }\n\n  function _iterableToArray(iter) {\n    if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n  }\n\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var uid = Date.now();\n  function extend() {\n    var extended = {};\n    var deep = true;\n    var i = 0;\n    var length = arguments.length;\n\n    if (Object.prototype.toString.call(arguments[0]) === '[object Boolean]') {\n      deep = arguments[0];\n      i++;\n    }\n\n    var merge = function merge(obj) {\n      for (var prop in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n          if (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n            extended[prop] = extend(true, extended[prop], obj[prop]);\n          } else {\n            extended[prop] = obj[prop];\n          }\n        }\n      }\n    };\n\n    for (; i < length; i++) {\n      var obj = arguments[i];\n      merge(obj);\n    }\n\n    return extended;\n  }\n  function each(collection, callback) {\n    if (isNode(collection) || collection === window || collection === document) {\n      collection = [collection];\n    }\n\n    if (!isArrayLike(collection) && !isObject(collection)) {\n      collection = [collection];\n    }\n\n    if (size(collection) == 0) {\n      return;\n    }\n\n    if (isArrayLike(collection) && !isObject(collection)) {\n      var l = collection.length,\n          i = 0;\n\n      for (; i < l; i++) {\n        if (callback.call(collection[i], collection[i], i, collection) === false) {\n          break;\n        }\n      }\n    } else if (isObject(collection)) {\n      for (var key in collection) {\n        if (has(collection, key)) {\n          if (callback.call(collection[key], collection[key], key, collection) === false) {\n            break;\n          }\n        }\n      }\n    }\n  }\n  function getNodeEvents(node) {\n    var name = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var fn = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var cache = node[uid] = node[uid] || [];\n    var data = {\n      all: cache,\n      evt: null,\n      found: null\n    };\n\n    if (name && fn && size(cache) > 0) {\n      each(cache, function (cl, i) {\n        if (cl.eventName == name && cl.fn.toString() == fn.toString()) {\n          data.found = true;\n          data.evt = i;\n          return false;\n        }\n      });\n    }\n\n    return data;\n  }\n  function addEvent(eventName) {\n    var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n        onElement = _ref.onElement,\n        withCallback = _ref.withCallback,\n        _ref$avoidDuplicate = _ref.avoidDuplicate,\n        avoidDuplicate = _ref$avoidDuplicate === void 0 ? true : _ref$avoidDuplicate,\n        _ref$once = _ref.once,\n        once = _ref$once === void 0 ? false : _ref$once,\n        _ref$useCapture = _ref.useCapture,\n        useCapture = _ref$useCapture === void 0 ? false : _ref$useCapture;\n\n    var thisArg = arguments.length > 2 ? arguments[2] : undefined;\n    var element = onElement || [];\n\n    if (isString(element)) {\n      element = document.querySelectorAll(element);\n    }\n\n    function handler(event) {\n      if (isFunction(withCallback)) {\n        withCallback.call(thisArg, event, this);\n      }\n\n      if (once) {\n        handler.destroy();\n      }\n    }\n\n    handler.destroy = function () {\n      each(element, function (el) {\n        var events = getNodeEvents(el, eventName, handler);\n\n        if (events.found) {\n          events.all.splice(events.evt, 1);\n        }\n\n        if (el.removeEventListener) {\n          el.removeEventListener(eventName, handler, useCapture);\n        }\n      });\n    };\n\n    each(element, function (el) {\n      var events = getNodeEvents(el, eventName, handler);\n\n      if (el.addEventListener && avoidDuplicate && !events.found || !avoidDuplicate) {\n        el.addEventListener(eventName, handler, useCapture);\n        events.all.push({\n          eventName: eventName,\n          fn: handler\n        });\n      }\n    });\n    return handler;\n  }\n  function addClass(node, name) {\n    each(name.split(' '), function (cl) {\n      return node.classList.add(cl);\n    });\n  }\n  function removeClass(node, name) {\n    each(name.split(' '), function (cl) {\n      return node.classList.remove(cl);\n    });\n  }\n  function hasClass(node, name) {\n    return node.classList.contains(name);\n  }\n  function closest(elem, selector) {\n    while (elem !== document.body) {\n      elem = elem.parentElement;\n\n      if (!elem) {\n        return false;\n      }\n\n      var matches = typeof elem.matches == 'function' ? elem.matches(selector) : elem.msMatchesSelector(selector);\n\n      if (matches) {\n        return elem;\n      }\n    }\n  }\n  function animateElement(element) {\n    var animation = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    var callback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n    if (!element || animation === '') {\n      return false;\n    }\n\n    if (animation == 'none') {\n      if (isFunction(callback)) {\n        callback();\n      }\n\n      return false;\n    }\n\n    var animationEnd = whichAnimationEvent();\n    var animationNames = animation.split(' ');\n    each(animationNames, function (name) {\n      addClass(element, 'g' + name);\n    });\n    addEvent(animationEnd, {\n      onElement: element,\n      avoidDuplicate: false,\n      once: true,\n      withCallback: function withCallback(event, target) {\n        each(animationNames, function (name) {\n          removeClass(target, 'g' + name);\n        });\n\n        if (isFunction(callback)) {\n          callback();\n        }\n      }\n    });\n  }\n  function cssTransform(node) {\n    var translate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n    if (translate == '') {\n      node.style.webkitTransform = '';\n      node.style.MozTransform = '';\n      node.style.msTransform = '';\n      node.style.OTransform = '';\n      node.style.transform = '';\n      return false;\n    }\n\n    node.style.webkitTransform = translate;\n    node.style.MozTransform = translate;\n    node.style.msTransform = translate;\n    node.style.OTransform = translate;\n    node.style.transform = translate;\n  }\n  function show(element) {\n    element.style.display = 'block';\n  }\n  function hide(element) {\n    element.style.display = 'none';\n  }\n  function createHTML(htmlStr) {\n    var frag = document.createDocumentFragment(),\n        temp = document.createElement('div');\n    temp.innerHTML = htmlStr;\n\n    while (temp.firstChild) {\n      frag.appendChild(temp.firstChild);\n    }\n\n    return frag;\n  }\n  function windowSize() {\n    return {\n      width: window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,\n      height: window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight\n    };\n  }\n  function whichAnimationEvent() {\n    var t,\n        el = document.createElement('fakeelement');\n    var animations = {\n      animation: 'animationend',\n      OAnimation: 'oAnimationEnd',\n      MozAnimation: 'animationend',\n      WebkitAnimation: 'webkitAnimationEnd'\n    };\n\n    for (t in animations) {\n      if (el.style[t] !== undefined) {\n        return animations[t];\n      }\n    }\n  }\n  function whichTransitionEvent() {\n    var t,\n        el = document.createElement('fakeelement');\n    var transitions = {\n      transition: 'transitionend',\n      OTransition: 'oTransitionEnd',\n      MozTransition: 'transitionend',\n      WebkitTransition: 'webkitTransitionEnd'\n    };\n\n    for (t in transitions) {\n      if (el.style[t] !== undefined) {\n        return transitions[t];\n      }\n    }\n  }\n  function createIframe(config) {\n    var url = config.url,\n        allow = config.allow,\n        callback = config.callback,\n        appendTo = config.appendTo;\n    var iframe = document.createElement('iframe');\n    iframe.className = 'vimeo-video gvideo';\n    iframe.src = url;\n    iframe.style.width = '100%';\n    iframe.style.height = '100%';\n\n    if (allow) {\n      iframe.setAttribute('allow', allow);\n    }\n\n    iframe.onload = function () {\n      addClass(iframe, 'node-ready');\n\n      if (isFunction(callback)) {\n        callback();\n      }\n    };\n\n    if (appendTo) {\n      appendTo.appendChild(iframe);\n    }\n\n    return iframe;\n  }\n  function waitUntil(check, onComplete, delay, timeout) {\n    if (check()) {\n      onComplete();\n      return;\n    }\n\n    if (!delay) {\n      delay = 100;\n    }\n\n    var timeoutPointer;\n    var intervalPointer = setInterval(function () {\n      if (!check()) {\n        return;\n      }\n\n      clearInterval(intervalPointer);\n\n      if (timeoutPointer) {\n        clearTimeout(timeoutPointer);\n      }\n\n      onComplete();\n    }, delay);\n\n    if (timeout) {\n      timeoutPointer = setTimeout(function () {\n        clearInterval(intervalPointer);\n      }, timeout);\n    }\n  }\n  function injectAssets(url, waitFor, callback) {\n    if (isNil(url)) {\n      console.error('Inject assets error');\n      return;\n    }\n\n    if (isFunction(waitFor)) {\n      callback = waitFor;\n      waitFor = false;\n    }\n\n    if (isString(waitFor) && waitFor in window) {\n      if (isFunction(callback)) {\n        callback();\n      }\n\n      return;\n    }\n\n    var found;\n\n    if (url.indexOf('.css') !== -1) {\n      found = document.querySelectorAll('link[href=\"' + url + '\"]');\n\n      if (found && found.length > 0) {\n        if (isFunction(callback)) {\n          callback();\n        }\n\n        return;\n      }\n\n      var head = document.getElementsByTagName('head')[0];\n      var headStyles = head.querySelectorAll('link[rel=\"stylesheet\"]');\n      var link = document.createElement('link');\n      link.rel = 'stylesheet';\n      link.type = 'text/css';\n      link.href = url;\n      link.media = 'all';\n\n      if (headStyles) {\n        head.insertBefore(link, headStyles[0]);\n      } else {\n        head.appendChild(link);\n      }\n\n      if (isFunction(callback)) {\n        callback();\n      }\n\n      return;\n    }\n\n    found = document.querySelectorAll('script[src=\"' + url + '\"]');\n\n    if (found && found.length > 0) {\n      if (isFunction(callback)) {\n        if (isString(waitFor)) {\n          waitUntil(function () {\n            return typeof window[waitFor] !== 'undefined';\n          }, function () {\n            callback();\n          });\n          return false;\n        }\n\n        callback();\n      }\n\n      return;\n    }\n\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = url;\n\n    script.onload = function () {\n      if (isFunction(callback)) {\n        if (isString(waitFor)) {\n          waitUntil(function () {\n            return typeof window[waitFor] !== 'undefined';\n          }, function () {\n            callback();\n          });\n          return false;\n        }\n\n        callback();\n      }\n    };\n\n    document.body.appendChild(script);\n    return;\n  }\n  function isMobile() {\n    return 'navigator' in window && window.navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(Android)|(PlayBook)|(BB10)|(BlackBerry)|(Opera Mini)|(IEMobile)|(webOS)|(MeeGo)/i);\n  }\n  function isTouch() {\n    return isMobile() !== null || document.createTouch !== undefined || 'ontouchstart' in window || 'onmsgesturechange' in window || navigator.msMaxTouchPoints;\n  }\n  function isFunction(f) {\n    return typeof f === 'function';\n  }\n  function isString(s) {\n    return typeof s === 'string';\n  }\n  function isNode(el) {\n    return !!(el && el.nodeType && el.nodeType == 1);\n  }\n  function isArray(ar) {\n    return Array.isArray(ar);\n  }\n  function isArrayLike(ar) {\n    return ar && ar.length && isFinite(ar.length);\n  }\n  function isObject(o) {\n    var type = _typeof(o);\n\n    return type === 'object' && o != null && !isFunction(o) && !isArray(o);\n  }\n  function isNil(o) {\n    return o == null;\n  }\n  function has(obj, key) {\n    return obj !== null && hasOwnProperty.call(obj, key);\n  }\n  function size(o) {\n    if (isObject(o)) {\n      if (o.keys) {\n        return o.keys().length;\n      }\n\n      var l = 0;\n\n      for (var k in o) {\n        if (has(o, k)) {\n          l++;\n        }\n      }\n\n      return l;\n    } else {\n      return o.length;\n    }\n  }\n  function isNumber(n) {\n    return !isNaN(parseFloat(n)) && isFinite(n);\n  }\n\n  function keyboardNavigation(instance) {\n    if (instance.events.hasOwnProperty('keyboard')) {\n      return false;\n    }\n\n    instance.events['keyboard'] = addEvent('keydown', {\n      onElement: window,\n      withCallback: function withCallback(event, target) {\n        event = event || window.event;\n        var key = event.keyCode;\n\n        if (key == 9) {\n          var activeElement = document.activeElement && document.activeElement.nodeName ? document.activeElement.nodeName.toLocaleLowerCase() : false;\n\n          if (activeElement == 'input' || activeElement == 'textarea' || activeElement == 'button') {\n            return;\n          }\n\n          event.preventDefault();\n          var btns = document.querySelectorAll('.gbtn');\n\n          if (!btns || btns.length <= 0) {\n            return;\n          }\n\n          var focused = _toConsumableArray(btns).filter(function (item) {\n            return hasClass(item, 'focused');\n          });\n\n          if (!focused.length) {\n            var first = document.querySelector('.gbtn[tabindex=\"0\"]');\n\n            if (first) {\n              first.focus();\n              addClass(first, 'focused');\n            }\n\n            return;\n          }\n\n          btns.forEach(function (element) {\n            return removeClass(element, 'focused');\n          });\n          var tabindex = focused[0].getAttribute('tabindex');\n          tabindex = tabindex ? tabindex : '0';\n          var newIndex = parseInt(tabindex) + 1;\n\n          if (newIndex > btns.length - 1) {\n            newIndex = '0';\n          }\n\n          var next = document.querySelector(\".gbtn[tabindex=\\\"\".concat(newIndex, \"\\\"]\"));\n\n          if (next) {\n            next.focus();\n            addClass(next, 'focused');\n          }\n        }\n\n        if (key == 39) {\n          instance.nextSlide();\n        }\n\n        if (key == 37) {\n          instance.prevSlide();\n        }\n\n        if (key == 27) {\n          instance.close();\n        }\n      }\n    });\n  }\n\n  function getLen(v) {\n    return Math.sqrt(v.x * v.x + v.y * v.y);\n  }\n\n  function dot(v1, v2) {\n    return v1.x * v2.x + v1.y * v2.y;\n  }\n\n  function getAngle(v1, v2) {\n    var mr = getLen(v1) * getLen(v2);\n\n    if (mr === 0) {\n      return 0;\n    }\n\n    var r = dot(v1, v2) / mr;\n\n    if (r > 1) {\n      r = 1;\n    }\n\n    return Math.acos(r);\n  }\n\n  function cross(v1, v2) {\n    return v1.x * v2.y - v2.x * v1.y;\n  }\n\n  function getRotateAngle(v1, v2) {\n    var angle = getAngle(v1, v2);\n\n    if (cross(v1, v2) > 0) {\n      angle *= -1;\n    }\n\n    return angle * 180 / Math.PI;\n  }\n\n  var EventsHandlerAdmin = function () {\n    function EventsHandlerAdmin(el) {\n      _classCallCheck(this, EventsHandlerAdmin);\n\n      this.handlers = [];\n      this.el = el;\n    }\n\n    _createClass(EventsHandlerAdmin, [{\n      key: \"add\",\n      value: function add(handler) {\n        this.handlers.push(handler);\n      }\n    }, {\n      key: \"del\",\n      value: function del(handler) {\n        if (!handler) {\n          this.handlers = [];\n        }\n\n        for (var i = this.handlers.length; i >= 0; i--) {\n          if (this.handlers[i] === handler) {\n            this.handlers.splice(i, 1);\n          }\n        }\n      }\n    }, {\n      key: \"dispatch\",\n      value: function dispatch() {\n        for (var i = 0, len = this.handlers.length; i < len; i++) {\n          var handler = this.handlers[i];\n\n          if (typeof handler === 'function') {\n            handler.apply(this.el, arguments);\n          }\n        }\n      }\n    }]);\n\n    return EventsHandlerAdmin;\n  }();\n\n  function wrapFunc(el, handler) {\n    var EventshandlerAdmin = new EventsHandlerAdmin(el);\n    EventshandlerAdmin.add(handler);\n    return EventshandlerAdmin;\n  }\n\n  var TouchEvents = function () {\n    function TouchEvents(el, option) {\n      _classCallCheck(this, TouchEvents);\n\n      this.element = typeof el == 'string' ? document.querySelector(el) : el;\n      this.start = this.start.bind(this);\n      this.move = this.move.bind(this);\n      this.end = this.end.bind(this);\n      this.cancel = this.cancel.bind(this);\n      this.element.addEventListener('touchstart', this.start, false);\n      this.element.addEventListener('touchmove', this.move, false);\n      this.element.addEventListener('touchend', this.end, false);\n      this.element.addEventListener('touchcancel', this.cancel, false);\n      this.preV = {\n        x: null,\n        y: null\n      };\n      this.pinchStartLen = null;\n      this.zoom = 1;\n      this.isDoubleTap = false;\n\n      var noop = function noop() {};\n\n      this.rotate = wrapFunc(this.element, option.rotate || noop);\n      this.touchStart = wrapFunc(this.element, option.touchStart || noop);\n      this.multipointStart = wrapFunc(this.element, option.multipointStart || noop);\n      this.multipointEnd = wrapFunc(this.element, option.multipointEnd || noop);\n      this.pinch = wrapFunc(this.element, option.pinch || noop);\n      this.swipe = wrapFunc(this.element, option.swipe || noop);\n      this.tap = wrapFunc(this.element, option.tap || noop);\n      this.doubleTap = wrapFunc(this.element, option.doubleTap || noop);\n      this.longTap = wrapFunc(this.element, option.longTap || noop);\n      this.singleTap = wrapFunc(this.element, option.singleTap || noop);\n      this.pressMove = wrapFunc(this.element, option.pressMove || noop);\n      this.twoFingerPressMove = wrapFunc(this.element, option.twoFingerPressMove || noop);\n      this.touchMove = wrapFunc(this.element, option.touchMove || noop);\n      this.touchEnd = wrapFunc(this.element, option.touchEnd || noop);\n      this.touchCancel = wrapFunc(this.element, option.touchCancel || noop);\n      this._cancelAllHandler = this.cancelAll.bind(this);\n      window.addEventListener('scroll', this._cancelAllHandler);\n      this.delta = null;\n      this.last = null;\n      this.now = null;\n      this.tapTimeout = null;\n      this.singleTapTimeout = null;\n      this.longTapTimeout = null;\n      this.swipeTimeout = null;\n      this.x1 = this.x2 = this.y1 = this.y2 = null;\n      this.preTapPosition = {\n        x: null,\n        y: null\n      };\n    }\n\n    _createClass(TouchEvents, [{\n      key: \"start\",\n      value: function start(evt) {\n        if (!evt.touches) {\n          return;\n        }\n\n        this.now = Date.now();\n        this.x1 = evt.touches[0].pageX;\n        this.y1 = evt.touches[0].pageY;\n        this.delta = this.now - (this.last || this.now);\n        this.touchStart.dispatch(evt, this.element);\n\n        if (this.preTapPosition.x !== null) {\n          this.isDoubleTap = this.delta > 0 && this.delta <= 250 && Math.abs(this.preTapPosition.x - this.x1) < 30 && Math.abs(this.preTapPosition.y - this.y1) < 30;\n\n          if (this.isDoubleTap) {\n            clearTimeout(this.singleTapTimeout);\n          }\n        }\n\n        this.preTapPosition.x = this.x1;\n        this.preTapPosition.y = this.y1;\n        this.last = this.now;\n        var preV = this.preV,\n            len = evt.touches.length;\n\n        if (len > 1) {\n          this._cancelLongTap();\n\n          this._cancelSingleTap();\n\n          var v = {\n            x: evt.touches[1].pageX - this.x1,\n            y: evt.touches[1].pageY - this.y1\n          };\n          preV.x = v.x;\n          preV.y = v.y;\n          this.pinchStartLen = getLen(preV);\n          this.multipointStart.dispatch(evt, this.element);\n        }\n\n        this._preventTap = false;\n        this.longTapTimeout = setTimeout(function () {\n          this.longTap.dispatch(evt, this.element);\n          this._preventTap = true;\n        }.bind(this), 750);\n      }\n    }, {\n      key: \"move\",\n      value: function move(evt) {\n        if (!evt.touches) {\n          return;\n        }\n\n        var preV = this.preV,\n            len = evt.touches.length,\n            currentX = evt.touches[0].pageX,\n            currentY = evt.touches[0].pageY;\n        this.isDoubleTap = false;\n\n        if (len > 1) {\n          var sCurrentX = evt.touches[1].pageX,\n              sCurrentY = evt.touches[1].pageY;\n          var v = {\n            x: evt.touches[1].pageX - currentX,\n            y: evt.touches[1].pageY - currentY\n          };\n\n          if (preV.x !== null) {\n            if (this.pinchStartLen > 0) {\n              evt.zoom = getLen(v) / this.pinchStartLen;\n              this.pinch.dispatch(evt, this.element);\n            }\n\n            evt.angle = getRotateAngle(v, preV);\n            this.rotate.dispatch(evt, this.element);\n          }\n\n          preV.x = v.x;\n          preV.y = v.y;\n\n          if (this.x2 !== null && this.sx2 !== null) {\n            evt.deltaX = (currentX - this.x2 + sCurrentX - this.sx2) / 2;\n            evt.deltaY = (currentY - this.y2 + sCurrentY - this.sy2) / 2;\n          } else {\n            evt.deltaX = 0;\n            evt.deltaY = 0;\n          }\n\n          this.twoFingerPressMove.dispatch(evt, this.element);\n          this.sx2 = sCurrentX;\n          this.sy2 = sCurrentY;\n        } else {\n          if (this.x2 !== null) {\n            evt.deltaX = currentX - this.x2;\n            evt.deltaY = currentY - this.y2;\n            var movedX = Math.abs(this.x1 - this.x2),\n                movedY = Math.abs(this.y1 - this.y2);\n\n            if (movedX > 10 || movedY > 10) {\n              this._preventTap = true;\n            }\n          } else {\n            evt.deltaX = 0;\n            evt.deltaY = 0;\n          }\n\n          this.pressMove.dispatch(evt, this.element);\n        }\n\n        this.touchMove.dispatch(evt, this.element);\n\n        this._cancelLongTap();\n\n        this.x2 = currentX;\n        this.y2 = currentY;\n\n        if (len > 1) {\n          evt.preventDefault();\n        }\n      }\n    }, {\n      key: \"end\",\n      value: function end(evt) {\n        if (!evt.changedTouches) {\n          return;\n        }\n\n        this._cancelLongTap();\n\n        var self = this;\n\n        if (evt.touches.length < 2) {\n          this.multipointEnd.dispatch(evt, this.element);\n          this.sx2 = this.sy2 = null;\n        }\n\n        if (this.x2 && Math.abs(this.x1 - this.x2) > 30 || this.y2 && Math.abs(this.y1 - this.y2) > 30) {\n          evt.direction = this._swipeDirection(this.x1, this.x2, this.y1, this.y2);\n          this.swipeTimeout = setTimeout(function () {\n            self.swipe.dispatch(evt, self.element);\n          }, 0);\n        } else {\n          this.tapTimeout = setTimeout(function () {\n            if (!self._preventTap) {\n              self.tap.dispatch(evt, self.element);\n            }\n\n            if (self.isDoubleTap) {\n              self.doubleTap.dispatch(evt, self.element);\n              self.isDoubleTap = false;\n            }\n          }, 0);\n\n          if (!self.isDoubleTap) {\n            self.singleTapTimeout = setTimeout(function () {\n              self.singleTap.dispatch(evt, self.element);\n            }, 250);\n          }\n        }\n\n        this.touchEnd.dispatch(evt, this.element);\n        this.preV.x = 0;\n        this.preV.y = 0;\n        this.zoom = 1;\n        this.pinchStartLen = null;\n        this.x1 = this.x2 = this.y1 = this.y2 = null;\n      }\n    }, {\n      key: \"cancelAll\",\n      value: function cancelAll() {\n        this._preventTap = true;\n        clearTimeout(this.singleTapTimeout);\n        clearTimeout(this.tapTimeout);\n        clearTimeout(this.longTapTimeout);\n        clearTimeout(this.swipeTimeout);\n      }\n    }, {\n      key: \"cancel\",\n      value: function cancel(evt) {\n        this.cancelAll();\n        this.touchCancel.dispatch(evt, this.element);\n      }\n    }, {\n      key: \"_cancelLongTap\",\n      value: function _cancelLongTap() {\n        clearTimeout(this.longTapTimeout);\n      }\n    }, {\n      key: \"_cancelSingleTap\",\n      value: function _cancelSingleTap() {\n        clearTimeout(this.singleTapTimeout);\n      }\n    }, {\n      key: \"_swipeDirection\",\n      value: function _swipeDirection(x1, x2, y1, y2) {\n        return Math.abs(x1 - x2) >= Math.abs(y1 - y2) ? x1 - x2 > 0 ? 'Left' : 'Right' : y1 - y2 > 0 ? 'Up' : 'Down';\n      }\n    }, {\n      key: \"on\",\n      value: function on(evt, handler) {\n        if (this[evt]) {\n          this[evt].add(handler);\n        }\n      }\n    }, {\n      key: \"off\",\n      value: function off(evt, handler) {\n        if (this[evt]) {\n          this[evt].del(handler);\n        }\n      }\n    }, {\n      key: \"destroy\",\n      value: function destroy() {\n        if (this.singleTapTimeout) {\n          clearTimeout(this.singleTapTimeout);\n        }\n\n        if (this.tapTimeout) {\n          clearTimeout(this.tapTimeout);\n        }\n\n        if (this.longTapTimeout) {\n          clearTimeout(this.longTapTimeout);\n        }\n\n        if (this.swipeTimeout) {\n          clearTimeout(this.swipeTimeout);\n        }\n\n        this.element.removeEventListener('touchstart', this.start);\n        this.element.removeEventListener('touchmove', this.move);\n        this.element.removeEventListener('touchend', this.end);\n        this.element.removeEventListener('touchcancel', this.cancel);\n        this.rotate.del();\n        this.touchStart.del();\n        this.multipointStart.del();\n        this.multipointEnd.del();\n        this.pinch.del();\n        this.swipe.del();\n        this.tap.del();\n        this.doubleTap.del();\n        this.longTap.del();\n        this.singleTap.del();\n        this.pressMove.del();\n        this.twoFingerPressMove.del();\n        this.touchMove.del();\n        this.touchEnd.del();\n        this.touchCancel.del();\n        this.preV = this.pinchStartLen = this.zoom = this.isDoubleTap = this.delta = this.last = this.now = this.tapTimeout = this.singleTapTimeout = this.longTapTimeout = this.swipeTimeout = this.x1 = this.x2 = this.y1 = this.y2 = this.preTapPosition = this.rotate = this.touchStart = this.multipointStart = this.multipointEnd = this.pinch = this.swipe = this.tap = this.doubleTap = this.longTap = this.singleTap = this.pressMove = this.touchMove = this.touchEnd = this.touchCancel = this.twoFingerPressMove = null;\n        window.removeEventListener('scroll', this._cancelAllHandler);\n        return null;\n      }\n    }]);\n\n    return TouchEvents;\n  }();\n\n  function resetSlideMove(slide) {\n    var transitionEnd = whichTransitionEvent();\n    var media = hasClass(slide, 'gslide-media') ? slide : slide.querySelector('.gslide-media');\n    var desc = slide.querySelector('.gslide-description');\n    addClass(media, 'greset');\n    cssTransform(media, 'translate3d(0, 0, 0)');\n    addEvent(transitionEnd, {\n      onElement: media,\n      once: true,\n      withCallback: function withCallback(event, target) {\n        removeClass(media, 'greset');\n      }\n    });\n    media.style.opacity = '';\n\n    if (desc) {\n      desc.style.opacity = '';\n    }\n  }\n\n  function touchNavigation(instance) {\n    if (instance.events.hasOwnProperty('touch')) {\n      return false;\n    }\n\n    var winSize = windowSize();\n    var winWidth = winSize.width;\n    var winHeight = winSize.height;\n    var process = false;\n    var currentSlide = null;\n    var media = null;\n    var mediaImage = null;\n    var doingMove = false;\n    var initScale = 1;\n    var maxScale = 4.5;\n    var currentScale = 1;\n    var doingZoom = false;\n    var imageZoomed = false;\n    var zoomedPosX = null;\n    var zoomedPosY = null;\n    var lastZoomedPosX = null;\n    var lastZoomedPosY = null;\n    var hDistance;\n    var vDistance;\n    var hDistancePercent = 0;\n    var vDistancePercent = 0;\n    var vSwipe = false;\n    var hSwipe = false;\n    var startCoords = {};\n    var endCoords = {};\n    var xDown = 0;\n    var yDown = 0;\n    var isInlined;\n    var sliderWrapper = document.getElementById('glightbox-slider');\n    var overlay = document.querySelector('.goverlay');\n    var touchInstance = new TouchEvents(sliderWrapper, {\n      touchStart: function touchStart(e) {\n        process = true;\n\n        if (hasClass(e.targetTouches[0].target, 'ginner-container') || closest(e.targetTouches[0].target, '.gslide-desc') || e.targetTouches[0].target.nodeName.toLowerCase() == 'a') {\n          process = false;\n        }\n\n        if (closest(e.targetTouches[0].target, '.gslide-inline') && !hasClass(e.targetTouches[0].target.parentNode, 'gslide-inline')) {\n          process = false;\n        }\n\n        if (process) {\n          endCoords = e.targetTouches[0];\n          startCoords.pageX = e.targetTouches[0].pageX;\n          startCoords.pageY = e.targetTouches[0].pageY;\n          xDown = e.targetTouches[0].clientX;\n          yDown = e.targetTouches[0].clientY;\n          currentSlide = instance.activeSlide;\n          media = currentSlide.querySelector('.gslide-media');\n          isInlined = currentSlide.querySelector('.gslide-inline');\n          mediaImage = null;\n\n          if (hasClass(media, 'gslide-image')) {\n            mediaImage = media.querySelector('img');\n          }\n\n          removeClass(overlay, 'greset');\n\n          if (e.pageX > 20 && e.pageX < window.innerWidth - 20) {\n            return;\n          }\n\n          e.preventDefault();\n        }\n      },\n      touchMove: function touchMove(e) {\n        if (!process) {\n          return;\n        }\n\n        endCoords = e.targetTouches[0];\n\n        if (doingZoom || imageZoomed) {\n          return;\n        }\n\n        if (isInlined && isInlined.offsetHeight > winHeight) {\n          var moved = startCoords.pageX - endCoords.pageX;\n\n          if (Math.abs(moved) <= 13) {\n            return false;\n          }\n        }\n\n        doingMove = true;\n        var xUp = e.targetTouches[0].clientX;\n        var yUp = e.targetTouches[0].clientY;\n        var xDiff = xDown - xUp;\n        var yDiff = yDown - yUp;\n\n        if (Math.abs(xDiff) > Math.abs(yDiff)) {\n          vSwipe = false;\n          hSwipe = true;\n        } else {\n          hSwipe = false;\n          vSwipe = true;\n        }\n\n        hDistance = endCoords.pageX - startCoords.pageX;\n        hDistancePercent = hDistance * 100 / winWidth;\n        vDistance = endCoords.pageY - startCoords.pageY;\n        vDistancePercent = vDistance * 100 / winHeight;\n        var opacity;\n\n        if (vSwipe && mediaImage) {\n          opacity = 1 - Math.abs(vDistance) / winHeight;\n          overlay.style.opacity = opacity;\n\n          if (instance.settings.touchFollowAxis) {\n            hDistancePercent = 0;\n          }\n        }\n\n        if (hSwipe) {\n          opacity = 1 - Math.abs(hDistance) / winWidth;\n          media.style.opacity = opacity;\n\n          if (instance.settings.touchFollowAxis) {\n            vDistancePercent = 0;\n          }\n        }\n\n        if (!mediaImage) {\n          return cssTransform(media, \"translate3d(\".concat(hDistancePercent, \"%, 0, 0)\"));\n        }\n\n        cssTransform(media, \"translate3d(\".concat(hDistancePercent, \"%, \").concat(vDistancePercent, \"%, 0)\"));\n      },\n      touchEnd: function touchEnd() {\n        if (!process) {\n          return;\n        }\n\n        doingMove = false;\n\n        if (imageZoomed || doingZoom) {\n          lastZoomedPosX = zoomedPosX;\n          lastZoomedPosY = zoomedPosY;\n          return;\n        }\n\n        var v = Math.abs(parseInt(vDistancePercent));\n        var h = Math.abs(parseInt(hDistancePercent));\n\n        if (v > 29 && mediaImage) {\n          instance.close();\n          return;\n        }\n\n        if (v < 29 && h < 25) {\n          addClass(overlay, 'greset');\n          overlay.style.opacity = 1;\n          return resetSlideMove(media);\n        }\n      },\n      multipointEnd: function multipointEnd() {\n        setTimeout(function () {\n          doingZoom = false;\n        }, 50);\n      },\n      multipointStart: function multipointStart() {\n        doingZoom = true;\n        initScale = currentScale ? currentScale : 1;\n      },\n      pinch: function pinch(evt) {\n        if (!mediaImage || doingMove) {\n          return false;\n        }\n\n        doingZoom = true;\n        mediaImage.scaleX = mediaImage.scaleY = initScale * evt.zoom;\n        var scale = initScale * evt.zoom;\n        imageZoomed = true;\n\n        if (scale <= 1) {\n          imageZoomed = false;\n          scale = 1;\n          lastZoomedPosY = null;\n          lastZoomedPosX = null;\n          zoomedPosX = null;\n          zoomedPosY = null;\n          mediaImage.setAttribute('style', '');\n          return;\n        }\n\n        if (scale > maxScale) {\n          scale = maxScale;\n        }\n\n        mediaImage.style.transform = \"scale3d(\".concat(scale, \", \").concat(scale, \", 1)\");\n        currentScale = scale;\n      },\n      pressMove: function pressMove(e) {\n        if (imageZoomed && !doingZoom) {\n          var mhDistance = endCoords.pageX - startCoords.pageX;\n          var mvDistance = endCoords.pageY - startCoords.pageY;\n\n          if (lastZoomedPosX) {\n            mhDistance = mhDistance + lastZoomedPosX;\n          }\n\n          if (lastZoomedPosY) {\n            mvDistance = mvDistance + lastZoomedPosY;\n          }\n\n          zoomedPosX = mhDistance;\n          zoomedPosY = mvDistance;\n          var style = \"translate3d(\".concat(mhDistance, \"px, \").concat(mvDistance, \"px, 0)\");\n\n          if (currentScale) {\n            style += \" scale3d(\".concat(currentScale, \", \").concat(currentScale, \", 1)\");\n          }\n\n          cssTransform(mediaImage, style);\n        }\n      },\n      swipe: function swipe(evt) {\n        if (imageZoomed) {\n          return;\n        }\n\n        if (doingZoom) {\n          doingZoom = false;\n          return;\n        }\n\n        if (evt.direction == 'Left') {\n          if (instance.index == instance.elements.length - 1) {\n            return resetSlideMove(media);\n          }\n\n          instance.nextSlide();\n        }\n\n        if (evt.direction == 'Right') {\n          if (instance.index == 0) {\n            return resetSlideMove(media);\n          }\n\n          instance.prevSlide();\n        }\n      }\n    });\n    instance.events['touch'] = touchInstance;\n  }\n\n  var ZoomImages = function () {\n    function ZoomImages(el, slide) {\n      var _this = this;\n\n      var onclose = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      _classCallCheck(this, ZoomImages);\n\n      this.img = el;\n      this.slide = slide;\n      this.onclose = onclose;\n\n      if (this.img.setZoomEvents) {\n        return false;\n      }\n\n      this.active = false;\n      this.zoomedIn = false;\n      this.dragging = false;\n      this.currentX = null;\n      this.currentY = null;\n      this.initialX = null;\n      this.initialY = null;\n      this.xOffset = 0;\n      this.yOffset = 0;\n      this.img.addEventListener('mousedown', function (e) {\n        return _this.dragStart(e);\n      }, false);\n      this.img.addEventListener('mouseup', function (e) {\n        return _this.dragEnd(e);\n      }, false);\n      this.img.addEventListener('mousemove', function (e) {\n        return _this.drag(e);\n      }, false);\n      this.img.addEventListener('click', function (e) {\n        if (_this.slide.classList.contains('dragging-nav')) {\n          _this.zoomOut();\n\n          return false;\n        }\n\n        if (!_this.zoomedIn) {\n          return _this.zoomIn();\n        }\n\n        if (_this.zoomedIn && !_this.dragging) {\n          _this.zoomOut();\n        }\n      }, false);\n      this.img.setZoomEvents = true;\n    }\n\n    _createClass(ZoomImages, [{\n      key: \"zoomIn\",\n      value: function zoomIn() {\n        var winWidth = this.widowWidth();\n\n        if (this.zoomedIn || winWidth <= 768) {\n          return;\n        }\n\n        var img = this.img;\n        img.setAttribute('data-style', img.getAttribute('style'));\n        img.style.maxWidth = img.naturalWidth + 'px';\n        img.style.maxHeight = img.naturalHeight + 'px';\n\n        if (img.naturalWidth > winWidth) {\n          var centerX = winWidth / 2 - img.naturalWidth / 2;\n          this.setTranslate(this.img.parentNode, centerX, 0);\n        }\n\n        this.slide.classList.add('zoomed');\n        this.zoomedIn = true;\n      }\n    }, {\n      key: \"zoomOut\",\n      value: function zoomOut() {\n        this.img.parentNode.setAttribute('style', '');\n        this.img.setAttribute('style', this.img.getAttribute('data-style'));\n        this.slide.classList.remove('zoomed');\n        this.zoomedIn = false;\n        this.currentX = null;\n        this.currentY = null;\n        this.initialX = null;\n        this.initialY = null;\n        this.xOffset = 0;\n        this.yOffset = 0;\n\n        if (this.onclose && typeof this.onclose == 'function') {\n          this.onclose();\n        }\n      }\n    }, {\n      key: \"dragStart\",\n      value: function dragStart(e) {\n        e.preventDefault();\n\n        if (!this.zoomedIn) {\n          this.active = false;\n          return;\n        }\n\n        if (e.type === 'touchstart') {\n          this.initialX = e.touches[0].clientX - this.xOffset;\n          this.initialY = e.touches[0].clientY - this.yOffset;\n        } else {\n          this.initialX = e.clientX - this.xOffset;\n          this.initialY = e.clientY - this.yOffset;\n        }\n\n        if (e.target === this.img) {\n          this.active = true;\n          this.img.classList.add('dragging');\n        }\n      }\n    }, {\n      key: \"dragEnd\",\n      value: function dragEnd(e) {\n        var _this2 = this;\n\n        e.preventDefault();\n        this.initialX = this.currentX;\n        this.initialY = this.currentY;\n        this.active = false;\n        setTimeout(function () {\n          _this2.dragging = false;\n          _this2.img.isDragging = false;\n\n          _this2.img.classList.remove('dragging');\n        }, 100);\n      }\n    }, {\n      key: \"drag\",\n      value: function drag(e) {\n        if (this.active) {\n          e.preventDefault();\n\n          if (e.type === 'touchmove') {\n            this.currentX = e.touches[0].clientX - this.initialX;\n            this.currentY = e.touches[0].clientY - this.initialY;\n          } else {\n            this.currentX = e.clientX - this.initialX;\n            this.currentY = e.clientY - this.initialY;\n          }\n\n          this.xOffset = this.currentX;\n          this.yOffset = this.currentY;\n          this.img.isDragging = true;\n          this.dragging = true;\n          this.setTranslate(this.img, this.currentX, this.currentY);\n        }\n      }\n    }, {\n      key: \"onMove\",\n      value: function onMove(e) {\n        if (!this.zoomedIn) {\n          return;\n        }\n\n        var xOffset = e.clientX - this.img.naturalWidth / 2;\n        var yOffset = e.clientY - this.img.naturalHeight / 2;\n        this.setTranslate(this.img, xOffset, yOffset);\n      }\n    }, {\n      key: \"setTranslate\",\n      value: function setTranslate(node, xPos, yPos) {\n        node.style.transform = 'translate3d(' + xPos + 'px, ' + yPos + 'px, 0)';\n      }\n    }, {\n      key: \"widowWidth\",\n      value: function widowWidth() {\n        return window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n      }\n    }]);\n\n    return ZoomImages;\n  }();\n\n  var DragSlides = function () {\n    function DragSlides() {\n      var _this = this;\n\n      var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      _classCallCheck(this, DragSlides);\n\n      var dragEl = config.dragEl,\n          _config$toleranceX = config.toleranceX,\n          toleranceX = _config$toleranceX === void 0 ? 40 : _config$toleranceX,\n          _config$toleranceY = config.toleranceY,\n          toleranceY = _config$toleranceY === void 0 ? 65 : _config$toleranceY,\n          _config$slide = config.slide,\n          slide = _config$slide === void 0 ? null : _config$slide,\n          _config$instance = config.instance,\n          instance = _config$instance === void 0 ? null : _config$instance;\n      this.el = dragEl;\n      this.active = false;\n      this.dragging = false;\n      this.currentX = null;\n      this.currentY = null;\n      this.initialX = null;\n      this.initialY = null;\n      this.xOffset = 0;\n      this.yOffset = 0;\n      this.direction = null;\n      this.lastDirection = null;\n      this.toleranceX = toleranceX;\n      this.toleranceY = toleranceY;\n      this.toleranceReached = false;\n      this.dragContainer = this.el;\n      this.slide = slide;\n      this.instance = instance;\n      this.el.addEventListener('mousedown', function (e) {\n        return _this.dragStart(e);\n      }, false);\n      this.el.addEventListener('mouseup', function (e) {\n        return _this.dragEnd(e);\n      }, false);\n      this.el.addEventListener('mousemove', function (e) {\n        return _this.drag(e);\n      }, false);\n    }\n\n    _createClass(DragSlides, [{\n      key: \"dragStart\",\n      value: function dragStart(e) {\n        if (this.slide.classList.contains('zoomed')) {\n          this.active = false;\n          return;\n        }\n\n        if (e.type === 'touchstart') {\n          this.initialX = e.touches[0].clientX - this.xOffset;\n          this.initialY = e.touches[0].clientY - this.yOffset;\n        } else {\n          this.initialX = e.clientX - this.xOffset;\n          this.initialY = e.clientY - this.yOffset;\n        }\n\n        var clicked = e.target.nodeName.toLowerCase();\n        var exludeClicks = ['input', 'select', 'textarea', 'button', 'a'];\n\n        if (e.target.classList.contains('nodrag') || closest(e.target, '.nodrag') || exludeClicks.indexOf(clicked) !== -1) {\n          this.active = false;\n          return;\n        }\n\n        e.preventDefault();\n\n        if (e.target === this.el || clicked !== 'img' && closest(e.target, '.gslide-inline')) {\n          this.active = true;\n          this.el.classList.add('dragging');\n          this.dragContainer = closest(e.target, '.ginner-container');\n        }\n      }\n    }, {\n      key: \"dragEnd\",\n      value: function dragEnd(e) {\n        var _this2 = this;\n\n        e && e.preventDefault();\n        this.initialX = 0;\n        this.initialY = 0;\n        this.currentX = null;\n        this.currentY = null;\n        this.initialX = null;\n        this.initialY = null;\n        this.xOffset = 0;\n        this.yOffset = 0;\n        this.active = false;\n\n        if (this.doSlideChange) {\n          this.instance.preventOutsideClick = true;\n          this.doSlideChange == 'right' && this.instance.prevSlide();\n          this.doSlideChange == 'left' && this.instance.nextSlide();\n        }\n\n        if (this.doSlideClose) {\n          this.instance.close();\n        }\n\n        if (!this.toleranceReached) {\n          this.setTranslate(this.dragContainer, 0, 0, true);\n        }\n\n        setTimeout(function () {\n          _this2.instance.preventOutsideClick = false;\n          _this2.toleranceReached = false;\n          _this2.lastDirection = null;\n          _this2.dragging = false;\n          _this2.el.isDragging = false;\n\n          _this2.el.classList.remove('dragging');\n\n          _this2.slide.classList.remove('dragging-nav');\n\n          _this2.dragContainer.style.transform = '';\n          _this2.dragContainer.style.transition = '';\n        }, 100);\n      }\n    }, {\n      key: \"drag\",\n      value: function drag(e) {\n        if (this.active) {\n          e.preventDefault();\n          this.slide.classList.add('dragging-nav');\n\n          if (e.type === 'touchmove') {\n            this.currentX = e.touches[0].clientX - this.initialX;\n            this.currentY = e.touches[0].clientY - this.initialY;\n          } else {\n            this.currentX = e.clientX - this.initialX;\n            this.currentY = e.clientY - this.initialY;\n          }\n\n          this.xOffset = this.currentX;\n          this.yOffset = this.currentY;\n          this.el.isDragging = true;\n          this.dragging = true;\n          this.doSlideChange = false;\n          this.doSlideClose = false;\n          var currentXInt = Math.abs(this.currentX);\n          var currentYInt = Math.abs(this.currentY);\n\n          if (currentXInt > 0 && currentXInt >= Math.abs(this.currentY) && (!this.lastDirection || this.lastDirection == 'x')) {\n            this.yOffset = 0;\n            this.lastDirection = 'x';\n            this.setTranslate(this.dragContainer, this.currentX, 0);\n            var doChange = this.shouldChange();\n\n            if (!this.instance.settings.dragAutoSnap && doChange) {\n              this.doSlideChange = doChange;\n            }\n\n            if (this.instance.settings.dragAutoSnap && doChange) {\n              this.instance.preventOutsideClick = true;\n              this.toleranceReached = true;\n              this.active = false;\n              this.instance.preventOutsideClick = true;\n              this.dragEnd(null);\n              doChange == 'right' && this.instance.prevSlide();\n              doChange == 'left' && this.instance.nextSlide();\n              return;\n            }\n          }\n\n          if (this.toleranceY > 0 && currentYInt > 0 && currentYInt >= currentXInt && (!this.lastDirection || this.lastDirection == 'y')) {\n            this.xOffset = 0;\n            this.lastDirection = 'y';\n            this.setTranslate(this.dragContainer, 0, this.currentY);\n            var doClose = this.shouldClose();\n\n            if (!this.instance.settings.dragAutoSnap && doClose) {\n              this.doSlideClose = true;\n            }\n\n            if (this.instance.settings.dragAutoSnap && doClose) {\n              this.instance.close();\n            }\n\n            return;\n          }\n        }\n      }\n    }, {\n      key: \"shouldChange\",\n      value: function shouldChange() {\n        var doChange = false;\n        var currentXInt = Math.abs(this.currentX);\n\n        if (currentXInt >= this.toleranceX) {\n          var dragDir = this.currentX > 0 ? 'right' : 'left';\n\n          if (dragDir == 'left' && this.slide !== this.slide.parentNode.lastChild || dragDir == 'right' && this.slide !== this.slide.parentNode.firstChild) {\n            doChange = dragDir;\n          }\n        }\n\n        return doChange;\n      }\n    }, {\n      key: \"shouldClose\",\n      value: function shouldClose() {\n        var doClose = false;\n        var currentYInt = Math.abs(this.currentY);\n\n        if (currentYInt >= this.toleranceY) {\n          doClose = true;\n        }\n\n        return doClose;\n      }\n    }, {\n      key: \"setTranslate\",\n      value: function setTranslate(node, xPos, yPos) {\n        var animated = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n        if (animated) {\n          node.style.transition = 'all .2s ease';\n        } else {\n          node.style.transition = '';\n        }\n\n        node.style.transform = \"translate3d(\".concat(xPos, \"px, \").concat(yPos, \"px, 0)\");\n      }\n    }]);\n\n    return DragSlides;\n  }();\n\n  function slideImage(slide, data, index, callback) {\n    var slideMedia = slide.querySelector('.gslide-media');\n    var img = new Image();\n    var titleID = 'gSlideTitle_' + index;\n    var textID = 'gSlideDesc_' + index;\n    img.addEventListener('load', function () {\n      if (isFunction(callback)) {\n        callback();\n      }\n    }, false);\n    img.src = data.href;\n    img.alt = '';\n\n    if (data.title !== '') {\n      img.setAttribute('aria-labelledby', titleID);\n    }\n\n    if (data.description !== '') {\n      img.setAttribute('aria-describedby', textID);\n    }\n\n    slideMedia.insertBefore(img, slideMedia.firstChild);\n    return;\n  }\n\n  function slideVideo(slide, data, index, callback) {\n    var _this = this;\n\n    var slideContainer = slide.querySelector('.ginner-container');\n    var videoID = 'gvideo' + index;\n    var slideMedia = slide.querySelector('.gslide-media');\n    var videoPlayers = this.getAllPlayers();\n    addClass(slideContainer, 'gvideo-container');\n    slideMedia.insertBefore(createHTML('<div class=\"gvideo-wrapper\"></div>'), slideMedia.firstChild);\n    var videoWrapper = slide.querySelector('.gvideo-wrapper');\n    injectAssets(this.settings.plyr.css, 'Plyr');\n    var url = data.href;\n    var protocol = location.protocol.replace(':', '');\n    var videoSource = '';\n    var embedID = '';\n    var customPlaceholder = false;\n\n    if (protocol == 'file') {\n      protocol = 'http';\n    }\n\n    slideMedia.style.maxWidth = data.width;\n    injectAssets(this.settings.plyr.js, 'Plyr', function () {\n      if (url.match(/vimeo\\.com\\/([0-9]*)/)) {\n        var vimeoID = /vimeo.*\\/(\\d+)/i.exec(url);\n        videoSource = 'vimeo';\n        embedID = vimeoID[1];\n      }\n\n      if (url.match(/(youtube\\.com|youtube-nocookie\\.com)\\/watch\\?v=([a-zA-Z0-9\\-_]+)/) || url.match(/youtu\\.be\\/([a-zA-Z0-9\\-_]+)/) || url.match(/(youtube\\.com|youtube-nocookie\\.com)\\/embed\\/([a-zA-Z0-9\\-_]+)/)) {\n        var youtubeID = getYoutubeID(url);\n        videoSource = 'youtube';\n        embedID = youtubeID;\n      }\n\n      if (url.match(/\\.(mp4|ogg|webm|mov)$/) !== null) {\n        videoSource = 'local';\n        var html = '<video id=\"' + videoID + '\" ';\n        html += \"style=\\\"background:#000; max-width: \".concat(data.width, \";\\\" \");\n        html += 'preload=\"metadata\" ';\n        html += 'x-webkit-airplay=\"allow\" ';\n        html += 'webkit-playsinline=\"\" ';\n        html += 'controls ';\n        html += 'class=\"gvideo-local\">';\n        var format = url.toLowerCase().split('.').pop();\n        var sources = {\n          mp4: '',\n          ogg: '',\n          webm: ''\n        };\n        format = format == 'mov' ? 'mp4' : format;\n        sources[format] = url;\n\n        for (var key in sources) {\n          if (sources.hasOwnProperty(key)) {\n            var videoFile = sources[key];\n\n            if (data.hasOwnProperty(key)) {\n              videoFile = data[key];\n            }\n\n            if (videoFile !== '') {\n              html += \"<source src=\\\"\".concat(videoFile, \"\\\" type=\\\"video/\").concat(key, \"\\\">\");\n            }\n          }\n        }\n\n        html += '</video>';\n        customPlaceholder = createHTML(html);\n      }\n\n      var placeholder = customPlaceholder ? customPlaceholder : createHTML(\"<div id=\\\"\".concat(videoID, \"\\\" data-plyr-provider=\\\"\").concat(videoSource, \"\\\" data-plyr-embed-id=\\\"\").concat(embedID, \"\\\"></div>\"));\n      addClass(videoWrapper, \"\".concat(videoSource, \"-video gvideo\"));\n      videoWrapper.appendChild(placeholder);\n      videoWrapper.setAttribute('data-id', videoID);\n      videoWrapper.setAttribute('data-index', index);\n      var playerConfig = has(_this.settings.plyr, 'config') ? _this.settings.plyr.config : {};\n      var player = new Plyr('#' + videoID, playerConfig);\n      player.on('ready', function (event) {\n        var instance = event.detail.plyr;\n        videoPlayers[videoID] = instance;\n\n        if (isFunction(callback)) {\n          callback();\n        }\n      });\n      player.on('enterfullscreen', handleMediaFullScreen);\n      player.on('exitfullscreen', handleMediaFullScreen);\n    });\n  }\n\n  function getYoutubeID(url) {\n    var videoID = '';\n    url = url.replace(/(>|<)/gi, '').split(/(vi\\/|v=|\\/v\\/|youtu\\.be\\/|\\/embed\\/)/);\n\n    if (url[2] !== undefined) {\n      videoID = url[2].split(/[^0-9a-z_\\-]/i);\n      videoID = videoID[0];\n    } else {\n      videoID = url;\n    }\n\n    return videoID;\n  }\n\n  function handleMediaFullScreen(event) {\n    var media = closest(event.target, '.gslide-media');\n\n    if (event.type == 'enterfullscreen') {\n      addClass(media, 'fullscreen');\n    }\n\n    if (event.type == 'exitfullscreen') {\n      removeClass(media, 'fullscreen');\n    }\n  }\n\n  function slideInline(slide, data, index, callback) {\n    var _this = this;\n\n    var slideMedia = slide.querySelector('.gslide-media');\n    var hash = has(data, 'href') && data.href ? data.href.split('#').pop().trim() : false;\n    var content = has(data, 'content') && data.content ? data.content : false;\n    var innerContent;\n\n    if (content) {\n      if (isString(content)) {\n        innerContent = createHTML(\"<div class=\\\"ginlined-content\\\">\".concat(content, \"</div>\"));\n      }\n\n      if (isNode(content)) {\n        if (content.style.display == 'none') {\n          content.style.display = 'block';\n        }\n\n        var container = document.createElement('div');\n        container.className = 'ginlined-content';\n        container.appendChild(content);\n        innerContent = container;\n      }\n    }\n\n    if (hash) {\n      var div = document.getElementById(hash);\n\n      if (!div) {\n        return false;\n      }\n\n      var cloned = div.cloneNode(true);\n      cloned.style.height = data.height;\n      cloned.style.maxWidth = data.width;\n      addClass(cloned, 'ginlined-content');\n      innerContent = cloned;\n    }\n\n    if (!innerContent) {\n      console.error('Unable to append inline slide content', data);\n      return false;\n    }\n\n    slideMedia.style.height = data.height;\n    slideMedia.style.width = data.width;\n    slideMedia.appendChild(innerContent);\n    this.events['inlineclose' + hash] = addEvent('click', {\n      onElement: slideMedia.querySelectorAll('.gtrigger-close'),\n      withCallback: function withCallback(e) {\n        e.preventDefault();\n\n        _this.close();\n      }\n    });\n\n    if (isFunction(callback)) {\n      callback();\n    }\n\n    return;\n  }\n\n  function slideIframe(slide, data, index, callback) {\n    var slideMedia = slide.querySelector('.gslide-media');\n    var iframe = createIframe({\n      url: data.href,\n      callback: callback\n    });\n    slideMedia.parentNode.style.maxWidth = data.width;\n    slideMedia.parentNode.style.height = data.height;\n    slideMedia.appendChild(iframe);\n    return;\n  }\n\n  var SlideConfigParser = function () {\n    function SlideConfigParser() {\n      var slideParamas = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      _classCallCheck(this, SlideConfigParser);\n\n      this.defaults = {\n        href: '',\n        title: '',\n        type: '',\n        description: '',\n        descPosition: 'bottom',\n        effect: '',\n        width: '',\n        height: '',\n        content: false,\n        zoomable: true,\n        draggable: true\n      };\n\n      if (isObject(slideParamas)) {\n        this.defaults = extend(this.defaults, slideParamas);\n      }\n    }\n\n    _createClass(SlideConfigParser, [{\n      key: \"sourceType\",\n      value: function sourceType(url) {\n        var origin = url;\n        url = url.toLowerCase();\n\n        if (url.match(/\\.(jpeg|jpg|jpe|gif|png|apn|webp|svg)$/) !== null) {\n          return 'image';\n        }\n\n        if (url.match(/(youtube\\.com|youtube-nocookie\\.com)\\/watch\\?v=([a-zA-Z0-9\\-_]+)/) || url.match(/youtu\\.be\\/([a-zA-Z0-9\\-_]+)/) || url.match(/(youtube\\.com|youtube-nocookie\\.com)\\/embed\\/([a-zA-Z0-9\\-_]+)/)) {\n          return 'video';\n        }\n\n        if (url.match(/vimeo\\.com\\/([0-9]*)/)) {\n          return 'video';\n        }\n\n        if (url.match(/\\.(mp4|ogg|webm|mov)$/) !== null) {\n          return 'video';\n        }\n\n        if (url.match(/\\.(mp3|wav|wma|aac|ogg)$/) !== null) {\n          return 'audio';\n        }\n\n        if (url.indexOf('#') > -1) {\n          var hash = origin.split('#').pop();\n\n          if (hash.trim() !== '') {\n            return 'inline';\n          }\n        }\n\n        if (url.indexOf('goajax=true') > -1) {\n          return 'ajax';\n        }\n\n        return 'external';\n      }\n    }, {\n      key: \"parseConfig\",\n      value: function parseConfig(element, settings) {\n        var _this = this;\n\n        var data = extend({\n          descPosition: settings.descPosition\n        }, this.defaults);\n\n        if (isObject(element) && !isNode(element)) {\n          if (!has(element, 'type')) {\n            if (has(element, 'content') && element.content) {\n              element.type = 'inline';\n            } else if (has(element, 'href')) {\n              element.type = this.sourceType(element.href);\n            }\n          }\n\n          var objectData = extend(data, element);\n          this.setSize(objectData, settings);\n          return objectData;\n        }\n\n        var url = '';\n        var config = element.getAttribute('data-glightbox');\n        var nodeType = element.nodeName.toLowerCase();\n\n        if (nodeType === 'a') {\n          url = element.href;\n        }\n\n        if (nodeType === 'img') {\n          url = element.src;\n        }\n\n        data.href = url;\n        each(data, function (val, key) {\n          if (has(settings, key) && key !== 'width') {\n            data[key] = settings[key];\n          }\n\n          var nodeData = element.dataset[key];\n\n          if (!isNil(nodeData)) {\n            data[key] = _this.sanitizeValue(nodeData);\n          }\n        });\n\n        if (data.content) {\n          data.type = 'inline';\n        }\n\n        if (!data.type && url) {\n          data.type = this.sourceType(url);\n        }\n\n        if (!isNil(config)) {\n          var cleanKeys = [];\n          each(data, function (v, k) {\n            cleanKeys.push(';\\\\s?' + k);\n          });\n          cleanKeys = cleanKeys.join('\\\\s?:|');\n\n          if (config.trim() !== '') {\n            each(data, function (val, key) {\n              var str = config;\n              var match = '\\s?' + key + '\\s?:\\s?(.*?)(' + cleanKeys + '\\s?:|$)';\n              var regex = new RegExp(match);\n              var matches = str.match(regex);\n\n              if (matches && matches.length && matches[1]) {\n                var value = matches[1].trim().replace(/;\\s*$/, '');\n                data[key] = _this.sanitizeValue(value);\n              }\n            });\n          }\n        } else {\n          if (!data.title && nodeType == 'a') {\n            var title = element.title;\n\n            if (!isNil(title) && title !== '') {\n              data.title = title;\n            }\n          }\n\n          if (!data.title && nodeType == 'img') {\n            var alt = element.alt;\n\n            if (!isNil(alt) && alt !== '') {\n              data.title = alt;\n            }\n          }\n        }\n\n        if (data.description && data.description.substring(0, 1) == '.' && document.querySelector(data.description)) {\n          data.description = document.querySelector(data.description).innerHTML;\n        } else {\n          var nodeDesc = element.querySelector('.glightbox-desc');\n\n          if (nodeDesc) {\n            data.description = nodeDesc.innerHTML;\n          }\n        }\n\n        this.setSize(data, settings);\n        this.slideConfig = data;\n        return data;\n      }\n    }, {\n      key: \"setSize\",\n      value: function setSize(data, settings) {\n        var defaultWith = data.type == 'video' ? this.checkSize(settings.videosWidth) : this.checkSize(settings.width);\n        var defaultHeight = this.checkSize(settings.height);\n        data.width = has(data, 'width') && data.width !== '' ? this.checkSize(data.width) : defaultWith;\n        data.height = has(data, 'height') && data.height !== '' ? this.checkSize(data.height) : defaultHeight;\n        return data;\n      }\n    }, {\n      key: \"checkSize\",\n      value: function checkSize(size) {\n        return isNumber(size) ? \"\".concat(size, \"px\") : size;\n      }\n    }, {\n      key: \"sanitizeValue\",\n      value: function sanitizeValue(val) {\n        if (val !== 'true' && val !== 'false') {\n          return val;\n        }\n\n        return val === 'true';\n      }\n    }]);\n\n    return SlideConfigParser;\n  }();\n\n  var Slide = function () {\n    function Slide(el, instance, index) {\n      _classCallCheck(this, Slide);\n\n      this.element = el;\n      this.instance = instance;\n      this.index = index;\n    }\n\n    _createClass(Slide, [{\n      key: \"setContent\",\n      value: function setContent() {\n        var _this = this;\n\n        var slide = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n        var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n        if (hasClass(slide, 'loaded')) {\n          return false;\n        }\n\n        var settings = this.instance.settings;\n        var slideConfig = this.slideConfig;\n        var isMobileDevice = isMobile();\n\n        if (isFunction(settings.beforeSlideLoad)) {\n          settings.beforeSlideLoad({\n            index: this.index,\n            slide: slide,\n            player: false\n          });\n        }\n\n        var type = slideConfig.type;\n        var position = slideConfig.descPosition;\n        var slideMedia = slide.querySelector('.gslide-media');\n        var slideTitle = slide.querySelector('.gslide-title');\n        var slideText = slide.querySelector('.gslide-desc');\n        var slideDesc = slide.querySelector('.gdesc-inner');\n        var finalCallback = callback;\n        var titleID = 'gSlideTitle_' + this.index;\n        var textID = 'gSlideDesc_' + this.index;\n\n        if (isFunction(settings.afterSlideLoad)) {\n          finalCallback = function finalCallback() {\n            if (isFunction(callback)) {\n              callback();\n            }\n\n            settings.afterSlideLoad({\n              index: _this.index,\n              slide: slide,\n              player: _this.instance.getSlidePlayerInstance(_this.index)\n            });\n          };\n        }\n\n        if (slideConfig.title == '' && slideConfig.description == '') {\n          if (slideDesc) {\n            slideDesc.parentNode.parentNode.removeChild(slideDesc.parentNode);\n          }\n        } else {\n          if (slideTitle && slideConfig.title !== '') {\n            slideTitle.id = titleID;\n            slideTitle.innerHTML = slideConfig.title;\n          } else {\n            slideTitle.parentNode.removeChild(slideTitle);\n          }\n\n          if (slideText && slideConfig.description !== '') {\n            slideText.id = textID;\n\n            if (isMobileDevice && settings.moreLength > 0) {\n              slideConfig.smallDescription = this.slideShortDesc(slideConfig.description, settings.moreLength, settings.moreText);\n              slideText.innerHTML = slideConfig.smallDescription;\n              this.descriptionEvents(slideText, slideConfig);\n            } else {\n              slideText.innerHTML = slideConfig.description;\n            }\n          } else {\n            slideText.parentNode.removeChild(slideText);\n          }\n\n          addClass(slideMedia.parentNode, \"desc-\".concat(position));\n          addClass(slideDesc.parentNode, \"description-\".concat(position));\n        }\n\n        addClass(slideMedia, \"gslide-\".concat(type));\n        addClass(slide, 'loaded');\n\n        if (type === 'video') {\n          slideVideo.apply(this.instance, [slide, slideConfig, this.index, finalCallback]);\n          return;\n        }\n\n        if (type === 'external') {\n          slideIframe.apply(this, [slide, slideConfig, this.index, finalCallback]);\n          return;\n        }\n\n        if (type === 'inline') {\n          slideInline.apply(this.instance, [slide, slideConfig, this.index, finalCallback]);\n\n          if (settings.draggable) {\n            new DragSlides({\n              dragEl: slide.querySelector('.gslide-inline'),\n              toleranceX: settings.dragToleranceX,\n              toleranceY: settings.dragToleranceY,\n              slide: slide,\n              instance: this.instance\n            });\n          }\n\n          return;\n        }\n\n        if (type === 'image') {\n          slideImage(slide, slideConfig, this.index, function () {\n            var img = slide.querySelector('img');\n\n            if (settings.draggable) {\n              new DragSlides({\n                dragEl: img,\n                toleranceX: settings.dragToleranceX,\n                toleranceY: settings.dragToleranceY,\n                slide: slide,\n                instance: _this.instance\n              });\n            }\n\n            if (slideConfig.zoomable && img.naturalWidth > img.offsetWidth) {\n              addClass(img, 'zoomable');\n              new ZoomImages(img, slide, function () {\n                _this.instance.resize();\n              });\n            }\n\n            if (isFunction(finalCallback)) {\n              finalCallback();\n            }\n          });\n          return;\n        }\n\n        if (isFunction(finalCallback)) {\n          finalCallback();\n        }\n      }\n    }, {\n      key: \"slideShortDesc\",\n      value: function slideShortDesc(string) {\n        var n = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 50;\n        var wordBoundary = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n        var div = document.createElement('div');\n        div.innerHTML = string;\n        var cleanedString = div.innerText;\n        var useWordBoundary = wordBoundary;\n        string = cleanedString.trim();\n\n        if (string.length <= n) {\n          return string;\n        }\n\n        var subString = string.substr(0, n - 1);\n\n        if (!useWordBoundary) {\n          return subString;\n        }\n\n        div = null;\n        return subString + '... <a href=\"#\" class=\"desc-more\">' + wordBoundary + '</a>';\n      }\n    }, {\n      key: \"descriptionEvents\",\n      value: function descriptionEvents(desc, data) {\n        var _this2 = this;\n\n        var moreLink = desc.querySelector('.desc-more');\n\n        if (!moreLink) {\n          return false;\n        }\n\n        addEvent('click', {\n          onElement: moreLink,\n          withCallback: function withCallback(event, target) {\n            event.preventDefault();\n            var body = document.body;\n            var desc = closest(target, '.gslide-desc');\n\n            if (!desc) {\n              return false;\n            }\n\n            desc.innerHTML = data.description;\n            addClass(body, 'gdesc-open');\n            var shortEvent = addEvent('click', {\n              onElement: [body, closest(desc, '.gslide-description')],\n              withCallback: function withCallback(event, target) {\n                if (event.target.nodeName.toLowerCase() !== 'a') {\n                  removeClass(body, 'gdesc-open');\n                  addClass(body, 'gdesc-closed');\n                  desc.innerHTML = data.smallDescription;\n\n                  _this2.descriptionEvents(desc, data);\n\n                  setTimeout(function () {\n                    removeClass(body, 'gdesc-closed');\n                  }, 400);\n                  shortEvent.destroy();\n                }\n              }\n            });\n          }\n        });\n      }\n    }, {\n      key: \"create\",\n      value: function create() {\n        return createHTML(this.instance.settings.slideHTML);\n      }\n    }, {\n      key: \"getConfig\",\n      value: function getConfig() {\n        var parser = new SlideConfigParser(this.instance.settings.slideExtraAttributes);\n        this.slideConfig = parser.parseConfig(this.element, this.instance.settings);\n        return this.slideConfig;\n      }\n    }]);\n\n    return Slide;\n  }();\n\n  var _version = '3.0.7';\n\n  var isMobile$1 = isMobile();\n\n  var isTouch$1 = isTouch();\n\n  var html = document.getElementsByTagName('html')[0];\n  var defaults = {\n    selector: '.glightbox',\n    elements: null,\n    skin: 'clean',\n    theme: 'clean',\n    closeButton: true,\n    startAt: null,\n    autoplayVideos: true,\n    autofocusVideos: true,\n    descPosition: 'bottom',\n    width: '900px',\n    height: '506px',\n    videosWidth: '960px',\n    beforeSlideChange: null,\n    afterSlideChange: null,\n    beforeSlideLoad: null,\n    afterSlideLoad: null,\n    slideInserted: null,\n    slideRemoved: null,\n    slideExtraAttributes: null,\n    onOpen: null,\n    onClose: null,\n    loop: false,\n    zoomable: true,\n    draggable: true,\n    dragAutoSnap: false,\n    dragToleranceX: 40,\n    dragToleranceY: 65,\n    preload: true,\n    oneSlidePerOpen: false,\n    touchNavigation: true,\n    touchFollowAxis: true,\n    keyboardNavigation: true,\n    closeOnOutsideClick: true,\n    plugins: false,\n    plyr: {\n      css: 'https://cdn.plyr.io/3.6.3/plyr.css',\n      js: 'https://cdn.plyr.io/3.6.3/plyr.js',\n      config: {\n        ratio: '16:9',\n        fullscreen: {\n          enabled: true,\n          iosNative: true\n        },\n        youtube: {\n          noCookie: true,\n          rel: 0,\n          showinfo: 0,\n          iv_load_policy: 3\n        },\n        vimeo: {\n          byline: false,\n          portrait: false,\n          title: false,\n          transparent: false\n        }\n      }\n    },\n    openEffect: 'zoom',\n    closeEffect: 'zoom',\n    slideEffect: 'slide',\n    moreText: 'See more',\n    moreLength: 60,\n    cssEfects: {\n      fade: {\n        \"in\": 'fadeIn',\n        out: 'fadeOut'\n      },\n      zoom: {\n        \"in\": 'zoomIn',\n        out: 'zoomOut'\n      },\n      slide: {\n        \"in\": 'slideInRight',\n        out: 'slideOutLeft'\n      },\n      slideBack: {\n        \"in\": 'slideInLeft',\n        out: 'slideOutRight'\n      },\n      none: {\n        \"in\": 'none',\n        out: 'none'\n      }\n    },\n    svg: {\n      close: '<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" xml:space=\"preserve\"><g><g><path d=\"M505.943,6.058c-8.077-8.077-21.172-8.077-29.249,0L6.058,476.693c-8.077,8.077-8.077,21.172,0,29.249C10.096,509.982,15.39,512,20.683,512c5.293,0,10.586-2.019,14.625-6.059L505.943,35.306C514.019,27.23,514.019,14.135,505.943,6.058z\"/></g></g><g><g><path d=\"M505.942,476.694L35.306,6.059c-8.076-8.077-21.172-8.077-29.248,0c-8.077,8.076-8.077,21.171,0,29.248l470.636,470.636c4.038,4.039,9.332,6.058,14.625,6.058c5.293,0,10.587-2.019,14.624-6.057C514.018,497.866,514.018,484.771,505.942,476.694z\"/></g></g></svg>',\n      next: '<svg version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 477.175 477.175\" xml:space=\"preserve\"> <g><path d=\"M360.731,229.075l-225.1-225.1c-5.3-5.3-13.8-5.3-19.1,0s-5.3,13.8,0,19.1l215.5,215.5l-215.5,215.5c-5.3,5.3-5.3,13.8,0,19.1c2.6,2.6,6.1,4,9.5,4c3.4,0,6.9-1.3,9.5-4l225.1-225.1C365.931,242.875,365.931,234.275,360.731,229.075z\"/></g></svg>',\n      prev: '<svg version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 477.175 477.175\" xml:space=\"preserve\"><g><path d=\"M145.188,238.575l215.5-215.5c5.3-5.3,5.3-13.8,0-19.1s-13.8-5.3-19.1,0l-225.1,225.1c-5.3,5.3-5.3,13.8,0,19.1l225.1,225c2.6,2.6,6.1,4,9.5,4s6.9-1.3,9.5-4c5.3-5.3,5.3-13.8,0-19.1L145.188,238.575z\"/></g></svg>'\n    }\n  };\n  defaults.slideHTML = \"<div class=\\\"gslide\\\">\\n    <div class=\\\"gslide-inner-content\\\">\\n        <div class=\\\"ginner-container\\\">\\n            <div class=\\\"gslide-media\\\">\\n            </div>\\n            <div class=\\\"gslide-description\\\">\\n                <div class=\\\"gdesc-inner\\\">\\n                    <h4 class=\\\"gslide-title\\\"></h4>\\n                    <div class=\\\"gslide-desc\\\"></div>\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n</div>\";\n  defaults.lightboxHTML = \"<div id=\\\"glightbox-body\\\" class=\\\"glightbox-container\\\">\\n    <div class=\\\"gloader visible\\\"></div>\\n    <div class=\\\"goverlay\\\"></div>\\n    <div class=\\\"gcontainer\\\">\\n    <div id=\\\"glightbox-slider\\\" class=\\\"gslider\\\"></div>\\n    <button class=\\\"gnext gbtn\\\" tabindex=\\\"0\\\" aria-label=\\\"Next\\\">{nextSVG}</button>\\n    <button class=\\\"gprev gbtn\\\" tabindex=\\\"1\\\" aria-label=\\\"Previous\\\">{prevSVG}</button>\\n    <button class=\\\"gclose gbtn\\\" tabindex=\\\"2\\\" aria-label=\\\"Close\\\">{closeSVG}</button>\\n</div>\\n</div>\";\n\n  var GlightboxInit = function () {\n    function GlightboxInit() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      _classCallCheck(this, GlightboxInit);\n\n      this.settings = extend(defaults, options);\n      this.effectsClasses = this.getAnimationClasses();\n      this.videoPlayers = {};\n      this.apiEvents = [];\n      this.fullElementsList = false;\n    }\n\n    _createClass(GlightboxInit, [{\n      key: \"init\",\n      value: function init() {\n        var _this = this;\n\n        var selector = this.getSelector();\n\n        if (selector) {\n          this.baseEvents = addEvent('click', {\n            onElement: selector,\n            withCallback: function withCallback(e, target) {\n              e.preventDefault();\n\n              _this.open(target);\n            }\n          });\n        }\n\n        this.elements = this.getElements();\n      }\n    }, {\n      key: \"open\",\n      value: function open() {\n        var element = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n        var startAt = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n        if (this.elements.length == 0) {\n          return false;\n        }\n\n        this.activeSlide = null;\n        this.prevActiveSlideIndex = null;\n        this.prevActiveSlide = null;\n        var index = isNumber(startAt) ? startAt : this.settings.startAt;\n\n        if (isNode(element)) {\n          var gallery = element.getAttribute('data-gallery');\n\n          if (gallery) {\n            this.fullElementsList = this.elements;\n            this.elements = this.getGalleryElements(this.elements, gallery);\n          }\n\n          if (isNil(index)) {\n            index = this.getElementIndex(element);\n\n            if (index < 0) {\n              index = 0;\n            }\n          }\n        }\n\n        if (!isNumber(index)) {\n          index = 0;\n        }\n\n        this.build();\n\n        animateElement(this.overlay, this.settings.openEffect == 'none' ? 'none' : this.settings.cssEfects.fade[\"in\"]);\n\n        var body = document.body;\n        var scrollBar = window.innerWidth - document.documentElement.clientWidth;\n\n        if (scrollBar > 0) {\n          var styleSheet = document.createElement('style');\n          styleSheet.type = 'text/css';\n          styleSheet.className = 'gcss-styles';\n          styleSheet.innerText = \".gscrollbar-fixer {margin-right: \".concat(scrollBar, \"px}\");\n          document.head.appendChild(styleSheet);\n\n          addClass(body, 'gscrollbar-fixer');\n        }\n\n        addClass(body, 'glightbox-open');\n\n        addClass(html, 'glightbox-open');\n\n        if (isMobile$1) {\n          addClass(document.body, 'glightbox-mobile');\n\n          this.settings.slideEffect = 'slide';\n        }\n\n        this.showSlide(index, true);\n\n        if (this.elements.length == 1) {\n          addClass(this.prevButton, 'glightbox-button-hidden');\n\n          addClass(this.nextButton, 'glightbox-button-hidden');\n        } else {\n          removeClass(this.prevButton, 'glightbox-button-hidden');\n\n          removeClass(this.nextButton, 'glightbox-button-hidden');\n        }\n\n        this.lightboxOpen = true;\n        this.trigger('open');\n\n        if (isFunction(this.settings.onOpen)) {\n          this.settings.onOpen();\n        }\n\n        if (isTouch$1 && this.settings.touchNavigation) {\n          touchNavigation(this);\n        }\n\n        if (this.settings.keyboardNavigation) {\n          keyboardNavigation(this);\n        }\n      }\n    }, {\n      key: \"openAt\",\n      value: function openAt() {\n        var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n        this.open(null, index);\n      }\n    }, {\n      key: \"showSlide\",\n      value: function showSlide() {\n        var _this2 = this;\n\n        var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n        var first = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n        show(this.loader);\n\n        this.index = parseInt(index);\n        var current = this.slidesContainer.querySelector('.current');\n\n        if (current) {\n          removeClass(current, 'current');\n        }\n\n        this.slideAnimateOut();\n        var slideNode = this.slidesContainer.querySelectorAll('.gslide')[index];\n\n        if (hasClass(slideNode, 'loaded')) {\n          this.slideAnimateIn(slideNode, first);\n\n          hide(this.loader);\n        } else {\n          show(this.loader);\n\n          var slide = this.elements[index];\n          var slideData = {\n            index: this.index,\n            slide: slideNode,\n            slideNode: slideNode,\n            slideConfig: slide.slideConfig,\n            slideIndex: this.index,\n            trigger: slide.node,\n            player: null\n          };\n          this.trigger('slide_before_load', slideData);\n          slide.instance.setContent(slideNode, function () {\n            hide(_this2.loader);\n\n            _this2.resize();\n\n            _this2.slideAnimateIn(slideNode, first);\n\n            _this2.trigger('slide_after_load', slideData);\n          });\n        }\n\n        this.slideDescription = slideNode.querySelector('.gslide-description');\n        this.slideDescriptionContained = this.slideDescription && hasClass(this.slideDescription.parentNode, 'gslide-media');\n\n        if (this.settings.preload) {\n          this.preloadSlide(index + 1);\n          this.preloadSlide(index - 1);\n        }\n\n        this.updateNavigationClasses();\n        this.activeSlide = slideNode;\n      }\n    }, {\n      key: \"preloadSlide\",\n      value: function preloadSlide(index) {\n        var _this3 = this;\n\n        if (index < 0 || index > this.elements.length - 1) {\n          return false;\n        }\n\n        if (isNil(this.elements[index])) {\n          return false;\n        }\n\n        var slideNode = this.slidesContainer.querySelectorAll('.gslide')[index];\n\n        if (hasClass(slideNode, 'loaded')) {\n          return false;\n        }\n\n        var slide = this.elements[index];\n        var type = slide.type;\n        var slideData = {\n          index: index,\n          slide: slideNode,\n          slideNode: slideNode,\n          slideConfig: slide.slideConfig,\n          slideIndex: index,\n          trigger: slide.node,\n          player: null\n        };\n        this.trigger('slide_before_load', slideData);\n\n        if (type == 'video' || type == 'external') {\n          setTimeout(function () {\n            slide.instance.setContent(slideNode, function () {\n              _this3.trigger('slide_after_load', slideData);\n            });\n          }, 200);\n        } else {\n          slide.instance.setContent(slideNode, function () {\n            _this3.trigger('slide_after_load', slideData);\n          });\n        }\n      }\n    }, {\n      key: \"prevSlide\",\n      value: function prevSlide() {\n        this.goToSlide(this.index - 1);\n      }\n    }, {\n      key: \"nextSlide\",\n      value: function nextSlide() {\n        this.goToSlide(this.index + 1);\n      }\n    }, {\n      key: \"goToSlide\",\n      value: function goToSlide() {\n        var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n        this.prevActiveSlide = this.activeSlide;\n        this.prevActiveSlideIndex = this.index;\n\n        if (!this.loop() && (index < 0 || index > this.elements.length - 1)) {\n          return false;\n        }\n\n        if (index < 0) {\n          index = this.elements.length - 1;\n        } else if (index >= this.elements.length) {\n          index = 0;\n        }\n\n        this.showSlide(index);\n      }\n    }, {\n      key: \"insertSlide\",\n      value: function insertSlide() {\n        var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n        var index = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : -1;\n\n        if (index < 0) {\n          index = this.elements.length;\n        }\n\n        var slide = new Slide(config, this, index);\n        var data = slide.getConfig();\n\n        var slideInfo = extend({}, data);\n\n        var newSlide = slide.create();\n        var totalSlides = this.elements.length - 1;\n        slideInfo.index = index;\n        slideInfo.node = false;\n        slideInfo.instance = slide;\n        slideInfo.slideConfig = data;\n        this.elements.splice(index, 0, slideInfo);\n        var addedSlideNode = null;\n        var addedSlidePlayer = null;\n\n        if (this.slidesContainer) {\n          if (index > totalSlides) {\n            this.slidesContainer.appendChild(newSlide);\n          } else {\n            var existingSlide = this.slidesContainer.querySelectorAll('.gslide')[index];\n            this.slidesContainer.insertBefore(newSlide, existingSlide);\n          }\n\n          if (this.settings.preload && this.index == 0 && index == 0 || this.index - 1 == index || this.index + 1 == index) {\n            this.preloadSlide(index);\n          }\n\n          if (this.index == 0 && index == 0) {\n            this.index = 1;\n          }\n\n          this.updateNavigationClasses();\n          addedSlideNode = this.slidesContainer.querySelectorAll('.gslide')[index];\n          addedSlidePlayer = this.getSlidePlayerInstance(index);\n          slideInfo.slideNode = addedSlideNode;\n        }\n\n        this.trigger('slide_inserted', {\n          index: index,\n          slide: addedSlideNode,\n          slideNode: addedSlideNode,\n          slideConfig: data,\n          slideIndex: index,\n          trigger: null,\n          player: addedSlidePlayer\n        });\n\n        if (isFunction(this.settings.slideInserted)) {\n          this.settings.slideInserted({\n            index: index,\n            slide: addedSlideNode,\n            player: addedSlidePlayer\n          });\n        }\n      }\n    }, {\n      key: \"removeSlide\",\n      value: function removeSlide() {\n        var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : -1;\n\n        if (index < 0 || index > this.elements.length - 1) {\n          return false;\n        }\n\n        var slide = this.slidesContainer && this.slidesContainer.querySelectorAll('.gslide')[index];\n\n        if (slide) {\n          if (this.getActiveSlideIndex() == index) {\n            if (index == this.elements.length - 1) {\n              this.prevSlide();\n            } else {\n              this.nextSlide();\n            }\n          }\n\n          slide.parentNode.removeChild(slide);\n        }\n\n        this.elements.splice(index, 1);\n        this.trigger('slide_removed', index);\n\n        if (isFunction(this.settings.slideRemoved)) {\n          this.settings.slideRemoved(index);\n        }\n      }\n    }, {\n      key: \"slideAnimateIn\",\n      value: function slideAnimateIn(slide, first) {\n        var _this4 = this;\n\n        var slideMedia = slide.querySelector('.gslide-media');\n        var slideDesc = slide.querySelector('.gslide-description');\n        var prevData = {\n          index: this.prevActiveSlideIndex,\n          slide: this.prevActiveSlide,\n          slideNode: this.prevActiveSlide,\n          slideIndex: this.prevActiveSlide,\n          slideConfig: isNil(this.prevActiveSlideIndex) ? null : this.elements[this.prevActiveSlideIndex].slideConfig,\n          trigger: isNil(this.prevActiveSlideIndex) ? null : this.elements[this.prevActiveSlideIndex].node,\n          player: this.getSlidePlayerInstance(this.prevActiveSlideIndex)\n        };\n        var nextData = {\n          index: this.index,\n          slide: this.activeSlide,\n          slideNode: this.activeSlide,\n          slideConfig: this.elements[this.index].slideConfig,\n          slideIndex: this.index,\n          trigger: this.elements[this.index].node,\n          player: this.getSlidePlayerInstance(this.index)\n        };\n\n        if (slideMedia.offsetWidth > 0 && slideDesc) {\n          hide(slideDesc);\n\n          slideDesc.style.display = '';\n        }\n\n        removeClass(slide, this.effectsClasses);\n\n        if (first) {\n          animateElement(slide, this.settings.cssEfects[this.settings.openEffect][\"in\"], function () {\n            if (_this4.settings.autoplayVideos) {\n              _this4.slidePlayerPlay(slide);\n            }\n\n            _this4.trigger('slide_changed', {\n              prev: prevData,\n              current: nextData\n            });\n\n            if (isFunction(_this4.settings.afterSlideChange)) {\n              _this4.settings.afterSlideChange.apply(_this4, [prevData, nextData]);\n            }\n          });\n        } else {\n          var effectName = this.settings.slideEffect;\n          var animIn = effectName !== 'none' ? this.settings.cssEfects[effectName][\"in\"] : effectName;\n\n          if (this.prevActiveSlideIndex > this.index) {\n            if (this.settings.slideEffect == 'slide') {\n              animIn = this.settings.cssEfects.slideBack[\"in\"];\n            }\n          }\n\n          animateElement(slide, animIn, function () {\n            if (_this4.settings.autoplayVideos) {\n              _this4.slidePlayerPlay(slide);\n            }\n\n            _this4.trigger('slide_changed', {\n              prev: prevData,\n              current: nextData\n            });\n\n            if (isFunction(_this4.settings.afterSlideChange)) {\n              _this4.settings.afterSlideChange.apply(_this4, [prevData, nextData]);\n            }\n          });\n        }\n\n        setTimeout(function () {\n          _this4.resize(slide);\n        }, 100);\n\n        addClass(slide, 'current');\n      }\n    }, {\n      key: \"slideAnimateOut\",\n      value: function slideAnimateOut() {\n        if (!this.prevActiveSlide) {\n          return false;\n        }\n\n        var prevSlide = this.prevActiveSlide;\n\n        removeClass(prevSlide, this.effectsClasses);\n\n        addClass(prevSlide, 'prev');\n\n        var animation = this.settings.slideEffect;\n        var animOut = animation !== 'none' ? this.settings.cssEfects[animation].out : animation;\n        this.slidePlayerPause(prevSlide);\n        this.trigger('slide_before_change', {\n          prev: {\n            index: this.prevActiveSlideIndex,\n            slide: this.prevActiveSlide,\n            slideNode: this.prevActiveSlide,\n            slideIndex: this.prevActiveSlideIndex,\n            slideConfig: isNil(this.prevActiveSlideIndex) ? null : this.elements[this.prevActiveSlideIndex].slideConfig,\n            trigger: isNil(this.prevActiveSlideIndex) ? null : this.elements[this.prevActiveSlideIndex].node,\n            player: this.getSlidePlayerInstance(this.prevActiveSlideIndex)\n          },\n          current: {\n            index: this.index,\n            slide: this.activeSlide,\n            slideNode: this.activeSlide,\n            slideIndex: this.index,\n            slideConfig: this.elements[this.index].slideConfig,\n            trigger: this.elements[this.index].node,\n            player: this.getSlidePlayerInstance(this.index)\n          }\n        });\n\n        if (isFunction(this.settings.beforeSlideChange)) {\n          this.settings.beforeSlideChange.apply(this, [{\n            index: this.prevActiveSlideIndex,\n            slide: this.prevActiveSlide,\n            player: this.getSlidePlayerInstance(this.prevActiveSlideIndex)\n          }, {\n            index: this.index,\n            slide: this.activeSlide,\n            player: this.getSlidePlayerInstance(this.index)\n          }]);\n        }\n\n        if (this.prevActiveSlideIndex > this.index && this.settings.slideEffect == 'slide') {\n          animOut = this.settings.cssEfects.slideBack.out;\n        }\n\n        animateElement(prevSlide, animOut, function () {\n          var media = prevSlide.querySelector('.gslide-media');\n          var desc = prevSlide.querySelector('.gslide-description');\n          media.style.transform = '';\n\n          removeClass(media, 'greset');\n\n          media.style.opacity = '';\n\n          if (desc) {\n            desc.style.opacity = '';\n          }\n\n          removeClass(prevSlide, 'prev');\n        });\n      }\n    }, {\n      key: \"getAllPlayers\",\n      value: function getAllPlayers() {\n        return this.videoPlayers;\n      }\n    }, {\n      key: \"getSlidePlayerInstance\",\n      value: function getSlidePlayerInstance(index) {\n        var id = 'gvideo' + index;\n        var videoPlayers = this.getAllPlayers();\n\n        if (has(videoPlayers, id) && videoPlayers[id]) {\n          return videoPlayers[id];\n        }\n\n        return false;\n      }\n    }, {\n      key: \"stopSlideVideo\",\n      value: function stopSlideVideo(slide) {\n        if (isNode(slide)) {\n          var node = slide.querySelector('.gvideo-wrapper');\n\n          if (node) {\n            slide = node.getAttribute('data-index');\n          }\n        }\n\n        console.log('stopSlideVideo is deprecated, use slidePlayerPause');\n        var player = this.getSlidePlayerInstance(slide);\n\n        if (player && player.playing) {\n          player.pause();\n        }\n      }\n    }, {\n      key: \"slidePlayerPause\",\n      value: function slidePlayerPause(slide) {\n        if (isNode(slide)) {\n          var node = slide.querySelector('.gvideo-wrapper');\n\n          if (node) {\n            slide = node.getAttribute('data-index');\n          }\n        }\n\n        var player = this.getSlidePlayerInstance(slide);\n\n        if (player && player.playing) {\n          player.pause();\n        }\n      }\n    }, {\n      key: \"playSlideVideo\",\n      value: function playSlideVideo(slide) {\n        if (isNode(slide)) {\n          var node = slide.querySelector('.gvideo-wrapper');\n\n          if (node) {\n            slide = node.getAttribute('data-index');\n          }\n        }\n\n        console.log('playSlideVideo is deprecated, use slidePlayerPlay');\n        var player = this.getSlidePlayerInstance(slide);\n\n        if (player && !player.playing) {\n          player.play();\n        }\n      }\n    }, {\n      key: \"slidePlayerPlay\",\n      value: function slidePlayerPlay(slide) {\n        if (isNode(slide)) {\n          var node = slide.querySelector('.gvideo-wrapper');\n\n          if (node) {\n            slide = node.getAttribute('data-index');\n          }\n        }\n\n        var player = this.getSlidePlayerInstance(slide);\n        console.log('Player is');\n        console.log(player);\n\n        if (player && !player.playing) {\n          player.play();\n\n          if (this.settings.autofocusVideos) {\n            player.elements.container.focus();\n          }\n        }\n      }\n    }, {\n      key: \"setElements\",\n      value: function setElements(elements) {\n        var _this5 = this;\n\n        this.settings.elements = false;\n        var newElements = [];\n\n        if (elements && elements.length) {\n          each(elements, function (el, i) {\n            var slide = new Slide(el, _this5, i);\n            var data = slide.getConfig();\n\n            var slideInfo = extend({}, data);\n\n            slideInfo.slideConfig = data;\n            slideInfo.instance = slide;\n            slideInfo.index = i;\n            newElements.push(slideInfo);\n          });\n        }\n\n        this.elements = newElements;\n\n        if (this.lightboxOpen) {\n          this.slidesContainer.innerHTML = '';\n\n          if (this.elements.length) {\n            each(this.elements, function () {\n              var slide = createHTML(_this5.settings.slideHTML);\n\n              _this5.slidesContainer.appendChild(slide);\n            });\n\n            this.showSlide(0, true);\n          }\n        }\n      }\n    }, {\n      key: \"getElementIndex\",\n      value: function getElementIndex(node) {\n        var index = false;\n\n        each(this.elements, function (el, i) {\n          if (has(el, 'node') && el.node == node) {\n            index = i;\n            return true;\n          }\n        });\n\n        return index;\n      }\n    }, {\n      key: \"getElements\",\n      value: function getElements() {\n        var _this6 = this;\n\n        var list = [];\n        this.elements = this.elements ? this.elements : [];\n\n        if (!isNil(this.settings.elements) && isArray(this.settings.elements) && this.settings.elements.length) {\n          each(this.settings.elements, function (el, i) {\n            var slide = new Slide(el, _this6, i);\n            var elData = slide.getConfig();\n\n            var slideInfo = extend({}, elData);\n\n            slideInfo.node = false;\n            slideInfo.index = i;\n            slideInfo.instance = slide;\n            slideInfo.slideConfig = elData;\n            list.push(slideInfo);\n          });\n        }\n\n        var nodes = false;\n        var selector = this.getSelector();\n\n        if (selector) {\n          nodes = document.querySelectorAll(this.getSelector());\n        }\n\n        if (!nodes) {\n          return list;\n        }\n\n        each(nodes, function (el, i) {\n          var slide = new Slide(el, _this6, i);\n          var elData = slide.getConfig();\n\n          var slideInfo = extend({}, elData);\n\n          slideInfo.node = el;\n          slideInfo.index = i;\n          slideInfo.instance = slide;\n          slideInfo.slideConfig = elData;\n          slideInfo.gallery = el.getAttribute('data-gallery');\n          list.push(slideInfo);\n        });\n\n        return list;\n      }\n    }, {\n      key: \"getGalleryElements\",\n      value: function getGalleryElements(list, gallery) {\n        return list.filter(function (el) {\n          return el.gallery == gallery;\n        });\n      }\n    }, {\n      key: \"getSelector\",\n      value: function getSelector() {\n        if (this.settings.elements) {\n          return false;\n        }\n\n        if (this.settings.selector && this.settings.selector.substring(0, 5) == 'data-') {\n          return \"*[\".concat(this.settings.selector, \"]\");\n        }\n\n        return this.settings.selector;\n      }\n    }, {\n      key: \"getActiveSlide\",\n      value: function getActiveSlide() {\n        return this.slidesContainer.querySelectorAll('.gslide')[this.index];\n      }\n    }, {\n      key: \"getActiveSlideIndex\",\n      value: function getActiveSlideIndex() {\n        return this.index;\n      }\n    }, {\n      key: \"getAnimationClasses\",\n      value: function getAnimationClasses() {\n        var effects = [];\n\n        for (var key in this.settings.cssEfects) {\n          if (this.settings.cssEfects.hasOwnProperty(key)) {\n            var effect = this.settings.cssEfects[key];\n            effects.push(\"g\".concat(effect[\"in\"]));\n            effects.push(\"g\".concat(effect.out));\n          }\n        }\n\n        return effects.join(' ');\n      }\n    }, {\n      key: \"build\",\n      value: function build() {\n        var _this7 = this;\n\n        if (this.built) {\n          return false;\n        }\n\n        var nextSVG = has(this.settings.svg, 'next') ? this.settings.svg.next : '';\n        var prevSVG = has(this.settings.svg, 'prev') ? this.settings.svg.prev : '';\n        var closeSVG = has(this.settings.svg, 'close') ? this.settings.svg.close : '';\n        var lightboxHTML = this.settings.lightboxHTML;\n        lightboxHTML = lightboxHTML.replace(/{nextSVG}/g, nextSVG);\n        lightboxHTML = lightboxHTML.replace(/{prevSVG}/g, prevSVG);\n        lightboxHTML = lightboxHTML.replace(/{closeSVG}/g, closeSVG);\n        lightboxHTML = createHTML(lightboxHTML);\n        document.body.appendChild(lightboxHTML);\n        var modal = document.getElementById('glightbox-body');\n        this.modal = modal;\n        var closeButton = modal.querySelector('.gclose');\n        this.prevButton = modal.querySelector('.gprev');\n        this.nextButton = modal.querySelector('.gnext');\n        this.overlay = modal.querySelector('.goverlay');\n        this.loader = modal.querySelector('.gloader');\n        this.slidesContainer = document.getElementById('glightbox-slider');\n        this.events = {};\n\n        addClass(this.modal, 'glightbox-' + this.settings.skin);\n\n        if (this.settings.closeButton && closeButton) {\n          this.events['close'] = addEvent('click', {\n            onElement: closeButton,\n            withCallback: function withCallback(e, target) {\n              e.preventDefault();\n\n              _this7.close();\n            }\n          });\n        }\n\n        if (closeButton && !this.settings.closeButton) {\n          closeButton.parentNode.removeChild(closeButton);\n        }\n\n        if (this.nextButton) {\n          this.events['next'] = addEvent('click', {\n            onElement: this.nextButton,\n            withCallback: function withCallback(e, target) {\n              e.preventDefault();\n\n              _this7.nextSlide();\n            }\n          });\n        }\n\n        if (this.prevButton) {\n          this.events['prev'] = addEvent('click', {\n            onElement: this.prevButton,\n            withCallback: function withCallback(e, target) {\n              e.preventDefault();\n\n              _this7.prevSlide();\n            }\n          });\n        }\n\n        if (this.settings.closeOnOutsideClick) {\n          this.events['outClose'] = addEvent('click', {\n            onElement: modal,\n            withCallback: function withCallback(e, target) {\n              if (!_this7.preventOutsideClick && !hasClass(document.body, 'glightbox-mobile') && !closest(e.target, '.ginner-container')) {\n                if (!closest(e.target, '.gbtn') && !hasClass(e.target, 'gnext') && !hasClass(e.target, 'gprev')) {\n                  _this7.close();\n                }\n              }\n            }\n          });\n        }\n\n        each(this.elements, function (slide, i) {\n          _this7.slidesContainer.appendChild(slide.instance.create());\n\n          slide.slideNode = _this7.slidesContainer.querySelectorAll('.gslide')[i];\n        });\n\n        if (isTouch$1) {\n          addClass(document.body, 'glightbox-touch');\n        }\n\n        this.events['resize'] = addEvent('resize', {\n          onElement: window,\n          withCallback: function withCallback() {\n            _this7.resize();\n          }\n        });\n        this.built = true;\n      }\n    }, {\n      key: \"resize\",\n      value: function resize() {\n        var slide = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n        slide = !slide ? this.activeSlide : slide;\n\n        if (!slide || hasClass(slide, 'zoomed')) {\n          return;\n        }\n\n        var winSize = windowSize();\n\n        var video = slide.querySelector('.gvideo-wrapper');\n        var image = slide.querySelector('.gslide-image');\n        var description = this.slideDescription;\n        var winWidth = winSize.width;\n        var winHeight = winSize.height;\n\n        if (winWidth <= 768) {\n          addClass(document.body, 'glightbox-mobile');\n        } else {\n          removeClass(document.body, 'glightbox-mobile');\n        }\n\n        if (!video && !image) {\n          return;\n        }\n\n        var descriptionResize = false;\n\n        if (description && (hasClass(description, 'description-bottom') || hasClass(description, 'description-top')) && !hasClass(description, 'gabsolute')) {\n          descriptionResize = true;\n        }\n\n        if (image) {\n          if (winWidth <= 768) {\n            var imgNode = image.querySelector('img');\n            imgNode.setAttribute('style', '');\n          } else if (descriptionResize) {\n            var descHeight = description.offsetHeight;\n\n            var _imgNode = image.querySelector('img');\n\n            _imgNode.setAttribute('style', \"max-height: calc(100vh - \".concat(descHeight, \"px)\"));\n\n            description.setAttribute('style', \"max-width: \".concat(_imgNode.offsetWidth, \"px;\"));\n          }\n        }\n\n        if (video) {\n          var ratio = has(this.settings.plyr.config, 'ratio') ? this.settings.plyr.config.ratio : '16:9';\n          var videoRatio = ratio.split(':');\n          var maxWidth = 900;\n          var maxHeight = maxWidth / (parseInt(videoRatio[0]) / parseInt(videoRatio[1]));\n          maxHeight = Math.floor(maxHeight);\n\n          if (descriptionResize) {\n            winHeight = winHeight - description.offsetHeight;\n          }\n\n          if (winHeight < maxHeight && winWidth > maxWidth) {\n            var vwidth = video.offsetWidth;\n            var vheight = video.offsetHeight;\n\n            var _ratio = winHeight / vheight;\n\n            var vsize = {\n              width: vwidth * _ratio,\n              height: vheight * _ratio\n            };\n            video.parentNode.setAttribute('style', \"max-width: \".concat(vsize.width, \"px\"));\n\n            if (descriptionResize) {\n              description.setAttribute('style', \"max-width: \".concat(vsize.width, \"px;\"));\n            }\n          } else {\n            video.parentNode.style.maxWidth = \"\".concat(maxWidth, \"px\");\n\n            if (descriptionResize) {\n              description.setAttribute('style', \"max-width: \".concat(maxWidth, \"px;\"));\n            }\n          }\n        }\n      }\n    }, {\n      key: \"reload\",\n      value: function reload() {\n        this.init();\n      }\n    }, {\n      key: \"updateNavigationClasses\",\n      value: function updateNavigationClasses() {\n        var loop = this.loop();\n\n        removeClass(this.nextButton, 'disabled');\n\n        removeClass(this.prevButton, 'disabled');\n\n        if (this.index == 0 && this.elements.length - 1 == 0) {\n          addClass(this.prevButton, 'disabled');\n\n          addClass(this.nextButton, 'disabled');\n        } else if (this.index === 0 && !loop) {\n          addClass(this.prevButton, 'disabled');\n        } else if (this.index === this.elements.length - 1 && !loop) {\n          addClass(this.nextButton, 'disabled');\n        }\n      }\n    }, {\n      key: \"loop\",\n      value: function loop() {\n        var loop = has(this.settings, 'loopAtEnd') ? this.settings.loopAtEnd : null;\n        loop = has(this.settings, 'loop') ? this.settings.loop : loop;\n        return loop;\n      }\n    }, {\n      key: \"close\",\n      value: function close() {\n        var _this8 = this;\n\n        if (!this.lightboxOpen) {\n          if (this.events) {\n            for (var key in this.events) {\n              if (this.events.hasOwnProperty(key)) {\n                this.events[key].destroy();\n              }\n            }\n\n            this.events = null;\n          }\n\n          return false;\n        }\n\n        if (this.closing) {\n          return false;\n        }\n\n        this.closing = true;\n        this.slidePlayerPause(this.activeSlide);\n\n        if (this.fullElementsList) {\n          this.elements = this.fullElementsList;\n        }\n\n        addClass(this.modal, 'glightbox-closing');\n\n        animateElement(this.overlay, this.settings.openEffect == 'none' ? 'none' : this.settings.cssEfects.fade.out);\n\n        animateElement(this.activeSlide, this.settings.cssEfects[this.settings.closeEffect].out, function () {\n          _this8.activeSlide = null;\n          _this8.prevActiveSlideIndex = null;\n          _this8.prevActiveSlide = null;\n          _this8.built = false;\n\n          if (_this8.events) {\n            for (var _key in _this8.events) {\n              if (_this8.events.hasOwnProperty(_key)) {\n                _this8.events[_key].destroy();\n              }\n            }\n\n            _this8.events = null;\n          }\n\n          var body = document.body;\n\n          removeClass(html, 'glightbox-open');\n\n          removeClass(body, 'glightbox-open touching gdesc-open glightbox-touch glightbox-mobile gscrollbar-fixer');\n\n          _this8.modal.parentNode.removeChild(_this8.modal);\n\n          _this8.trigger('close');\n\n          if (isFunction(_this8.settings.onClose)) {\n            _this8.settings.onClose();\n          }\n\n          var styles = document.querySelector('.gcss-styles');\n\n          if (styles) {\n            styles.parentNode.removeChild(styles);\n          }\n\n          _this8.lightboxOpen = false;\n          _this8.closing = null;\n        });\n      }\n    }, {\n      key: \"destroy\",\n      value: function destroy() {\n        this.close();\n        this.clearAllEvents();\n\n        if (this.baseEvents) {\n          this.baseEvents.destroy();\n        }\n      }\n    }, {\n      key: \"on\",\n      value: function on(evt, callback) {\n        var once = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n        if (!evt || !isFunction(callback)) {\n          throw new TypeError('Event name and callback must be defined');\n        }\n\n        this.apiEvents.push({\n          evt: evt,\n          once: once,\n          callback: callback\n        });\n      }\n    }, {\n      key: \"once\",\n      value: function once(evt, callback) {\n        this.on(evt, callback, true);\n      }\n    }, {\n      key: \"trigger\",\n      value: function trigger(eventName) {\n        var _this9 = this;\n\n        var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n        var onceTriggered = [];\n\n        each(this.apiEvents, function (event, i) {\n          var evt = event.evt,\n              once = event.once,\n              callback = event.callback;\n\n          if (evt == eventName) {\n            callback(data);\n\n            if (once) {\n              onceTriggered.push(i);\n            }\n          }\n        });\n\n        if (onceTriggered.length) {\n          each(onceTriggered, function (i) {\n            return _this9.apiEvents.splice(i, 1);\n          });\n        }\n      }\n    }, {\n      key: \"clearAllEvents\",\n      value: function clearAllEvents() {\n        this.apiEvents.splice(0, this.apiEvents.length);\n      }\n    }, {\n      key: \"version\",\n      value: function version() {\n        return _version;\n      }\n    }]);\n\n    return GlightboxInit;\n  }();\n\n  function glightbox () {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var instance = new GlightboxInit(options);\n    instance.init();\n    return instance;\n  }\n\n  return glightbox;\n\n})));\n"]}]}